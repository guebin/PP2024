<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.520">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="최규빈">
<meta name="dcterms.date" content="2024-03-29">

<title>PP2024 - 06wk-2: numpy</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PP2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guebin/PP2024"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCQk9RyBNgXc7ORIsYlOfQrg/playlists?view=50&amp;sort=dd&amp;shelf_id=2"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#강의영상" id="toc-강의영상" class="nav-link active" data-scroll-target="#강의영상">1. 강의영상</a></li>
  <li><a href="#imports" id="toc-imports" class="nav-link" data-scroll-target="#imports">2. Imports</a></li>
  <li><a href="#numpy" id="toc-numpy" class="nav-link" data-scroll-target="#numpy">3. <code>numpy</code></a>
  <ul class="collapse">
  <li><a href="#a.-선언" id="toc-a.-선언" class="nav-link" data-scroll-target="#a.-선언">A. 선언</a></li>
  <li><a href="#b.-기본연산-브로드캐스팅" id="toc-b.-기본연산-브로드캐스팅" class="nav-link" data-scroll-target="#b.-기본연산-브로드캐스팅">B. 기본연산 브로드캐스팅</a></li>
  <li><a href="#c.-기타수학연산지원" id="toc-c.-기타수학연산지원" class="nav-link" data-scroll-target="#c.-기타수학연산지원">C. 기타수학연산지원</a></li>
  <li><a href="#d.-인덱싱-1차원" id="toc-d.-인덱싱-1차원" class="nav-link" data-scroll-target="#d.-인덱싱-1차원">D. 인덱싱 1차원</a></li>
  <li><a href="#e.-인덱싱-2차원" id="toc-e.-인덱싱-2차원" class="nav-link" data-scroll-target="#e.-인덱싱-2차원">E. 인덱싱 2차원</a></li>
  <li><a href="#f.-1차원-배열의-선언" id="toc-f.-1차원-배열의-선언" class="nav-link" data-scroll-target="#f.-1차원-배열의-선언">F. 1차원 배열의 선언</a></li>
  <li><a href="#g.-reshape" id="toc-g.-reshape" class="nav-link" data-scroll-target="#g.-reshape">G. reshape</a></li>
  <li><a href="#h.-2차원-배열의-선언" id="toc-h.-2차원-배열의-선언" class="nav-link" data-scroll-target="#h.-2차원-배열의-선언">H. 2차원 배열의 선언</a></li>
  <li><a href="#i.-랜덤으로-배열-생성" id="toc-i.-랜덤으로-배열-생성" class="nav-link" data-scroll-target="#i.-랜덤으로-배열-생성">I. 랜덤으로 배열 생성</a></li>
  <li><a href="#j.-행렬관련기능" id="toc-j.-행렬관련기능" class="nav-link" data-scroll-target="#j.-행렬관련기능">J. 행렬관련기능</a></li>
  <li><a href="#k.-2차원-배열과-연립-1차-방정식" id="toc-k.-2차원-배열과-연립-1차-방정식" class="nav-link" data-scroll-target="#k.-2차원-배열과-연립-1차-방정식">K. 2차원 배열과 연립 1차 방정식</a></li>
  <li><a href="#l.-차원" id="toc-l.-차원" class="nav-link" data-scroll-target="#l.-차원">L. 차원</a></li>
  </ul></li>
  <li><a href="#numpy와-축axis" id="toc-numpy와-축axis" class="nav-link" data-scroll-target="#numpy와-축axis">4. <code>numpy</code>와 축(<code>axis</code>)</a>
  <ul class="collapse">
  <li><a href="#a.-np.concatenate" id="toc-a.-np.concatenate" class="nav-link" data-scroll-target="#a.-np.concatenate">A. <code>np.concatenate</code></a></li>
  <li><a href="#b.-np.stack" id="toc-b.-np.stack" class="nav-link" data-scroll-target="#b.-np.stack">B. <code>np.stack</code></a></li>
  <li><a href="#c.-sum" id="toc-c.-sum" class="nav-link" data-scroll-target="#c.-sum">C. <code>sum</code></a></li>
  <li><a href="#d.-mean-std-max-min-prod" id="toc-d.-mean-std-max-min-prod" class="nav-link" data-scroll-target="#d.-mean-std-max-min-prod">D. <code>mean</code>, <code>std</code>, <code>max</code>, <code>min</code>, <code>prod</code></a></li>
  <li><a href="#e.-argmax-argmin" id="toc-e.-argmax-argmin" class="nav-link" data-scroll-target="#e.-argmax-argmin">E. <code>argmax</code>, <code>argmin</code></a></li>
  <li><a href="#f.-cumsum-cumprod" id="toc-f.-cumsum-cumprod" class="nav-link" data-scroll-target="#f.-cumsum-cumprod">F. <code>cumsum</code>, <code>cumprod</code></a></li>
  <li><a href="#g.-diff" id="toc-g.-diff" class="nav-link" data-scroll-target="#g.-diff">G. <code>diff</code></a></li>
  </ul></li>
  <li><a href="#numpy의-랜덤모듈" id="toc-numpy의-랜덤모듈" class="nav-link" data-scroll-target="#numpy의-랜덤모듈">5. <code>numpy</code>의 랜덤모듈</a>
  <ul class="collapse">
  <li><a href="#a.-np.random.rand" id="toc-a.-np.random.rand" class="nav-link" data-scroll-target="#a.-np.random.rand">A. np.random.rand()</a></li>
  <li><a href="#b.-np.random.randn" id="toc-b.-np.random.randn" class="nav-link" data-scroll-target="#b.-np.random.randn">B. np.random.randn()</a></li>
  <li><a href="#c.-np.random.randint" id="toc-c.-np.random.randint" class="nav-link" data-scroll-target="#c.-np.random.randint">C. np.random.randint()</a></li>
  <li><a href="#d.-np.random.choice" id="toc-d.-np.random.choice" class="nav-link" data-scroll-target="#d.-np.random.choice">D. np.random.choice()</a></li>
  <li><a href="#e.-통계분포" id="toc-e.-통계분포" class="nav-link" data-scroll-target="#e.-통계분포">E. 통계분포</a></li>
  </ul></li>
  <li><a href="#numpy-기타-유용한-기본기능들" id="toc-numpy-기타-유용한-기본기능들" class="nav-link" data-scroll-target="#numpy-기타-유용한-기본기능들">6. <code>numpy</code> – 기타 유용한 기본기능들</a>
  <ul class="collapse">
  <li><a href="#a.-np.where-np.argwhere" id="toc-a.-np.where-np.argwhere" class="nav-link" data-scroll-target="#a.-np.where-np.argwhere">A. np.where, np.argwhere</a></li>
  <li><a href="#b.-인덱싱고급" id="toc-b.-인덱싱고급" class="nav-link" data-scroll-target="#b.-인덱싱고급">B. 인덱싱고급</a></li>
  <li><a href="#c.-np.ix_" id="toc-c.-np.ix_" class="nav-link" data-scroll-target="#c.-np.ix_">C. np.ix_</a></li>
  <li><a href="#d.-note-1-메소드-도움말-확인하기" id="toc-d.-note-1-메소드-도움말-확인하기" class="nav-link" data-scroll-target="#d.-note-1-메소드-도움말-확인하기">D. note 1: 메소드 도움말 확인하기</a></li>
  <li><a href="#e.-hstack-vstack" id="toc-e.-hstack-vstack" class="nav-link" data-scroll-target="#e.-hstack-vstack">E. hstack, vstack</a></li>
  <li><a href="#f.-append" id="toc-f.-append" class="nav-link" data-scroll-target="#f.-append">F. append</a></li>
  <li><a href="#g.-ravel-flatten" id="toc-g.-ravel-flatten" class="nav-link" data-scroll-target="#g.-ravel-flatten">G. ravel, flatten</a></li>
  <li><a href="#h.-기타-통계함수들" id="toc-h.-기타-통계함수들" class="nav-link" data-scroll-target="#h.-기타-통계함수들">H. 기타 통계함수들</a></li>
  <li><a href="#i.-dtype" id="toc-i.-dtype" class="nav-link" data-scroll-target="#i.-dtype">I. dtype</a></li>
  <li><a href="#j.-브로드캐스팅과-시간측정" id="toc-j.-브로드캐스팅과-시간측정" class="nav-link" data-scroll-target="#j.-브로드캐스팅과-시간측정">J. 브로드캐스팅과 시간측정</a></li>
  </ul></li>
  <li><a href="#numpy의-활용" id="toc-numpy의-활용" class="nav-link" data-scroll-target="#numpy의-활용">7. <code>numpy</code>의 활용</a>
  <ul class="collapse">
  <li><a href="#a.-예비학습-이미지자료의-이해" id="toc-a.-예비학습-이미지자료의-이해" class="nav-link" data-scroll-target="#a.-예비학습-이미지자료의-이해">A. 예비학습: 이미지자료의 이해</a></li>
  <li><a href="#b.-이미지-자료처리" id="toc-b.-이미지-자료처리" class="nav-link" data-scroll-target="#b.-이미지-자료처리">B. 이미지 자료처리</a></li>
  <li><a href="#c.-mnist-data" id="toc-c.-mnist-data" class="nav-link" data-scroll-target="#c.-mnist-data">C. MNIST data</a></li>
  <li><a href="#d.-회전변환" id="toc-d.-회전변환" class="nav-link" data-scroll-target="#d.-회전변환">D. 회전변환</a></li>
  <li><a href="#e.-삼성전자의-주가" id="toc-e.-삼성전자의-주가" class="nav-link" data-scroll-target="#e.-삼성전자의-주가">E. 삼성전자의 주가</a></li>
  <li><a href="#f.-회귀분석-미리보기" id="toc-f.-회귀분석-미리보기" class="nav-link" data-scroll-target="#f.-회귀분석-미리보기">F. 회귀분석 미리보기</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="06wk-2.out.ipynb" download="06wk-2.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">06wk-2: <code>numpy</code></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>최규빈 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 29, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://colab.research.google.com/github/guebin/PP2024/blob/main/posts/05wk-2.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" style="text-align: left"></a></p>
<section id="강의영상" class="level1">
<h1>1. 강의영상</h1>
<div id="5a63218e-80f1-4d75-b09b-ee5b3a77fe98" class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#{{&lt;video https://youtu.be/playlist?list=PLQqh36zP38-wwdZJIQiqJdmbWB90HM-VK&amp;si=O2VyS-dYdtqnlD25 &gt;}}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="imports" class="level1">
<h1>2. Imports</h1>
<div id="22ef6f0e-a5bd-46fd-97d3-b1b2593fdbae" class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="numpy" class="level1">
<h1>3. <code>numpy</code></h1>
<section id="a.-선언" class="level2">
<h2 class="anchored" data-anchor-id="a.-선언">A. 선언</h2>
<div id="154a2e85-829c-401a-ba2e-26faeb802990" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]) <span class="co"># list를 만들고 ndarray화 시킴 </span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>l<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="b.-기본연산-브로드캐스팅" class="level2">
<h2 class="anchored" data-anchor-id="b.-기본연산-브로드캐스팅">B. 기본연산 브로드캐스팅</h2>
<div id="c4c8850c-9cf0-46f5-b81c-9344ec52099a" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">+</span><span class="dv">1</span> <span class="co">## [1,2,3] + 1 = [2,3,4]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([2, 3, 4])</code></pre>
</div>
</div>
<div id="25c60eb1-886e-4fc7-bae1-1f39898a1c12" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: can only concatenate list (not "int") to list</code></pre>
</div>
</div>
<div id="d6ab6e96-0173-44aa-88d4-6b2abb5b1db8" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>array([2, 4, 6])</code></pre>
</div>
</div>
<div id="416dcfa3-aea7-466f-a822-3741d966f9d6" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>[1, 2, 3, 1, 2, 3]</code></pre>
</div>
</div>
<div id="fd1aa043-4d13-47ee-ae45-2178edf6d70a" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([0.5, 1. , 1.5])</code></pre>
</div>
</div>
<div id="fd823ac0-e625-4572-b341-61295365fd53" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">/</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: unsupported operand type(s) for /: 'list' and 'int'</code></pre>
</div>
</div>
<div id="db21b864-12bf-45a5-b0da-6d20d41b978c" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([1, 4, 9])</code></pre>
</div>
</div>
<div id="b66d490a-c100-4349-8d58-ec49e66a6167" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: unsupported operand type(s) for ** or pow(): 'list' and 'int'</code></pre>
</div>
</div>
<div id="a1f5acb1-4083-4947-b4cf-59ba2824e000" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">%</span><span class="dv">2</span> <span class="co"># %2 = 2로 나눈 나머지를 리턴 a=[1,2,3] </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([1, 0, 1])</code></pre>
</div>
</div>
<div id="b7f3d4c2-5edb-4abb-8c1f-030112ecc7e5" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">%</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: unsupported operand type(s) for %: 'list' and 'int'</code></pre>
</div>
</div>
</section>
<section id="c.-기타수학연산지원" class="level2">
<h2 class="anchored" data-anchor-id="c.-기타수학연산지원">C. 기타수학연산지원</h2>
<div id="9bb4c132-a6c5-4198-9530-861b2804d9a7" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(a), np.sqrt(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>(array([1.        , 1.41421356, 1.73205081]),
 array([1.        , 1.41421356, 1.73205081]))</code></pre>
</div>
</div>
<div id="acbde336-ea36-438c-93a1-1512d4da19c1" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>np.log(a), np.log(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>(array([0.        , 0.69314718, 1.09861229]),
 array([0.        , 0.69314718, 1.09861229]))</code></pre>
</div>
</div>
<div id="54d0e73a-4ab4-4bf7-a360-a6b51499c07e" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>np.exp(a), np.exp(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>(array([ 2.71828183,  7.3890561 , 20.08553692]),
 array([ 2.71828183,  7.3890561 , 20.08553692]))</code></pre>
</div>
</div>
<div id="612c140b-c91c-4f40-b98a-b769debcafb7" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>np.sin(a), np.sin(l)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>(array([0.84147098, 0.90929743, 0.14112001]),
 array([0.84147098, 0.90929743, 0.14112001]))</code></pre>
</div>
</div>
</section>
<section id="d.-인덱싱-1차원" class="level2">
<h2 class="anchored" data-anchor-id="d.-인덱싱-1차원">D. 인덱싱 1차원</h2>
<p><code>-</code> 선언</p>
<div id="e72e1913-b8fd-47a9-b5da-0912bc3899bc" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">=</span>[<span class="dv">11</span>,<span class="dv">22</span>,<span class="dv">33</span>,<span class="dv">44</span>,<span class="dv">55</span>,<span class="dv">66</span>] </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(l) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>-</code> 인덱스로 접근</p>
<div id="a90eef29-cb90-4693-95fb-5842d579dc9a" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>l[<span class="dv">0</span>],l[<span class="dv">1</span>],l[<span class="dv">2</span>],l[<span class="dv">3</span>],l[<span class="op">-</span><span class="dv">2</span>],l[<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>(11, 22, 33, 44, 55, 66)</code></pre>
</div>
</div>
<div id="24274f02-ff4e-4ec5-ac58-6230174c64ea" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>],a[<span class="dv">1</span>],a[<span class="dv">2</span>],a[<span class="dv">3</span>],a[<span class="op">-</span><span class="dv">2</span>],a[<span class="op">-</span><span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>(11, 22, 33, 44, 55, 66)</code></pre>
</div>
</div>
<p><code>-</code> <code>:</code> 이용 (슬라이싱)</p>
<div id="80e58c66-15ee-40b6-ab81-b97157cd79eb" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>l[<span class="dv">2</span>:<span class="dv">4</span>] <span class="co"># index 2에서 시작, index 4는 포함하지 않음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>[33, 44]</code></pre>
</div>
</div>
<div id="ae368995-971e-46c7-b0e4-00bc26a11734" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">2</span>:<span class="dv">4</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>array([33, 44])</code></pre>
</div>
</div>
<p><code>-</code> 정수배열에 의한 인덱싱</p>
<div id="530e275c-a815-4f36-aff6-86affc8e4a94" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>array([11, 22, 33, 44, 55, 66])</code></pre>
</div>
</div>
<div id="b0618d52-d470-4cd3-bf70-c192c0b99917" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>]] <span class="co"># index=0, index=2, index=4 에 해당하는 원소를 뽑고 싶다 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<pre><code>array([11, 33, 55])</code></pre>
</div>
</div>
<div id="693ec897-05db-4ae0-b81f-d12c50176889" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>l[[<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">4</span>]] <span class="co"># 리스트는 불가능 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: list indices must be integers or slices, not list</code></pre>
</div>
</div>
<p><code>-</code> 부울값에 의한 인덱싱</p>
<div id="a5dfc082-f702-420d-897a-bf180a87b6d8" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>array([11, 22, 33, 44, 55, 66])</code></pre>
</div>
</div>
<div id="23d76442-db29-4408-84c9-48b7772f8ac1" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="va">True</span>,<span class="va">False</span>,<span class="va">True</span>,<span class="va">False</span>,<span class="va">True</span>,<span class="va">False</span>]] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>array([11, 33, 55])</code></pre>
</div>
</div>
<p>응용하면?</p>
<div id="f6b31181-9104-4855-931a-2026eb5bf0d9" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">&lt;</span> <span class="dv">33</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>array([ True,  True, False, False, False, False])</code></pre>
</div>
</div>
<div id="440eabce-ba7f-410f-92b5-926b38555577" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>a[a<span class="op">&lt;</span><span class="dv">33</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>array([11, 22])</code></pre>
</div>
</div>
<p>리스트는 불가능</p>
<div id="15539a47-41ae-4f37-aca6-dd3d534604d0" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>l<span class="op">&lt;</span><span class="dv">33</span> <span class="co"># 여기에서부터 불가능 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: '&lt;' not supported between instances of 'list' and 'int'</code></pre>
</div>
</div>
<div id="f4640487-441a-447e-8b87-1c798b41a65f" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>l[[<span class="va">True</span>,<span class="va">False</span>,<span class="va">True</span>,<span class="va">False</span>,<span class="va">True</span>,<span class="va">False</span>]] <span class="co"># 이것도 불가능 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: list indices must be integers or slices, not list</code></pre>
</div>
</div>
</section>
<section id="e.-인덱싱-2차원" class="level2">
<h2 class="anchored" data-anchor-id="e.-인덱싱-2차원">E. 인덱싱 2차원</h2>
<p><code>-</code> 중첩리스트와 2차원 np.array 선언</p>
<div id="fdd8e0cb-576d-4df7-bc29-adab3e9bf0ae" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> [[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>],[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>,<span class="op">-</span><span class="dv">3</span>,<span class="op">-</span><span class="dv">4</span>],[<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>],[<span class="op">-</span><span class="dv">5</span>,<span class="op">-</span><span class="dv">6</span>,<span class="op">-</span><span class="dv">7</span>,<span class="op">-</span><span class="dv">8</span>]]</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>A2 <span class="op">=</span> np.array(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="57d25a3d-c756-4220-a4b9-9cbf81db41ac" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>A2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>array([[ 1,  2,  3,  4],
       [-1, -2, -3, -4],
       [ 5,  6,  7,  8],
       [-5, -6, -7, -8]])</code></pre>
</div>
</div>
<div id="8c62d8f4-91ea-42f2-bff1-7541508a0a31" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>[[1, 2, 3, 4], [-1, -2, -3, -4], [5, 6, 7, 8], [-5, -6, -7, -8]]</code></pre>
</div>
</div>
<p><code>-</code> A의 원소 인덱싱</p>
<div id="2ad49edf-4233-4c47-b608-a58c771046a9" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">0</span>][<span class="dv">0</span>] <span class="co"># (1,1)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>1</code></pre>
</div>
</div>
<div id="0d75941a-2520-4418-b2a4-c379871e83e3" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>][<span class="dv">2</span>] <span class="co"># (2,3)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>-3</code></pre>
</div>
</div>
<div id="5bc6c748-22bc-4996-840c-c43510b7e996" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>A[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="co"># (4,1)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>-5</code></pre>
</div>
</div>
<p><code>-</code> A2의 원소 인덱싱</p>
<div id="6ad39a6a-5f89-403a-97ec-d595b4983cdc" class="cell" data-tags="[]" data-execution_count="94">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">0</span>][<span class="dv">0</span>] <span class="co"># (1,1)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>1</code></pre>
</div>
</div>
<div id="dbd47326-5e65-4f58-b383-01ce0fa45d24" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">1</span>][<span class="dv">2</span>] <span class="co"># (2,3)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>-3</code></pre>
</div>
</div>
<div id="c8f1e3b6-8419-4e0c-8173-bb9aeca77d4e" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>] <span class="co"># (4,1)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>-5</code></pre>
</div>
</div>
<p><code>-</code> A2에서만 되는 기술 (넘파이에서 제시하는 신기술, R에서는 기본적으로 쓰던것, 이중list는 불가능)</p>
<div id="5dab6c8a-1210-4efd-94fa-1e29301a43f4" class="cell" data-tags="[]" data-execution_count="97">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">0</span>,<span class="dv">0</span>] <span class="co"># (1,1)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>1</code></pre>
</div>
</div>
<div id="c773566b-c5f0-49c4-b06d-3b39320b3d82" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">1</span>,<span class="dv">2</span>] <span class="co"># (2,3)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>-3</code></pre>
</div>
</div>
<div id="4e60520e-5b96-4c23-a065-425962384295" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>] <span class="co"># (4,1)의 원소 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>-5</code></pre>
</div>
</div>
<p><code>-</code> 정수배열에 의한 인덱싱 &amp; 슬라이싱!</p>
<div id="70f89e7e-52b8-43d5-ab52-ca83d52e9c92" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>A2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>array([[ 1,  2,  3,  4],
       [-1, -2, -3, -4],
       [ 5,  6,  7,  8],
       [-5, -6, -7, -8]])</code></pre>
</div>
</div>
<div id="71bb6bb7-f09a-4eb1-b45a-46ad0f79778c" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">0</span>,<span class="dv">0</span>:<span class="dv">2</span>] <span class="co"># 1행1열, 1행2열 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>array([1, 2])</code></pre>
</div>
</div>
<div id="8fda882c-09ad-4cc6-90de-f62d65a4463f" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">0</span>,:] <span class="co"># 1행 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>array([1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="6c3b048c-42d4-4ffa-ab8a-c781b5c7e46e" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">0</span>] <span class="co"># 1행</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>array([1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="e60286b5-69b9-4e0c-951e-e150647c1810" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>A2[[<span class="dv">0</span>,<span class="dv">2</span>],:] <span class="co"># 1행, 3행 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>array([[1, 2, 3, 4],
       [5, 6, 7, 8]])</code></pre>
</div>
</div>
<div id="4a95fe03-6cb9-48aa-a0ac-e1c4e0fbf2b1" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>A2[[<span class="dv">0</span>,<span class="dv">2</span>]] <span class="co"># 1행, 3행 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>array([[1, 2, 3, 4],
       [5, 6, 7, 8]])</code></pre>
</div>
</div>
<div id="42e91f67-7262-46fd-a0eb-74c5f41c01c5" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>A2[:,<span class="dv">0</span>] <span class="co"># 1열 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>array([ 1, -1,  5, -5])</code></pre>
</div>
</div>
<div id="7515367f-0286-44a7-a5d4-f3a91f72307f" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>A2[:,[<span class="dv">0</span>]] <span class="co"># 1열 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>array([[ 1],
       [-1],
       [ 5],
       [-5]])</code></pre>
</div>
</div>
<div id="0973ce27-0b5b-4560-b4cc-9eadf551290b" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>A2[:,[<span class="dv">0</span>,<span class="dv">2</span>]] <span class="co"># 1열, 3열</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>array([[ 1,  3],
       [-1, -3],
       [ 5,  7],
       [-5, -7]])</code></pre>
</div>
</div>
<div id="5ae168cb-7b48-4342-90b5-c4c248176bd6" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>A2[<span class="dv">0</span>:<span class="dv">2</span>,[<span class="dv">0</span>,<span class="dv">2</span>]] <span class="co"># 1행~2행 //  1열,3열 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>array([[ 1,  3],
       [-1, -3]])</code></pre>
</div>
</div>
</section>
<section id="f.-1차원-배열의-선언" class="level2">
<h2 class="anchored" data-anchor-id="f.-1차원-배열의-선언">F. 1차원 배열의 선언</h2>
<p><code>-</code> 리스트나 튜플을 선언하고 형변환</p>
<div id="7316f01c-451a-4e9f-81a4-6e630a763b6e" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>np.array((<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># 튜플-&gt;넘파이어레이 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="35e4c5f1-0e4f-45c0-af36-ef1f9e80e0e6" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]) <span class="co"># 리스트 -&gt;넘파이어레이 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<p><code>-</code> range()를 이용해서 선언하고 형변환</p>
<div id="74f6b3ab-dbb6-4abf-ad74-c1775aa75ce6" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>np.array(<span class="bu">range</span>(<span class="dv">10</span>)) <span class="co"># range(10) -&gt; 넘파이어레이 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
</div>
<p><code>-</code> np.zeros, np.ones</p>
<div id="50cf691a-8b6f-425b-966c-93ecabc936b1" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>np.zeros(<span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>array([0., 0., 0.])</code></pre>
</div>
</div>
<div id="6591c1c8-8cbf-49b8-835f-72a5f94331f4" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>np.ones(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>array([1., 1., 1., 1.])</code></pre>
</div>
</div>
<p><code>-</code> np.linspace</p>
<div id="9881fafa-9057-4532-9fba-919712e955cc" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">12</span>) <span class="co"># 0에서 시작하고 1에서 끝남 (양끝점 모두 포함)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>array([0.        , 0.09090909, 0.18181818, 0.27272727, 0.36363636,
       0.45454545, 0.54545455, 0.63636364, 0.72727273, 0.81818182,
       0.90909091, 1.        ])</code></pre>
</div>
</div>
<div id="19fda85f-ad53-4567-a752-e54d24188bdc" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="bu">len</span>(np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">12</span>)) <span class="co"># 길이는 12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>12</code></pre>
</div>
</div>
<p><code>-</code> np.arange</p>
<div id="99f71a79-4e46-4c58-b64a-4a87fd023eb5" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>np.arange(<span class="dv">5</span>) <span class="co"># np.array(range(5))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>array([0, 1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="ee3556a9-8965-41b2-afe2-216e6d97af45" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>np.arange(<span class="dv">1</span>,<span class="dv">6</span>) <span class="co"># np.array(range(1,6))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>array([1, 2, 3, 4, 5])</code></pre>
</div>
</div>
</section>
<section id="g.-reshape" class="level2">
<h2 class="anchored" data-anchor-id="g.-reshape">G. reshape</h2>
<p><code>-</code> reshape: ndarray의 특수한 기능</p>
<div id="fd0f4b0f-a3ad-46f9-8366-c5a83d720568" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">11</span>,<span class="dv">22</span>,<span class="dv">33</span>,<span class="dv">44</span>,<span class="dv">55</span>,<span class="dv">66</span>])</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>a <span class="co">## 길이가 6인 벡터 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<pre><code>array([11, 22, 33, 44, 55, 66])</code></pre>
</div>
</div>
<div id="86a3b1ef-074a-4e92-adc5-9bbfbd64f41c" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">2</span>,<span class="dv">3</span>) <span class="co">## (2,3) matrix 라고 생각해도 무방 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>array([[11, 22, 33],
       [44, 55, 66]])</code></pre>
</div>
</div>
<p>note: reshape은 a자체를 변화시키는것은 아님</p>
<div id="e45a9854-17c1-4b66-9f7c-ef89eab037be" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>a <span class="co"># a는 그대로 있음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>array([11, 22, 33, 44, 55, 66])</code></pre>
</div>
</div>
<div id="5b936170-f7c1-4a3c-91b3-93b7fe58914c" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span> a.reshape(<span class="dv">2</span>,<span class="dv">3</span>) <span class="co"># a를 reshape한 결과를 b에 저장 </span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>array([[11, 22, 33],
       [44, 55, 66]])</code></pre>
</div>
</div>
<div id="e3c9c9a7-39db-4e97-911a-cedcaf121476" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>a <span class="co"># a는 여전히 그대로 있음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>array([11, 22, 33, 44, 55, 66])</code></pre>
</div>
</div>
<p><code>-</code> 다시 b를 a처럼 바꾸고 싶다</p>
<div id="d2096d2d-86ba-4585-9364-ffee0633015e" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<pre><code>array([[11, 22, 33],
       [44, 55, 66]])</code></pre>
</div>
</div>
<div id="3fec48df-08c5-46a8-9a13-b0e007c8b03b" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>b.reshape(<span class="dv">6</span>) <span class="co"># b는 (2,3) matrix , 그런데 이것을 길이가 6인 벡터로 만들고 싶다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">
<pre><code>array([11, 22, 33, 44, 55, 66])</code></pre>
</div>
</div>
<p><code>-</code> reshape with -1</p>
<div id="b600b8e4-c153-4419-8458-5f12d6c950c7" class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">24</span>) <span class="co"># np.array(range(24))</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="180">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
<div id="ee9eca13-f1ca-4274-8681-25cc13fcadb1" class="cell" data-execution_count="185">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">2</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="185">
<pre><code>array([[ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23]])</code></pre>
</div>
</div>
<div id="126303f6-0f12-46db-8e39-7a31e17f77c9" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>array([[ 0,  1,  2,  3,  4,  5,  6,  7],
       [ 8,  9, 10, 11, 12, 13, 14, 15],
       [16, 17, 18, 19, 20, 21, 22, 23]])</code></pre>
</div>
</div>
<div id="1e45a836-65fc-4f5e-b20e-b46307ef6a0e" class="cell" data-execution_count="187">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">4</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="187">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20, 21, 22, 23]])</code></pre>
</div>
</div>
<div id="5621e2e1-c3ec-4fc8-93bc-525aa3b5ac06" class="cell" data-execution_count="188">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">5</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: cannot reshape array of size 24 into shape (5,newaxis)</code></pre>
</div>
</div>
<div id="13dcc7e9-e475-4e90-a064-e282aa13bd04" class="cell" data-execution_count="189">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">6</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="189">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12, 13, 14, 15],
       [16, 17, 18, 19],
       [20, 21, 22, 23]])</code></pre>
</div>
</div>
<div id="8907f4e4-8585-4491-87cb-a331f502b1f0" class="cell" data-execution_count="190">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">7</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: cannot reshape array of size 24 into shape (7,newaxis)</code></pre>
</div>
</div>
<div id="72e402a5-1165-4689-8d16-e1fc9bd8d693" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">8</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="191">
<pre><code>array([[ 0,  1,  2],
       [ 3,  4,  5],
       [ 6,  7,  8],
       [ 9, 10, 11],
       [12, 13, 14],
       [15, 16, 17],
       [18, 19, 20],
       [21, 22, 23]])</code></pre>
</div>
</div>
<div id="acf908f8-3893-4eda-a74e-8860966e79bc" class="cell" data-execution_count="192">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="dv">12</span>,<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="192">
<pre><code>array([[ 0,  1],
       [ 2,  3],
       [ 4,  5],
       [ 6,  7],
       [ 8,  9],
       [10, 11],
       [12, 13],
       [14, 15],
       [16, 17],
       [18, 19],
       [20, 21],
       [22, 23]])</code></pre>
</div>
</div>
<div id="3eec797e-f7ef-46b2-b8a2-09b582009d4d" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span> a.reshape(<span class="dv">12</span>,<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>array([[ 0,  1],
       [ 2,  3],
       [ 4,  5],
       [ 6,  7],
       [ 8,  9],
       [10, 11],
       [12, 13],
       [14, 15],
       [16, 17],
       [18, 19],
       [20, 21],
       [22, 23]])</code></pre>
</div>
</div>
<div id="f85ee228-0543-4451-9a25-7764d974399b" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>b.reshape(<span class="op">-</span><span class="dv">1</span>) <span class="co"># b를 다시 길이가 24인 벡터로!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
</section>
<section id="h.-2차원-배열의-선언" class="level2">
<h2 class="anchored" data-anchor-id="h.-2차원-배열의-선언">H. 2차원 배열의 선언</h2>
<div id="01c0b0e3-6aaf-48c5-93df-a16b7a8ef243" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>np.zeros((<span class="dv">3</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>array([[0., 0., 0.],
       [0., 0., 0.],
       [0., 0., 0.]])</code></pre>
</div>
</div>
<div id="7aa6960d-7a66-4623-8389-2c7df4454807" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>np.ones((<span class="dv">3</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>array([[1., 1., 1.],
       [1., 1., 1.],
       [1., 1., 1.]])</code></pre>
</div>
</div>
<div id="a90f2021-c904-4e5c-bbb3-7502e6e40181" class="cell" data-execution_count="200">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>np.eye(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="200">
<pre><code>array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])</code></pre>
</div>
</div>
<div id="8c22ab0c-7b39-488c-9d41-25612e07f993" class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>np.diag([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="202">
<pre><code>array([[ 1,  0,  0,  0],
       [ 0,  2,  0,  0],
       [ 0,  0,  3,  0],
       [ 0,  0,  0, -1]])</code></pre>
</div>
</div>
</section>
<section id="i.-랜덤으로-배열-생성" class="level2">
<h2 class="anchored" data-anchor-id="i.-랜덤으로-배열-생성">I. 랜덤으로 배열 생성</h2>
<div id="7e4a037e-59f3-4568-a5fd-6262cae35250" class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>) <span class="co"># 표쥰정규분포에서 10개를 뽑음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="204">
<pre><code>array([ 0.27184979, -0.4540305 ,  0.24538219, -3.11389327,  1.06478234,
        0.12051154,  0.01503231, -0.06744028,  2.30710253,  0.78840453])</code></pre>
</div>
</div>
<div id="0a7d9efb-a47a-4d50-9956-23c284ec78e3" class="cell" data-execution_count="205">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>) <span class="co"># 0~1사이에서 10개를 뽑음</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="205">
<pre><code>array([0.67729671, 0.19584606, 0.4564896 , 0.9308976 , 0.49080792,
       0.03410752, 0.47480477, 0.44519947, 0.20608611, 0.85576604])</code></pre>
</div>
</div>
<div id="e081b267-64a0-4765-abf9-a26bfa519f3f" class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">2</span>) <span class="co"># 표준정규분포에서 4개를 뽑고 (2,2) ndarray로 형태변환 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="209">
<pre><code>array([[-0.97378852,  0.5250826 ],
       [-0.97400213, -0.59600022]])</code></pre>
</div>
</div>
<div id="9a81b2a0-bed1-47cd-b982-91c4ba9bafaf" class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">2</span>) <span class="co"># 0~1 4개를 뽑고 (2,2) ndarray로 형태변환 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="208">
<pre><code>array([[0.03708309, 0.56122376],
       [0.80934488, 0.65723348]])</code></pre>
</div>
</div>
</section>
<section id="j.-행렬관련기능" class="level2">
<h2 class="anchored" data-anchor-id="j.-행렬관련기능">J. 행렬관련기능</h2>
<div id="325f2540-d8af-46a1-b431-30ff91a96703" class="cell" data-execution_count="219">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>A<span class="op">=</span>np.arange(<span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="219">
<pre><code>array([[0, 1],
       [2, 3]])</code></pre>
</div>
</div>
<div id="14ebeda2-0c96-4678-8452-d257a092c36e" class="cell" data-execution_count="220">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>A.T <span class="co"># .T는 전치행렬을 구해줌 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="220">
<pre><code>array([[0, 2],
       [1, 3]])</code></pre>
</div>
</div>
<div id="3e7c1d9c-5c89-4f12-be18-775476323318" class="cell" data-execution_count="221">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>np.linalg.inv(A) <span class="co"># np.linalg.inv는 역행렬을 구해주는 함수 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">
<pre><code>array([[-1.5,  0.5],
       [ 1. ,  0. ]])</code></pre>
</div>
</div>
<div id="622ccc62-be54-47d4-b44d-38b7b54037ac" class="cell" data-execution_count="222">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">@</span> np.linalg.inv(A) <span class="co"># @는 행렬곱을 수행 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="222">
<pre><code>array([[1., 0.],
       [0., 1.]])</code></pre>
</div>
</div>
</section>
<section id="k.-2차원-배열과-연립-1차-방정식" class="level2">
<h2 class="anchored" data-anchor-id="k.-2차원-배열과-연립-1차-방정식">K. 2차원 배열과 연립 1차 방정식</h2>
<p><code>-</code> 아래의 연립방정식 고려</p>
<p><span class="math inline">\(\begin{cases} y+z+w = 3 \\ x+z+w = 3 \\ x+y+w = 3 \\ x+y+z = 3 \end{cases}\)</span></p>
<p><code>-</code> 행렬표현?</p>
<p><span class="math inline">\(\begin{bmatrix} 0 &amp; 1 &amp; 1 &amp; 1 \\ 1 &amp; 0 &amp; 1 &amp; 1 \\ 1 &amp; 1 &amp; 0 &amp; 1 \\ 1 &amp; 1 &amp; 1 &amp; 0 \end{bmatrix} \begin{bmatrix} x \\ y \\ z \\ w \end{bmatrix} = \begin{bmatrix} 3 \\ 3 \\ 3 \\ 3 \end{bmatrix}\)</span></p>
<p><code>-</code> 풀이</p>
<div id="0877ed6a-7f70-44e2-9285-9a14781ad4ba" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>]])</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>array([[0, 1, 1, 1],
       [1, 0, 1, 1],
       [1, 1, 0, 1],
       [1, 1, 1, 0]])</code></pre>
</div>
</div>
<div id="6e9a8268-08d1-4372-97fa-dc63bfe6a3f3" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span> np.array([<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>]).reshape(<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([[3],
       [3],
       [3],
       [3]])</code></pre>
</div>
</div>
<div id="88e0ee63-1fc2-41fb-bd6c-31284dcc232f" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>np.linalg.inv(A) <span class="op">@</span> b </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([[1.],
       [1.],
       [1.],
       [1.]])</code></pre>
</div>
</div>
<p><code>-</code> 다른풀이</p>
<p>b를 아래와 같이 만들어도 된다.</p>
<div id="dd1f3708-82b0-482c-a610-dadb73abbc9c" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>np.array([<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>])</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([3, 3, 3, 3])</code></pre>
</div>
</div>
<div id="436fb6b7-92a2-4994-bdcf-30f9a901ab27" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>b.shape <span class="co"># b.shape은 길이가 1인 튜플로 나온다. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(4,)</code></pre>
</div>
</div>
<div id="a84da24d-aad4-4fcc-bb9d-fdb69ed6bf0b" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>np.linalg.inv(A) <span class="op">@</span> b </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([1., 1., 1., 1.])</code></pre>
</div>
</div>
<p><strong><em><code>@</code>의 유연성</em></strong></p>
<p><code>-</code> 엄밀하게는 아래의 행렬곱이 가능하다. - (2,2) @ (2,1) =&gt; (2,1) - (1,2) @ (2,2) =&gt; (1,2)</p>
<div id="3fcc6a3c-14d6-4ae1-b221-d59294fe251a" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>]).reshape(<span class="dv">2</span>,<span class="dv">1</span>) </span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>A<span class="op">@</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([[ 5],
       [11]])</code></pre>
</div>
</div>
<div id="566d96d1-4849-49c9-b5f7-a188876902cd" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>A.shape, b.shape, (A<span class="op">@</span>b).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>((2, 2), (2, 1), (2, 1))</code></pre>
</div>
</div>
<div id="dfcf2e1b-7a85-45e9-addb-f4c8c5cc687d" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>]).reshape(<span class="dv">1</span>,<span class="dv">2</span>) </span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a>b<span class="op">@</span>A </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>array([[ 7, 10]])</code></pre>
</div>
</div>
<div id="1221fae7-5008-47ae-8289-777c65416ed7" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>A.shape, b.shape, (b<span class="op">@</span>A).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>((2, 2), (1, 2), (1, 2))</code></pre>
</div>
</div>
<p><code>-</code> 당연히 아래는 성립안한다.</p>
<div id="36fd2296-d127-4678-91dc-a119d0c208e0" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>]).reshape(<span class="dv">2</span>,<span class="dv">1</span>) </span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a>b<span class="op">@</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)-&gt;(n?,m?) (size 2 is different from 1)</code></pre>
</div>
</div>
<div id="8c40ff67-6adb-4dd0-8d26-e059459db5e8" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>]).reshape(<span class="dv">1</span>,<span class="dv">2</span>) </span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>A<span class="op">@</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)-&gt;(n?,m?) (size 1 is different from 2)</code></pre>
</div>
</div>
<p><code>-</code> 아래는 어떨까? 계산가능할까? <span class="math inline">\(\to\)</span> 모두 계산가능! - (2,) @ (2,2) = (2,) - (2,2) @ (2,) = (2,)</p>
<div id="b9e8c885-f3c8-4a59-ab5c-329c7944b1db" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>]) </span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>A<span class="op">@</span>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([ 5, 11])</code></pre>
</div>
</div>
<div id="83c6b147-2b2a-425f-815a-b2dd6c53e117" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>A.shape, b.shape, (A<span class="op">@</span>b).shape </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>((2, 2), (2,), (2,))</code></pre>
</div>
</div>
<ul>
<li>b를 마치 (2,1)처럼 해석하여 행렬곱하고 결과는 다시 (2,) 로 만든것 같다.</li>
</ul>
<div id="b0e4b65c-278a-413c-a140-3ecd7ef0064c" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">@</span>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>array([ 7, 10])</code></pre>
</div>
</div>
<div id="8573dbc1-104f-419d-bd16-464f61dd49de" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>A.shape, b.shape, (b<span class="op">@</span>A).shape </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>((2, 2), (2,), (2,))</code></pre>
</div>
</div>
<ul>
<li>이때는 <span class="math inline">\(b\)</span>를 마치 (1,2)처럼 해석하여 행렬곱하고 결과는 다시 (2,)로 만든것 같다.</li>
</ul>
<p><code>-</code> 아래는 어떠할까?</p>
<div id="a71b8785-ed7b-49ea-a57d-a07a67688fb1" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]) </span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]) </span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>b1<span class="op">@</span>b2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>30</code></pre>
</div>
</div>
<div id="75575ff0-bc6a-407a-8a8b-62521417f7b9" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>b1.shape, b2.shape, (b1<span class="op">@</span>b2).shape </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>((4,), (4,), ())</code></pre>
</div>
</div>
<ul>
<li>(1,4) @ (4,1) = (1,1) 로 생각</li>
</ul>
<p><code>-</code> 즉 위는 아래와 같이 해석하고 행렬곱한것과 결과가 같다.</p>
<div id="4d470698-272d-494a-947d-f0bf5a946bb3" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">1</span>,<span class="dv">4</span>) </span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">4</span>,<span class="dv">1</span>) </span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>b1<span class="op">@</span>b2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[30]])</code></pre>
</div>
</div>
<div id="f24ada40-98dd-4fb6-b1db-bb73ff1360c8" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>b1.shape, b2.shape, (b1<span class="op">@</span>b2).shape </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>((1, 4), (4, 1), (1, 1))</code></pre>
</div>
</div>
<p><code>-</code> 때로는 (4,1) @ (1,4)와 같은 계산결과를 얻고 싶을 수 있는데 이때는 차원을 명시해야함</p>
<div id="15344a20-d3f6-4c46-9e2e-d7d334ce862c" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">4</span>,<span class="dv">1</span>) </span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]).reshape(<span class="dv">1</span>,<span class="dv">4</span>) </span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>b1<span class="op">@</span>b2 </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[ 1,  2,  3,  4],
       [ 2,  4,  6,  8],
       [ 3,  6,  9, 12],
       [ 4,  8, 12, 16]])</code></pre>
</div>
</div>
</section>
<section id="l.-차원" class="level2">
<h2 class="anchored" data-anchor-id="l.-차원">L. 차원</h2>
<p><code>-</code> 넘파이배열의 차원은 .shape 으로 확인가능</p>
<p><code>-</code> 아래는 모두 미묘하게 다르다.</p>
<div id="1f1ac9e5-7926-4828-a3f6-48ca06535e87" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="fl">3.14</span>) <span class="co"># 스칼라, 0d array </span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>a, a.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>(array(3.14), ())</code></pre>
</div>
</div>
<div id="084df997-6409-4657-880e-3b37f43ec393" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="fl">3.14</span>]) <span class="co"># 벡터, 1d array </span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>a, a.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>(array([3.14]), (1,))</code></pre>
</div>
</div>
<div id="fa2a046b-e5f3-493b-9613-1d28bcf5f5bd" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([[<span class="fl">3.14</span>]]) <span class="co"># 매트릭스, 2d array </span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>a, a.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>(array([[3.14]]), (1, 1))</code></pre>
</div>
</div>
<div id="a50bd4a8-25f6-455c-9b89-a14a521bb836" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([[[<span class="fl">3.14</span>]]]) <span class="co"># 텐서, 3d array </span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>a, a.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>(array([[[3.14]]]), (1, 1, 1))</code></pre>
</div>
</div>
</section>
</section>
<section id="numpy와-축axis" class="level1">
<h1>4. <code>numpy</code>와 축(<code>axis</code>)</h1>
<section id="a.-np.concatenate" class="level2">
<h2 class="anchored" data-anchor-id="a.-np.concatenate">A. <code>np.concatenate</code></h2>
<p><code>-</code> 기본예제</p>
<div id="361ddaca-9cfa-4c46-8a99-19d196cb2562" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>]) </span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="05754b29-4cd0-4c86-8846-2d7f4cf940be" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>array([ 1,  2, -1, -2])</code></pre>
</div>
</div>
<p><code>-</code> 응용</p>
<div id="708e1864-0af5-403b-b507-b62868201907" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>])</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>c<span class="op">=</span>np.array([<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="60ada251-c77c-4d46-89ca-8b1b48efe292" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b,c])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>array([ 1,  2, -1, -2,  3,  4,  5])</code></pre>
</div>
</div>
<ul>
<li>여기까진 딱히 칸캐터네이트의 메리트가 없어보임</li>
<li>리스트였다면 a+b+c 하면 되는 기능이니까?</li>
</ul>
<p><code>-</code> 2d array에 적용해보자.</p>
<div id="50994f8a-20b5-473e-b946-9adfbe0bd3a3" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3a2d64ca-442c-430e-a248-a04aa85b6aa7" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<pre><code>array([[ 0,  1],
       [ 2,  3],
       [ 0, -1],
       [-2, -3]])</code></pre>
</div>
</div>
<p><code>-</code> 옆으로 붙일려면?</p>
<div id="8b341a0a-f4d1-42ed-be42-fa15638df341" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>array([[ 0,  1,  0, -1],
       [ 2,  3, -2, -3]])</code></pre>
</div>
</div>
<p><code>-</code> 위의 코드에서 axis=1 이 뭐지? axis=0,2 등을 치면 결과가 어떻게 될까?</p>
<div id="1db3ff1a-7c4f-4d32-8428-8d8728e103a6" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>array([[ 0,  1],
       [ 2,  3],
       [ 0, -1],
       [-2, -3]])</code></pre>
</div>
</div>
<ul>
<li>이건 그냥 np.concatenate([a,b])와 같다.</li>
<li>np.concatenate([a,b])는 np.concatenate([a,b],axis=0)의 생략버전이군?</li>
</ul>
<div id="e24bc868-b625-4b96-9903-3f906e7adb72" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AxisError: axis 2 is out of bounds for array of dimension 2</code></pre>
</div>
</div>
<ul>
<li>이런건 없다.</li>
</ul>
<p><code>-</code> axis의 의미가 뭔지 궁금함. 좀 더 예제를 살펴보자.</p>
<div id="5abce513-6f24-4f6d-b513-7e09f17b22c6" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]],

       [[12, 13, 14, 15],
        [16, 17, 18, 19],
        [20, 21, 22, 23]]])</code></pre>
</div>
</div>
<div id="1411fedc-eee0-4f30-ae72-291c8f6e77c5" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>array([[[  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]]])</code></pre>
</div>
</div>
<div id="bd85ba89-dcf5-42b9-9802-8fd6b18d7699" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<pre><code>array([[[  0,   1,   2,   3],
        [  4,   5,   6,   7],
        [  8,   9,  10,  11]],

       [[ 12,  13,  14,  15],
        [ 16,  17,  18,  19],
        [ 20,  21,  22,  23]],

       [[  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]]])</code></pre>
</div>
</div>
<div id="3157f2aa-1adf-4d03-b0af-95bd7da91ff5" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>array([[[  0,   1,   2,   3],
        [  4,   5,   6,   7],
        [  8,   9,  10,  11],
        [  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[ 12,  13,  14,  15],
        [ 16,  17,  18,  19],
        [ 20,  21,  22,  23],
        [-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]]])</code></pre>
</div>
</div>
<div id="96e0b272-965c-4e82-a2cb-b81bb75e362c" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>array([[[  0,   1,   2,   3,   0,  -1,  -2,  -3],
        [  4,   5,   6,   7,  -4,  -5,  -6,  -7],
        [  8,   9,  10,  11,  -8,  -9, -10, -11]],

       [[ 12,  13,  14,  15, -12, -13, -14, -15],
        [ 16,  17,  18,  19, -16, -17, -18, -19],
        [ 20,  21,  22,  23, -20, -21, -22, -23]]])</code></pre>
</div>
</div>
<ul>
<li>이번에는 axis=2까지 된다?</li>
</ul>
<div id="e340eb4d-7473-4bdd-8ba0-8b1c8896712a" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">3</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AxisError: axis 3 is out of bounds for array of dimension 3</code></pre>
</div>
</div>
<ul>
<li>axis=3까지는 안된다?</li>
</ul>
<p><code>-</code> 뭔가 나름의 방식으로 합쳐지는데 원리가 뭘까?</p>
<p>(분석1) np.concatenate([a,b],axis=0)</p>
<div id="741cde88-5357-43c1-b38b-d9204d861267" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="108f6f42-b9d9-4ffd-a090-ad290b35f603" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>((2, 3, 4), (2, 3, 4), (4, 3, 4))</code></pre>
</div>
</div>
<ul>
<li>첫번째차원이 바뀌었다 =&gt; 첫번째 축이 바뀌었다 =&gt; axis=0 (파이썬은 0부터 시작하니까!)</li>
</ul>
<p>(분석2) np.concatenate([a,b],axis=1)</p>
<div id="1981b2bc-a43a-4c94-80ed-3e14dea0c9d8" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="631cc4f9-7f17-4be8-a2ca-edbfcf9631a1" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 6, 4))</code></pre>
</div>
</div>
<ul>
<li>두번째차원이 바뀌었다 =&gt; 두번째 축이 바뀌었다 =&gt; axis=1</li>
</ul>
<p>(분석3) np.concatenate([a,b],axis=2)</p>
<div id="fc0c7e72-4d27-4a36-b455-e0f2ad3206d7" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="26ecdcd3-609a-4356-a764-de0325130807" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=</span><span class="dv">2</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 3, 8))</code></pre>
</div>
</div>
<ul>
<li>세번째차원이 바뀌었다 =&gt; 세번째 축이 바뀌었다 =&gt; axis=2</li>
</ul>
<p>(분석4) np.concatenate([a,b],axis=3)</p>
<div id="93e903a3-a7bb-4c9e-8aa9-a38fa3a8fa06" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="0a4b4100-107a-47bf-9f62-4103f70bcafc" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=</span><span class="dv">3</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AxisError: axis 3 is out of bounds for array of dimension 3</code></pre>
</div>
</div>
<ul>
<li>네번째차원이 없다 =&gt; 네번째 축이 없다 =&gt; axis=3으로 하면 에러가 난다.</li>
</ul>
<p>(보너스1)</p>
<div id="da4ecf40-4ebf-4373-b075-881110029a87" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7145fcd2-cc6b-48bf-a034-36fa74882345" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>array([[[  0,   1,   2,   3,   0,  -1,  -2,  -3],
        [  4,   5,   6,   7,  -4,  -5,  -6,  -7],
        [  8,   9,  10,  11,  -8,  -9, -10, -11]],

       [[ 12,  13,  14,  15, -12, -13, -14, -15],
        [ 16,  17,  18,  19, -16, -17, -18, -19],
        [ 20,  21,  22,  23, -20, -21, -22, -23]]])</code></pre>
</div>
</div>
<div id="7dcde0cb-4e80-4d80-8621-5b51df29a5cc" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 3, 8))</code></pre>
</div>
</div>
<ul>
<li>마지막 차원이 바뀌었다 =&gt; 마지막 축이 바뀌었다 =&gt; axis = -1</li>
</ul>
<p>(보너스2)</p>
<div id="831368ec-d819-4e01-bd40-686c6c0b323a" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bf6717ec-06ad-422c-b970-b51a99e451dd" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>array([[[  0,   1,   2,   3],
        [  4,   5,   6,   7],
        [  8,   9,  10,  11],
        [  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[ 12,  13,  14,  15],
        [ 16,  17,  18,  19],
        [ 20,  21,  22,  23],
        [-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]]])</code></pre>
</div>
</div>
<div id="65159fc7-449b-4509-be83-9ef10f047153" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">2</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 6, 4))</code></pre>
</div>
</div>
<ul>
<li>마지막에서 2번째 차원이 바뀌었다 =&gt; 마지막에서 2번째 축이 바뀌었다 =&gt; axis = -2</li>
</ul>
<p>(보너스3)</p>
<div id="11753130-03fd-4650-bcd0-4818c47ed83b" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="bd27764c-ecda-4014-93f1-bc155201a904" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>array([[[  0,   1,   2,   3],
        [  4,   5,   6,   7],
        [  8,   9,  10,  11]],

       [[ 12,  13,  14,  15],
        [ 16,  17,  18,  19],
        [ 20,  21,  22,  23]],

       [[  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]]])</code></pre>
</div>
</div>
<div id="50a8d933-d3b7-4ff3-9fc4-f77d8883050d" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">3</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>((2, 3, 4), (2, 3, 4), (4, 3, 4))</code></pre>
</div>
</div>
<ul>
<li>마지막에서 3번째 차원이 바뀌었다 =&gt; 마지막에서 3번째 축이 바뀌었다 =&gt; axis = -3</li>
</ul>
<p>(보너스3)</p>
<div id="12512ca1-7ee7-4ee5-a83a-faf180ed739d" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="b41258d9-19d1-47ac-9f62-8e3bf9761c45" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=-</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AxisError: axis -4 is out of bounds for array of dimension 3</code></pre>
</div>
</div>
<ul>
<li>마지막에서 4번째 차원은 없다 =&gt; 마지막에서 4번째 축이 없다 =&gt; axis = -4는 에러가 난다.</li>
</ul>
<p><code>-</code> 0차원은 축이 없으므로 concatenate를 쓸 수 없다.</p>
<div id="25fef18e-d6c5-49a2-83ea-52da0f3b37fb" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array(<span class="dv">1</span>)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span> np.array(<span class="op">-</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="87d1c805-0f40-4489-af78-dd5c20f969f2" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>((), ())</code></pre>
</div>
</div>
<div id="2c86ecd8-c894-4a93-bd12-c35fc60709e7" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: zero-dimensional arrays cannot be concatenated</code></pre>
</div>
</div>
<p><code>-</code> 꼭 a,b가 같은 차원일 필요는 없다.</p>
<div id="256c1d1d-27ef-4e92-850d-12f40761703c" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">4</span>)).reshape(<span class="dv">2</span>,<span class="dv">2</span>) </span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">2</span>)).reshape(<span class="dv">2</span>,<span class="dv">1</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="86b340c3-7ffb-4780-b3b5-4be17cebfd5f" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>array([[0, 1, 0],
       [2, 3, 1]])</code></pre>
</div>
</div>
<div id="4d772f56-efca-43db-b0b7-b32a27bbfdff" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>((2, 2), (2, 1), (2, 3))</code></pre>
</div>
</div>
</section>
<section id="b.-np.stack" class="level2">
<h2 class="anchored" data-anchor-id="b.-np.stack">B. <code>np.stack</code></h2>
<p><code>-</code> 혹시 아래가 가능할까?</p>
<ul>
<li>(3,) 결합 (3,) =&gt; (3,2)</li>
</ul>
<div id="d34ad33c-bf74-468b-800d-eabc922271d6" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8dae0dc9-9300-4657-892f-246d072ae31c" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>a,b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>(array([1, 2, 3]), array([-1, -2, -3]))</code></pre>
</div>
</div>
<div id="51132074-f119-4d25-abd7-0811904f73d1" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>AxisError: axis 1 is out of bounds for array of dimension 1</code></pre>
</div>
</div>
<ul>
<li>불가능</li>
</ul>
<p><code>-</code> 아래와 같이 하면 해결가능</p>
<div id="6803247c-f017-4d51-b9a6-86e047eb2e60" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]).reshape(<span class="dv">3</span>,<span class="dv">1</span>) </span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="db7ce387-f76a-4914-882a-d4c027ce2971" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>a,b</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>(array([[1],
        [2],
        [3]]),
 array([[-1],
        [-2],
        [-3]]))</code></pre>
</div>
</div>
<div id="911e97c9-ac8c-47ce-9ae5-246ea17d4ae6" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="154">
<pre><code>array([[ 1, -1],
       [ 2, -2],
       [ 3, -3]])</code></pre>
</div>
</div>
<ul>
<li>분석: (3) (3) =&gt; (3,1) (3,1) =&gt; (3,1) concat (3,1)</li>
</ul>
<p><code>-</code> 위의 과정을 줄여서 아래와 같이 할 수 있다.</p>
<div id="1fd078a1-f077-4298-887a-0de58df0e9f3" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb307"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb307-2"><a href="#cb307-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9b0967f0-5c73-4560-bec3-470dca45d14d" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<pre><code>array([[ 1, -1],
       [ 2, -2],
       [ 3, -3]])</code></pre>
</div>
</div>
<p><code>-</code> 아래도 가능</p>
<div id="7f091ab3-1ff8-464d-855f-861007b54b38" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>array([[ 1,  2,  3],
       [-1, -2, -3]])</code></pre>
</div>
</div>
<p><code>-</code> 분석해보고 외우자</p>
<p>(분석1)</p>
<div id="95b7fff9-90f7-4e75-bd38-a3267501b59a" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="74641b98-a516-4604-955f-5b1fbee5c086" class="cell" data-execution_count="162">
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.stack([a,b],axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="162">
<pre><code>((3,), (3,), (2, 3))</code></pre>
</div>
</div>
<ul>
<li><ol start="3" type="1">
<li><ol start="3" type="1">
<li>=&gt; 첫 위치에 축을 추가 (axis=0) =&gt; (1,3) (1,3) =&gt; (2,3)</li>
</ol></li>
</ol></li>
</ul>
<p>(분석2)</p>
<div id="ed14fd51-1dfe-42c0-bc37-b1031c6577be" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="595bcb72-64c4-417b-9f83-7fe0bdd1314b" class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape, np.stack([a,b],axis<span class="op">=</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre><code>((3,), (3,), (3, 2))</code></pre>
</div>
</div>
<ul>
<li><ol start="3" type="1">
<li><ol start="3" type="1">
<li>=&gt; 두 위치에 축을 추가 (axis=1) =&gt; (3,1) (3,1) =&gt; (3,2)</li>
</ol></li>
</ol></li>
</ul>
<p><code>-</code> 고차원예제</p>
<div id="cb5a2f3d-3ffc-48fa-a24b-508749c23b8d" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">3</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">5</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>) </span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7adfb274-6137-4b1f-a6be-2ed14e317802" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb319"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb319-1"><a href="#cb319-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>((3, 4, 5), (3, 4, 5))</code></pre>
</div>
</div>
<div id="35bd9362-c7f2-4be9-8b9a-e508588233c3" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">0</span>).shape <span class="co"># (3,4,5) =&gt; (1,3,4,5) // 첫 위치에 축이 추가되고 스택 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>(2, 3, 4, 5)</code></pre>
</div>
</div>
<div id="778f34a0-4f00-4dcd-ad58-8e01fe8d7af0" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">1</span>).shape <span class="co"># (3,4,5) =&gt; (3,1,4,5) // 두번째 위치에 축이 추가되고 스택 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="174">
<pre><code>(3, 2, 4, 5)</code></pre>
</div>
</div>
<div id="8995d964-08b2-4601-9169-146b4afa7c56" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">2</span>).shape <span class="co"># (3,4,5) =&gt; (3,4,1,5) // 세번째 위치에 축이 추가되고 스택 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>(3, 4, 2, 5)</code></pre>
</div>
</div>
<div id="f9898dba-30a3-4ba6-a887-3dd50ee51865" class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">3</span>).shape <span class="co"># (3,4,5) =&gt; (3,4,5,1) // 네번째 위치에 축이 추가되고 스택 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="179">
<pre><code>(3, 4, 5, 2)</code></pre>
</div>
</div>
<div id="df7e3a6b-b7f5-4d9e-a1b1-98585453a09e" class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=-</span><span class="dv">1</span>).shape <span class="co"># axis=-1 &lt;=&gt; axis=3 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="181">
<pre><code>(3, 4, 5, 2)</code></pre>
</div>
</div>
<div id="6bc38079-d994-4541-9809-65a425e598e5" class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb331"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=-</span><span class="dv">2</span>).shape <span class="co"># axis=-2 &lt;=&gt; axis=2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="182">
<pre><code>(3, 4, 2, 5)</code></pre>
</div>
</div>
<p><strong><em>np.concatenate</em></strong> 는 축의 총 갯수를 유지하면서 결합, <strong><em>np.stack</em></strong>은 축의 갯수를 하나 증가시키면서 결합</p>
</section>
<section id="c.-sum" class="level2">
<h2 class="anchored" data-anchor-id="c.-sum">C. <code>sum</code></h2>
<p><code>-</code> 1차원</p>
<div id="540b3703-e805-4853-97e9-3e6cebcec068" class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]) </span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="497c2a6a-c4c0-41ba-9e3a-105beddcd998" class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="213">
<pre><code>6</code></pre>
</div>
</div>
<div id="89745f83-fbe9-49f1-ab1a-3eb51c0a4f8e" class="cell" data-execution_count="214">
<div class="sourceCode cell-code" id="cb337"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="214">
<pre><code>6</code></pre>
</div>
</div>
<p><code>-</code> 2차원</p>
<div id="e1970353-9567-410c-885a-9b4805328ad1" class="cell" data-execution_count="208">
<div class="sourceCode cell-code" id="cb339"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">6</span>)).reshape(<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="208">
<pre><code>array([[0, 1, 2],
       [3, 4, 5]])</code></pre>
</div>
</div>
<div id="f5a375f1-0460-4a88-8cb9-66b7cbd1efcc" class="cell" data-execution_count="209">
<div class="sourceCode cell-code" id="cb341"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>() <span class="co"># 전체합</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="209">
<pre><code>15</code></pre>
</div>
</div>
<div id="e5fbfa95-ec34-4bff-adaa-b50c7b396690" class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb343"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="210">
<pre><code>array([3, 5, 7])</code></pre>
</div>
</div>
<div id="a38ec23d-fa73-4b5b-86ff-7c06ed88ce04" class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb345"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="211">
<pre><code>array([ 3, 12])</code></pre>
</div>
</div>
<p><code>-</code> 2차원 결과 분석</p>
<div id="dd374b3d-bf34-4968-9c3b-b0099f96b06e" class="cell" data-execution_count="193">
<div class="sourceCode cell-code" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a>a.shape, a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="193">
<pre><code>((2, 3), (3,))</code></pre>
</div>
</div>
<ul>
<li>첫번째 축이 삭제됨 =&gt; axis=0</li>
</ul>
<div id="5dd42841-9094-4d5f-b61c-e1e7653fd642" class="cell" data-execution_count="195">
<div class="sourceCode cell-code" id="cb349"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" aria-hidden="true" tabindex="-1"></a>a.shape, a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="195">
<pre><code>((2, 3), (2,))</code></pre>
</div>
</div>
<ul>
<li>두번째 축이 삭제됨 =&gt; axis=1</li>
</ul>
<p><code>-</code> 연습</p>
<div id="41bed304-59d2-419b-9437-832daff5ed96" class="cell" data-execution_count="197">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">10</span>)).reshape(<span class="dv">5</span>,<span class="dv">2</span>) </span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="197">
<pre><code>array([[0, 1],
       [2, 3],
       [4, 5],
       [6, 7],
       [8, 9]])</code></pre>
</div>
</div>
<p>(문제1) 1열의 합, 2열의 합을 계산하고 싶다면?</p>
<p>(풀이) 차원이 (5,2) =&gt; (2,) 로 나와야 한다. (그럼 첫번째 축이 삭제되어야 하네?)</p>
<div id="10fe9b4b-b611-42c5-825f-936ba3437c74" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="198">
<pre><code>array([20, 25])</code></pre>
</div>
</div>
<p>(문제2) 1행의 합, 2행의 합, … , 5행의 합을 계산하고 싶다면?</p>
<p>(풀이) 차원이 (5,2) =&gt; (5,)로 나와야 한다. (그럼 두번째 축이 삭제되어야 하네?)</p>
<div id="afe0d3d8-62cb-47dc-8391-d1685b4bea6d" class="cell" data-execution_count="199">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="199">
<pre><code>array([ 1,  5,  9, 13, 17])</code></pre>
</div>
</div>
<p>(문제3) a의 모든원소의 합을 계산하고 싶다면?</p>
<p>(풀이) 차원이 (5,2) =&gt; () 로 나와야 한다. (첫번째축, 두번째축이 모두 삭제되어야 하네?)</p>
<div id="23bae0ff-cd9c-4f8b-96d3-df38fa2fbd5f" class="cell" data-execution_count="201">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>(axis<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="201">
<pre><code>45</code></pre>
</div>
</div>
<div id="649633b9-2dc5-4cf8-8029-7ca07c4cf2da" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>() <span class="co"># 즉 a.sum(axis=(0,1))이 디폴트값임 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="203">
<pre><code>45</code></pre>
</div>
</div>
</section>
<section id="d.-mean-std-max-min-prod" class="level2">
<h2 class="anchored" data-anchor-id="d.-mean-std-max-min-prod">D. <code>mean</code>, <code>std</code>, <code>max</code>, <code>min</code>, <code>prod</code></h2>
<p><code>-</code> 모두 sum이랑 유사한 논리</p>
<div id="3f978eb8-f112-49e8-b688-2623468467ab" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb361"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">10</span>)).reshape(<span class="dv">5</span>,<span class="dv">2</span>)</span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="218">
<pre><code>array([[0, 1],
       [2, 3],
       [4, 5],
       [6, 7],
       [8, 9]])</code></pre>
</div>
</div>
<div id="26ce238f-4175-4e0c-9696-9fccfa2a1857" class="cell" data-execution_count="225">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a>a.mean(axis<span class="op">=</span><span class="dv">0</span>), a.std(axis<span class="op">=</span><span class="dv">0</span>), a.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">0</span>), a.<span class="bu">min</span>(axis<span class="op">=</span><span class="dv">0</span>), a.prod(axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="225">
<pre><code>(array([4., 5.]),
 array([2.82842712, 2.82842712]),
 array([8, 9]),
 array([0, 1]),
 array([  0, 945]))</code></pre>
</div>
</div>
<div id="c41e6522-f0b9-4043-b418-aea5cfe238fb" class="cell" data-execution_count="227">
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a>a.mean(axis<span class="op">=</span><span class="dv">1</span>), a.std(axis<span class="op">=</span><span class="dv">1</span>), a.<span class="bu">max</span>(axis<span class="op">=</span><span class="dv">1</span>), a.<span class="bu">min</span>(axis<span class="op">=</span><span class="dv">1</span>), a.prod(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="227">
<pre><code>(array([0.5, 2.5, 4.5, 6.5, 8.5]),
 array([0.5, 0.5, 0.5, 0.5, 0.5]),
 array([1, 3, 5, 7, 9]),
 array([0, 2, 4, 6, 8]),
 array([ 0,  6, 20, 42, 72]))</code></pre>
</div>
</div>
<p><code>-</code> 참고로 std는 분포를 n으로 나눈다.</p>
<div id="95b64602-1b21-4cb2-a526-e5ec24aeef70" class="cell" data-execution_count="228">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>a.std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="228">
<pre><code>1.118033988749895</code></pre>
</div>
</div>
<div id="8c6c2597-e58b-4413-8611-3e5320be9d3d" class="cell" data-execution_count="233">
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(<span class="bu">sum</span>((a<span class="op">-</span>a.mean())<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="233">
<pre><code>1.118033988749895</code></pre>
</div>
</div>
<p><code>-</code> 분모를 n-1로 나눌려면?</p>
<div id="25de7b77-8221-425d-b416-ed2cb0209771" class="cell" data-execution_count="234">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>a.std(ddof<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="234">
<pre><code>1.2909944487358056</code></pre>
</div>
</div>
<div id="ca3029cb-5172-49ec-b6f3-e184667c15bf" class="cell" data-execution_count="235">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(<span class="bu">sum</span>((a<span class="op">-</span>a.mean())<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="235">
<pre><code>1.2909944487358056</code></pre>
</div>
</div>
</section>
<section id="e.-argmax-argmin" class="level2">
<h2 class="anchored" data-anchor-id="e.-argmax-argmin">E. <code>argmax</code>, <code>argmin</code></h2>
<p><code>-</code> 1차원</p>
<div id="adf48e09-6532-4952-a438-7dc7f0be7395" class="cell" data-execution_count="299">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([<span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">4</span>])</span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="299">
<pre><code>array([ 1, -2,  3, 10,  4])</code></pre>
</div>
</div>
<div id="0a3a5537-ff30-44a3-b964-3f1eb26d8fa2" class="cell" data-execution_count="300">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a>a.argmax() <span class="co"># 가장 큰 값이 위치한 원소의 인덱스를 리턴 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="300">
<pre><code>3</code></pre>
</div>
</div>
<div id="12e4a0ae-fe64-4601-b9fc-5af0468596b2" class="cell" data-execution_count="301">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>a.argmin() <span class="co"># 가장 작은 값이 위치한 원소의 인덱스를 리턴 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="301">
<pre><code>1</code></pre>
</div>
</div>
<p><code>-</code> 2차원</p>
<div id="52069876-165a-405c-b802-fbefedaa7f51" class="cell" data-execution_count="312">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>)</span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.random.randn(<span class="dv">4</span><span class="op">*</span><span class="dv">5</span>).reshape(<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="312">
<pre><code>array([[ 0.38342049,  1.0841745 ,  1.14277825,  0.30789368,  0.23778744],
       [ 0.35595116, -1.66307542, -1.38277318, -1.92684484, -1.4862163 ],
       [ 0.00692519, -0.03488725, -0.34357323,  0.70895648, -1.55100608],
       [ 1.34565583, -0.05654272, -0.83017342, -1.46395159, -0.35459593]])</code></pre>
</div>
</div>
<div id="d31f177a-d962-4b47-9b5e-ffcbce6eb996" class="cell" data-execution_count="314">
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a>a.argmin(), a.<span class="bu">min</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="314">
<pre><code>(8, -1.9268448358915802)</code></pre>
</div>
</div>
<div id="58d7af5d-3f99-4d47-9169-d544f9ce2ade" class="cell" data-execution_count="315">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a>a.argmax(), a.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="315">
<pre><code>(15, 1.3456558341738827)</code></pre>
</div>
</div>
<div id="3b14ac2f-9215-4ac7-a949-e555bff1ee92" class="cell" data-execution_count="317">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a>a.argmin(axis<span class="op">=</span><span class="dv">0</span>), a.argmin(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="317">
<pre><code>(array([2, 1, 1, 1, 2]), array([4, 3, 4, 3]))</code></pre>
</div>
</div>
<div id="25ea95e5-0541-46fe-ad32-1dfafa96a7b8" class="cell" data-execution_count="318">
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a>a.argmax(axis<span class="op">=</span><span class="dv">0</span>), a.argmax(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="318">
<pre><code>(array([3, 0, 0, 2, 0]), array([2, 0, 3, 0]))</code></pre>
</div>
</div>
</section>
<section id="f.-cumsum-cumprod" class="level2">
<h2 class="anchored" data-anchor-id="f.-cumsum-cumprod">F. <code>cumsum</code>, <code>cumprod</code></h2>
<p><code>-</code> 1차원</p>
<div id="7c91f77a-a8ad-4c6f-946f-56960df49fe2" class="cell" data-execution_count="319">
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="319">
<pre><code>array([1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="8d94dbe1-fa0e-478b-8893-9ec8f5626066" class="cell" data-execution_count="320">
<div class="sourceCode cell-code" id="cb393"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>a.cumsum()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="320">
<pre><code>array([ 1,  3,  6, 10])</code></pre>
</div>
</div>
<div id="c32c6c47-1014-4baf-991b-7f5fec058ab7" class="cell" data-execution_count="321">
<div class="sourceCode cell-code" id="cb395"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a>a.cumprod()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="321">
<pre><code>array([ 1,  2,  6, 24])</code></pre>
</div>
</div>
<p><code>-</code> 2차원</p>
<div id="cad3c54b-0d32-4e89-8b28-33eddee4efea" class="cell" data-execution_count="322">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">3</span><span class="op">*</span><span class="dv">4</span>)).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="322">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<div id="b1e2cbc9-59f1-4d46-b311-30ed2b715fa4" class="cell" data-execution_count="325">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a>a.cumsum(axis<span class="op">=</span><span class="dv">0</span>), a.cumsum(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="325">
<pre><code>(array([[ 0,  1,  2,  3],
        [ 4,  6,  8, 10],
        [12, 15, 18, 21]]),
 array([[ 0,  1,  3,  6],
        [ 4,  9, 15, 22],
        [ 8, 17, 27, 38]]))</code></pre>
</div>
</div>
<div id="5f38d2ba-b1c0-48f5-8170-1d595366d59f" class="cell" data-execution_count="326">
<div class="sourceCode cell-code" id="cb401"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb401-1"><a href="#cb401-1" aria-hidden="true" tabindex="-1"></a>a.cumprod(axis<span class="op">=</span><span class="dv">0</span>), a.cumprod(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="326">
<pre><code>(array([[  0,   1,   2,   3],
        [  0,   5,  12,  21],
        [  0,  45, 120, 231]]),
 array([[   0,    0,    0,    0],
        [   4,   20,  120,  840],
        [   8,   72,  720, 7920]]))</code></pre>
</div>
</div>
</section>
<section id="g.-diff" class="level2">
<h2 class="anchored" data-anchor-id="g.-diff">G. <code>diff</code></h2>
<p><code>-</code> 1차차분</p>
<div id="3a8e70a5-b694-4d91-9ac0-46a87d99d9da" class="cell" data-execution_count="327">
<div class="sourceCode cell-code" id="cb403"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb403-1"><a href="#cb403-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>])</span>
<span id="cb403-2"><a href="#cb403-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="327">
<pre><code>array([1, 2, 4, 6, 7])</code></pre>
</div>
</div>
<div id="65a2b4c1-e799-4c4d-b323-43a76c530e60" class="cell" data-execution_count="328">
<div class="sourceCode cell-code" id="cb405"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" aria-hidden="true" tabindex="-1"></a>np.diff(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="328">
<pre><code>array([1, 2, 2, 1])</code></pre>
</div>
</div>
<p><code>-</code> 2차차분</p>
<div id="b2feac30-a86a-4660-8749-735205520921" class="cell" data-execution_count="331">
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>np.diff(np.diff(a))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="331">
<pre><code>array([ 1,  0, -1])</code></pre>
</div>
</div>
<p><code>-</code> prepend, append</p>
<div id="fe4d7e0b-d580-4c75-bea0-4ec221f531ea" class="cell" data-execution_count="332">
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">7</span>])</span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="332">
<pre><code>array([1, 2, 4, 6, 7])</code></pre>
</div>
</div>
<div id="6888ac30-5798-4dcd-aa3a-2947deaa6f5f" class="cell" data-execution_count="339">
<div class="sourceCode cell-code" id="cb411"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb411-1"><a href="#cb411-1" aria-hidden="true" tabindex="-1"></a>np.diff(a,prepend<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb411-2"><a href="#cb411-2" aria-hidden="true" tabindex="-1"></a><span class="co">#np.diff(np.array([100]+a.tolist()) )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="339">
<pre><code>array([-99,   1,   2,   2,   1])</code></pre>
</div>
</div>
<ul>
<li>[1,2,4,6,7] -&gt; [100,1,2,3,4,6] -&gt; np.diff</li>
</ul>
<div id="8d56d5ed-ef66-43b0-9ac5-ef8093b5ca7c" class="cell" data-execution_count="343">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>np.diff(a,append<span class="op">=</span><span class="dv">100</span>)</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="co">#np.diff(np.array(a.tolist()+[100]) )</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="343">
<pre><code>array([ 1,  2,  2,  1, 93])</code></pre>
</div>
</div>
<p>(예제) a=[1,2,4,6,7]의 앞에 1을 추가하여 차분하라.</p>
<div id="44cf0e39-4d92-477f-932b-ef3e635e032d" class="cell" data-execution_count="347">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>np.diff(a,prepend<span class="op">=</span>a[<span class="dv">0</span>])</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="co">#np.diff(a,prepend=1)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="347">
<pre><code>array([0, 1, 2, 2, 1])</code></pre>
</div>
</div>
<p>(예제) a=[1,2,4,6,7]의 뒤에 7을 추가하여 차분하라.</p>
<div id="1b58fa87-4f83-4318-9689-53605bfabea9" class="cell" data-execution_count="348">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>np.diff(a,append<span class="op">=</span>a[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="co">#np.diff(a,append=7)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="348">
<pre><code>array([1, 2, 2, 1, 0])</code></pre>
</div>
</div>
<p><code>-</code> 2차원 array의 차분</p>
<div id="38132749-a31d-4bca-bafc-a8ef778838c7" class="cell" data-execution_count="367">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">24</span>).reshape(<span class="dv">4</span>,<span class="dv">6</span>)</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="367">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 6,  7,  8,  9, 10, 11],
       [12, 13, 14, 15, 16, 17],
       [18, 19, 20, 21, 22, 23]])</code></pre>
</div>
</div>
<div id="f9012f4c-ffb8-438d-8064-76185a90138e" class="cell" data-execution_count="368">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a>np.diff(a,axis<span class="op">=</span><span class="dv">0</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="368">
<pre><code>array([[6, 6, 6, 6, 6, 6],
       [6, 6, 6, 6, 6, 6],
       [6, 6, 6, 6, 6, 6]])</code></pre>
</div>
</div>
<div id="16cd26da-cbf5-432a-a2b8-6c3cec3f4ee3" class="cell" data-execution_count="369">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a>np.diff(a,axis<span class="op">=</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="369">
<pre><code>array([[1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1],
       [1, 1, 1, 1, 1]])</code></pre>
</div>
</div>
</section>
</section>
<section id="numpy의-랜덤모듈" class="level1">
<h1>5. <code>numpy</code>의 랜덤모듈</h1>
<section id="a.-np.random.rand" class="level2">
<h2 class="anchored" data-anchor-id="a.-np.random.rand">A. np.random.rand()</h2>
<p><code>-</code> 0~1사이에서 10개의 난수 생성</p>
<div id="cb0509b7-58ac-4eec-a665-40ea91c2141d" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([0.9762396 , 0.62290682, 0.65602078, 0.22890413, 0.01139937,
       0.71156552, 0.22585515, 0.98642156, 0.20169783, 0.52544263])</code></pre>
</div>
</div>
<p><code>-</code> 0~2사이에서 10개의 난수 생성</p>
<div id="44a86c12-15a4-47d4-b474-44f13a5fa348" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([0.19486166, 1.31320638, 1.75920753, 0.03976132, 0.65443053,
       0.98238346, 0.81586536, 1.26374209, 0.05189084, 1.53713552])</code></pre>
</div>
</div>
<p><code>-</code> 1~2사이에서 10개의 난수 생성</p>
<div id="e11db822-af38-491f-88ad-3d5c3a034ff6" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)<span class="op">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([1.14697821, 1.52687013, 1.10827739, 1.87820387, 1.81630002,
       1.93842216, 1.30725718, 1.21386634, 1.9331912 , 1.29694134])</code></pre>
</div>
</div>
<p><code>-</code> 1~3사이에서 10개의 난수 생성</p>
<div id="9eb63551-8a39-4ded-843e-e114d1a6a6e0" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span> <span class="co"># 1~3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([2.10122574, 2.67412063, 2.70573365, 1.49312813, 2.72674064,
       2.20040351, 2.26697979, 1.07834112, 2.6602285 , 1.60157633])</code></pre>
</div>
</div>
</section>
<section id="b.-np.random.randn" class="level2">
<h2 class="anchored" data-anchor-id="b.-np.random.randn">B. np.random.randn()</h2>
<p><code>-</code> N(0,1)에서 10개 추출</p>
<div id="8130547c-bf3b-4937-8d32-342397d69be2" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>) <span class="co"># 표준정규분포에서 10개의 샘플 추출 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>array([-0.40371384,  0.56295305, -1.03454983, -0.67628805, -0.89951532,
       -0.1925445 ,  1.43684725,  0.34022492,  0.96763699, -2.0699127 ])</code></pre>
</div>
</div>
<p><code>-</code> N(1,1)에서 10개 추출</p>
<div id="3b163297-cc9e-45f1-8bf0-428cd81c8aa1" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>)<span class="op">+</span><span class="dv">1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([ 0.69440765, -0.58892798,  1.86823224,  1.50473088,  1.56127732,
        1.53295801, -0.44982257,  0.41660235,  0.50013233,  3.07135415])</code></pre>
</div>
</div>
<p><code>-</code> N(0,4)에서 10개 추출 (평균이 0이고 분산이 4인 분포)</p>
<div id="c7568fd0-5c48-40ce-846e-b5bbc32d3565" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([ 0.48765347, -2.686622  ,  6.03529241,  0.52181081,  5.31070099,
       -1.02246697, -0.3058778 ,  0.16147941, -2.11923353, -2.55772141])</code></pre>
</div>
</div>
<p><code>-</code> N(3,4)에서 10개 추출</p>
<div id="ef8f76ea-547d-4e0a-923f-97fbeb26f0ec" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([6.20706555, 3.95308508, 7.02954382, 2.57838168, 3.40580485,
       4.37254926, 3.94572032, 2.32058837, 3.74756129, 4.81608642])</code></pre>
</div>
</div>
</section>
<section id="c.-np.random.randint" class="level2">
<h2 class="anchored" data-anchor-id="c.-np.random.randint">C. np.random.randint()</h2>
<p><code>-</code> [0,7)의 범위에서 하나의 정수를 랜덤으로 생성</p>
<div id="9a0e2089-560a-4a3b-aa35-8a57b69ccb09" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">7</span>) <span class="co"># [0,7)의 범위에서 하나의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>2</code></pre>
</div>
</div>
<p><code>-</code> [0,7)의 범위에서 20개의 정수를 랜덤으로 생성</p>
<div id="bdeb1b04-d0e5-4711-a51a-caf55033f695" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">7</span>,size<span class="op">=</span>(<span class="dv">20</span>,)) <span class="co"># [0,7)의 범위에서 20개의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([5, 6, 6, 0, 6, 6, 2, 0, 3, 6, 2, 3, 2, 2, 6, 6, 5, 2, 3, 2])</code></pre>
</div>
</div>
<p><code>-</code> [0,7)의 범위에서 (2,2) shape 으로 정수를 랜덤으로 생성</p>
<div id="8a1f791c-b124-43e0-bf90-fc3192d322c8" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">7</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># [0,7)의 범위에서 (2,2) shape의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>array([[6, 4],
       [3, 1]])</code></pre>
</div>
</div>
<p><code>-</code> 위와 같은 코드를 아래와 같이 구현가능</p>
<div id="115a2a95-24cd-4d49-90a3-2d79f8bb7015" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(low<span class="op">=</span><span class="dv">7</span>,size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># [0,7)의 범위에서 (5,5) shape의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>array([[4, 1, 2, 0, 4],
       [5, 0, 1, 1, 3],
       [2, 1, 4, 6, 6],
       [4, 1, 6, 1, 5],
       [4, 2, 1, 3, 4]])</code></pre>
</div>
</div>
<p><code>-</code> [10,20) 의 범위에서 (5,5) shape 정수를 랜덤으로 생성</p>
<div id="fd48291b-c7d0-4bbb-b338-ae58ffd6ee7a" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(low<span class="op">=</span><span class="dv">10</span>,high<span class="op">=</span><span class="dv">20</span>,size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># [10,20)의 범위에서 (5,5)shape의 정수생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>array([[10, 13, 11, 15, 17],
       [10, 16, 15, 15, 11],
       [15, 14, 11, 19, 11],
       [10, 13, 13, 13, 14],
       [14, 19, 17, 13, 19]])</code></pre>
</div>
</div>
<p><code>-</code> 의문: <code>np.random.randint(low=7,size=(5,5))</code> 가 좀 이상하다. 사실 <code>np.random.randint(high=7,size=(5,5))</code>가 되어야 맞지 않는가?</p>
<p>-&gt; 저도 그렇게 생각하긴 하는데요, 구현이 이렇게 되어있습니다. 도움말 확인!</p>
<pre><code>Return random integers from the "discrete uniform" distribution of the specified dtype in the "half-open" interval [`low`, `high`). If `high` is None (the default), then results are from [0, `low`).</code></pre>
</section>
<section id="d.-np.random.choice" class="level2">
<h2 class="anchored" data-anchor-id="d.-np.random.choice">D. np.random.choice()</h2>
<p><code>-</code> ver1</p>
<div id="183f550e-0221-4d9c-ad2e-92d49db9d1e7" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a>np.random.choice(<span class="dv">5</span>,<span class="dv">20</span>) <span class="co"># [0,5)에서 20개를 뽑음, 중복허용 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>array([1, 1, 4, 3, 0, 2, 4, 4, 4, 4, 0, 4, 2, 2, 2, 2, 2, 1, 4, 1])</code></pre>
</div>
</div>
<ul>
<li>이것은 np.random.randint(5,size=(20,)) 와 같은 코드임</li>
</ul>
<p><code>-</code> ver2</p>
<div id="0575ef12-5d97-49eb-b6c7-6ed5b7092deb" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a>np.random.choice([<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],<span class="dv">20</span>) <span class="co"># [0,1,2,3]에서 20개를 뽑음, 중복허용</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>array([1, 0, 0, 1, 3, 3, 0, 1, 0, 0, 3, 3, 0, 1, 2, 3, 2, 1, 2, 3])</code></pre>
</div>
</div>
<div id="e4dab4f1-74da-4073-8d18-37f6b90f7b9d" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a>np.random.choice([<span class="st">"apple"</span>,<span class="st">"orange"</span>,<span class="st">"banana"</span>],<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>array(['orange', 'orange', 'orange', 'apple', 'orange', 'apple', 'apple',
       'apple', 'orange', 'orange', 'orange', 'apple', 'apple', 'banana',
       'banana', 'orange', 'orange', 'orange', 'orange', 'banana'],
      dtype='&lt;U6')</code></pre>
</div>
</div>
<div id="e84107e7-b70e-4b31-98d7-1432f3b5f4bc" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>np.random.choice([<span class="st">"apple"</span>,<span class="st">"orange"</span>,<span class="st">"banana"</span>],<span class="dv">2</span>,replace<span class="op">=</span><span class="va">False</span>) <span class="co"># 중복허용 X </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>array(['banana', 'orange'], dtype='&lt;U6')</code></pre>
</div>
</div>
</section>
<section id="e.-통계분포" class="level2">
<h2 class="anchored" data-anchor-id="e.-통계분포">E. 통계분포</h2>
<div id="83e3bcc9-87a3-49c9-b82f-5e51e5158440" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>np.random.binomial(n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.2</span>,size<span class="op">=</span>(<span class="dv">5</span>,)) <span class="co"># X1, ..., X5 ~ B(10,0.2) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>array([0, 1, 4, 1, 3])</code></pre>
</div>
</div>
<div id="0db37ad2-2c38-40f7-86e3-fb6b021c9d8c" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span>(<span class="dv">5</span>,)) <span class="co"># X1, ..., X5 ~ N(10,4) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>array([ 8.33296606,  7.28476525, 10.53464049,  8.70471009,  8.54969039])</code></pre>
</div>
</div>
<ul>
<li><code>np.radom.randn(5)*2 + 10</code>와 같은코드</li>
</ul>
<div id="cf264820-e132-4054-9964-3935936b1fc8" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>np.random.uniform(low<span class="op">=</span><span class="dv">2</span>,high<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span>(<span class="dv">5</span>,)) <span class="co"># X1, ..., X5 ~ U(2,4) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>array([3.77048793, 2.5993732 , 2.93630494, 2.43154214, 3.63709163])</code></pre>
</div>
</div>
<ul>
<li><code>np.random.rand(5)*2+2</code>와 같은 코드</li>
</ul>
<div id="78dd4f61-f06d-4eb1-b4bb-53ecbc1bda64" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a>np.random.poisson(lam<span class="op">=</span><span class="dv">5</span>,size<span class="op">=</span>(<span class="dv">5</span>,)) <span class="co"># X1,...,X5 ~ Poi(5) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>array([4, 9, 4, 5, 0])</code></pre>
</div>
</div>
</section>
</section>
<section id="numpy-기타-유용한-기본기능들" class="level1">
<h1>6. <code>numpy</code> – 기타 유용한 기본기능들</h1>
<section id="a.-np.where-np.argwhere" class="level2">
<h2 class="anchored" data-anchor-id="a.-np.where-np.argwhere">A. np.where, np.argwhere</h2>
<p><code>-</code> 1차원</p>
<div id="5db3dcd2-9cbb-499c-876b-73e335e5fcb3" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="109">
<pre><code>array([0, 0, 0, 1, 0])</code></pre>
</div>
</div>
<div id="58936d17-ae76-487f-a991-d847ada619ba" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">==</span><span class="dv">1</span>) <span class="co"># 조건 a==1을 만족하는 인덱스를 출력하라!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>(array([3]),)</code></pre>
</div>
</div>
<div id="81f5d889-7227-4429-b94f-1157f8e79c25" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a>np.argwhere(a<span class="op">==</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>array([[3]])</code></pre>
</div>
</div>
<p><code>-</code> 2차원</p>
<div id="7c6ed760-8852-467b-bd25-346f4da6bf86" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>)</span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.random.randn(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>array([[ 0.38342049,  1.0841745 ,  1.14277825,  0.30789368],
       [ 0.23778744,  0.35595116, -1.66307542, -1.38277318],
       [-1.92684484, -1.4862163 ,  0.00692519, -0.03488725]])</code></pre>
</div>
</div>
<div id="edb0a111-10e7-4d78-bbd8-9ab8943c192b" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">&lt;</span><span class="dv">0</span>) <span class="co"># 조건을 만족하는 인덱스가 (1,2), (1,3), (2,0), (2,1), (2,3) 이라는 의미</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>(array([1, 1, 2, 2, 2]), array([2, 3, 0, 1, 3]))</code></pre>
</div>
</div>
<div id="22663450-8791-4f5f-a778-628aef04d1ce" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb478"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb478-1"><a href="#cb478-1" aria-hidden="true" tabindex="-1"></a>np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>) <span class="co"># 조건을 만족하는 인덱스가 (1,2), (1,3), (2,0), (2,1), (2,3) 이라는 의미</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>array([[1, 2],
       [1, 3],
       [2, 0],
       [2, 1],
       [2, 3]])</code></pre>
</div>
</div>
<div id="ff5f9be3-1753-4dfc-8073-58b6a4cc2e17" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb480"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb480-1"><a href="#cb480-1" aria-hidden="true" tabindex="-1"></a>a[np.where(a<span class="op">&lt;</span><span class="dv">0</span>)] <span class="co"># 조건을 만족하는 인덱스가 모두 출력 =&gt; 1차원 array로 출력 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>array([-1.66307542, -1.38277318, -1.92684484, -1.4862163 , -0.03488725])</code></pre>
</div>
</div>
<div id="c8586680-e9ec-4122-bc45-af582c1655dd" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb482"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb482-1"><a href="#cb482-1" aria-hidden="true" tabindex="-1"></a>a[np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>)] <span class="co"># 출력불가능</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: index 3 is out of bounds for axis 0 with size 3</code></pre>
</div>
</div>
<div id="b0a70a44-8522-4d1b-8bc2-9fb151f7bc2d" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb484"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb484-1"><a href="#cb484-1" aria-hidden="true" tabindex="-1"></a>a[np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>)[<span class="dv">0</span>][<span class="dv">0</span>],np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>)[<span class="dv">0</span>][<span class="dv">1</span>]] <span class="co"># 어거지로 출력할수는 있음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<pre><code>-1.6630754187023522</code></pre>
</div>
</div>
<p><code>-</code> np.where의 특수기능</p>
<div id="52f16ae7-0884-49c1-96ea-ab409b1c4858" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>) </span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.random.randn(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb486-3"><a href="#cb486-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>array([[ 0.38342049,  1.0841745 ,  1.14277825,  0.30789368],
       [ 0.23778744,  0.35595116, -1.66307542, -1.38277318],
       [-1.92684484, -1.4862163 ,  0.00692519, -0.03488725]])</code></pre>
</div>
</div>
<div id="8ed23164-6a9f-4bd6-9fc7-f5c3fc18cac7" class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb488"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb488-1"><a href="#cb488-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,a) <span class="co"># a&lt;0을 체크 =&gt; 조건에 맞으면 0 =&gt; 조건에 안맞으면 a </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<pre><code>array([[0.38342049, 1.0841745 , 1.14277825, 0.30789368],
       [0.23778744, 0.35595116, 0.        , 0.        ],
       [0.        , 0.        , 0.00692519, 0.        ]])</code></pre>
</div>
</div>
<div id="3640b889-96e8-497b-b8e9-953083a707e0" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb490"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># a&lt;0을 체크 =&gt; 조건에 맞으면 0 =&gt; 조건에 안맞으면 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>array([[1, 1, 1, 1],
       [1, 1, 0, 0],
       [0, 0, 1, 0]])</code></pre>
</div>
</div>
<p><code>-</code> 요약 - np.where: 인덱스의 좌표를 읽는 가독성은 떨어짐. 그런데 조건에 맞는 원소를 출력하거나 처리하는 (특수기능) 목적으로는 좋은 함수<br>
- np.argwhere: 인덱스의 좌표를 읽는 가독성은 좋은 편임. 그런데 조건에 맞는 원소를 출력하거나 처리하는 기능은 떨어짐</p>
</section>
<section id="b.-인덱싱고급" class="level2">
<h2 class="anchored" data-anchor-id="b.-인덱싱고급">B. 인덱싱고급</h2>
<p><code>-</code> 원래 a는 2d array</p>
<div id="24e6af0e-b7fc-4d41-b007-d7b06e03b637" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<p><code>-</code> 경우1: 인덱싱 결과가 1d array로 나올수 있음</p>
<div id="751a6a97-4e96-4778-b381-022c4c207994" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb494"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>,:] <span class="co"># 인덱싱의 결과 축의 갯수가 바뀐다! 2d array -&gt; 1d array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>array([0, 1, 2, 3])</code></pre>
</div>
</div>
<p><code>-</code> 경우2: 물론 인덱싱 결과가 2d array로 나올 수도 있음</p>
<div id="1a2bdcca-64c4-4402-98d3-bb60339a406d" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">1</span>],:] <span class="co"># 이것은 축의 숫자가 유지된다. 2d array -&gt; 2d array </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="159">
<pre><code>array([[0, 1, 2, 3],
       [4, 5, 6, 7]])</code></pre>
</div>
</div>
<p><code>-</code> 경우1의 상황에서도 축의 갯수를 유지하면서 인덱싱하려면?</p>
<div id="678b9509-77d9-453f-a849-50dc65935103" class="cell" data-execution_count="161">
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>],:] <span class="co"># 이번에는 인덱싱의 결과 축의 갯수가 유지된다! 2d array -&gt; 2d array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>array([[0, 1, 2, 3]])</code></pre>
</div>
</div>
<div id="8569f243-d9b7-4cd7-a87e-d2fc2755544f" class="cell" data-execution_count="163">
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a>a[:,[<span class="dv">0</span>]] <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="163">
<pre><code>array([[0],
       [4],
       [8]])</code></pre>
</div>
</div>
<p><code>-</code> 미묘한 차이를 이해할것</p>
<div id="002c38ac-fe02-4a3d-82e4-96032d21bfce" class="cell" data-execution_count="164">
<div class="sourceCode cell-code" id="cb502"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>,:], a[[<span class="dv">0</span>],:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="164">
<pre><code>(array([0, 1, 2, 3]), array([[0, 1, 2, 3]]))</code></pre>
</div>
</div>
<div id="53a82919-6dce-4478-9fb6-00950a0fb7eb" class="cell" data-execution_count="165">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a>a[:,<span class="dv">0</span>], a[:,[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="165">
<pre><code>(array([0, 4, 8]),
 array([[0],
        [4],
        [8]]))</code></pre>
</div>
</div>
</section>
<section id="c.-np.ix_" class="level2">
<h2 class="anchored" data-anchor-id="c.-np.ix_">C. np.ix_</h2>
<p><code>-</code> 아래의 인덱싱을 비교하자.</p>
<div id="3d0684ad-cfb7-453c-810b-24280fff3683" class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="166">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<div id="94d19e6d-bffa-44d5-9a63-bc701cc185bb" class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>:<span class="dv">2</span>,<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="167">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
<div id="fb057585-1a6e-4d0f-ad63-ea24a779088c" class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb510"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb510-1"><a href="#cb510-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">1</span>],<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="168">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
<div id="788a7a68-1932-49c2-a032-4c1f0e43f5f9" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>:<span class="dv">2</span>,[<span class="dv">0</span>,<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
<p><code>-</code> 언뜻 생각하면 위의 결과와 <code>a[[0,1],[0,1]]</code>는 결과가 동일할 것 같다.</p>
<div id="c389155f-e5c2-4cca-b26b-ce91173a7a3b" class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="170">
<pre><code>array([0, 5])</code></pre>
</div>
</div>
<ul>
<li>실제로는 [a[0,0],a[1,1]]이 array로 나옴</li>
</ul>
<p><code>-</code> 사실 np.where에서 이미 관찰하였음</p>
<div id="e35e5eec-03cc-4f64-9763-b4fdb6047e1d" class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb516"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb516-1"><a href="#cb516-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="172">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<div id="f04aaa76-0ac6-4add-b016-fa0fb1eec602" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb518"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb518-1"><a href="#cb518-1" aria-hidden="true" tabindex="-1"></a>np.where(a <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<pre><code>(array([0, 1, 2]), array([0, 1, 2]))</code></pre>
</div>
</div>
<div id="d27ef928-0434-41b3-a32b-af9dec07c62b" class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb520"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb520-1"><a href="#cb520-1" aria-hidden="true" tabindex="-1"></a>a[np.where(a <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span><span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="173">
<pre><code>array([ 0,  5, 10])</code></pre>
</div>
</div>
<div id="079fe136-6bed-4137-ac4b-49e952af0513" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb522"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb522-1"><a href="#cb522-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>array([ 0,  5, 10])</code></pre>
</div>
</div>
<p><code>-</code> a[[0,1],[0,1]]이 a[0:2,0:2]를 의미하게 하려면 아래와 같이 하면 된다.</p>
<div id="fabedc92-a292-44ff-ac37-4eac851684b4" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb524"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb524-1"><a href="#cb524-1" aria-hidden="true" tabindex="-1"></a>a[np.ix_([<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>])] <span class="co"># 유용해보이지만 생각보다 잘 쓰이는건 아님 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
</section>
<section id="d.-note-1-메소드-도움말-확인하기" class="level2">
<h2 class="anchored" data-anchor-id="d.-note-1-메소드-도움말-확인하기">D. note 1: 메소드 도움말 확인하기</h2>
<p><code>-</code> 파이썬에서 함수를 적용하는 2가지 방식 - np.sum(a) - a.sum()</p>
<div id="05ea3f5e-4c22-4b61-bddd-8a13d4a06090" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb526"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb526-1"><a href="#cb526-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>])</span>
<span id="cb526-2"><a href="#cb526-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>array([1, 2, 3, 4, 5])</code></pre>
</div>
</div>
<div id="9a170019-e4ae-47a0-a659-d32233dc1153" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>15</code></pre>
</div>
</div>
<div id="7b4de94f-7b82-414c-8af4-c2d672faec54" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>15</code></pre>
</div>
</div>
<p><code>-</code> 넘파이에서 <code>a.sum()</code>에 대한 도움말은 보통 <code>np.sum()</code>에 자세히 나와있음. <span class="math inline">\(\to\)</span> <code>np.sum()</code>의 도움말을 확인하고 <code>np.sum(a)</code>와 <code>a.sum()</code>이 동일함을 이용하여 <code>a.sum()</code>의 사용법을 미루어 유추해야함.</p>
<div id="42ce993b-3d9c-4f1a-8661-5f241a5d6c8b" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Docstring:</span>
a.sum(axis=None, dtype=None, out=None, keepdims=False, initial=0, where=True)
Return the sum of the array elements over the given axis.
Refer to `numpy.sum` for full documentation.
See Also
--------
numpy.sum : equivalent function
<span class="ansi-red-fg">Type:</span>      builtin_function_or_method
</pre>
</div>
</div>
</div>
<div id="7dca4cc3-2100-4180-a31f-e491d7391388" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb533"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb533-1"><a href="#cb533-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>
np<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span>
    a<span class="ansi-blue-fg">,</span>
    axis<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    out<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    keepdims<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>no value<span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    initial<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>no value<span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    where<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>no value<span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Sum of array elements over a given axis.
Parameters
----------
a : array_like
    Elements to sum.
axis : None or int or tuple of ints, optional
    Axis or axes along which a sum is performed.  The default,
    axis=None, will sum all of the elements of the input array.  If
    axis is negative it counts from the last to the first axis.
    .. versionadded:: 1.7.0
    If axis is a tuple of ints, a sum is performed on all of the axes
    specified in the tuple instead of a single axis or all the axes as
    before.
dtype : dtype, optional
    The type of the returned array and of the accumulator in which the
    elements are summed.  The dtype of `a` is used by default unless `a`
    has an integer dtype of less precision than the default platform
    integer.  In that case, if `a` is signed then the platform integer
    is used while if `a` is unsigned then an unsigned integer of the
    same precision as the platform integer is used.
out : ndarray, optional
    Alternative output array in which to place the result. It must have
    the same shape as the expected output, but the type of the output
    values will be cast if necessary.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.
    If the default value is passed, then `keepdims` will not be
    passed through to the `sum` method of sub-classes of
    `ndarray`, however any non-default value will be.  If the
    sub-class' method does not implement `keepdims` any
    exceptions will be raised.
initial : scalar, optional
    Starting value for the sum. See `~numpy.ufunc.reduce` for details.
    .. versionadded:: 1.15.0
where : array_like of bool, optional
    Elements to include in the sum. See `~numpy.ufunc.reduce` for details.
    .. versionadded:: 1.17.0
Returns
-------
sum_along_axis : ndarray
    An array with the same shape as `a`, with the specified
    axis removed.   If `a` is a 0-d array, or if `axis` is None, a scalar
    is returned.  If an output array is specified, a reference to
    `out` is returned.
See Also
--------
ndarray.sum : Equivalent method.
add.reduce : Equivalent functionality of `add`.
cumsum : Cumulative sum of array elements.
trapz : Integration of array values using the composite trapezoidal rule.
mean, average
Notes
-----
Arithmetic is modular when using integer types, and no error is
raised on overflow.
The sum of an empty array is the neutral element 0:
&gt;&gt;&gt; np.sum([])
0.0
For floating point numbers the numerical precision of sum (and
``np.add.reduce``) is in general limited by directly adding each number
individually to the result causing rounding errors in every step.
However, often numpy will use a  numerically better approach (partial
pairwise summation) leading to improved precision in many use-cases.
This improved precision is always provided when no ``axis`` is given.
When ``axis`` is given, it will depend on which axis is summed.
Technically, to provide the best speed possible, the improved precision
is only used when the summation is along the fast axis in memory.
Note that the exact precision may vary depending on other parameters.
In contrast to NumPy, Python's ``math.fsum`` function uses a slower but
more precise approach to summation.
Especially when summing a large number of lower precision floating point
numbers, such as ``float32``, numerical errors can become significant.
In such cases it can be advisable to use `dtype="float64"` to use a higher
precision for the output.
Examples
--------
&gt;&gt;&gt; np.sum([0.5, 1.5])
2.0
&gt;&gt;&gt; np.sum([0.5, 0.7, 0.2, 1.5], dtype=np.int32)
1
&gt;&gt;&gt; np.sum([[0, 1], [0, 5]])
6
&gt;&gt;&gt; np.sum([[0, 1], [0, 5]], axis=0)
array([0, 6])
&gt;&gt;&gt; np.sum([[0, 1], [0, 5]], axis=1)
array([1, 5])
&gt;&gt;&gt; np.sum([[0, 1], [np.nan, 5]], where=[False, True], axis=1)
array([1., 5.])
If the accumulator is too small, overflow occurs:
&gt;&gt;&gt; np.ones(128, dtype=np.int8).sum(dtype=np.int8)
-128
You can also start the sum with a value other than zero:
&gt;&gt;&gt; np.sum([10], initial=5)
15
<span class="ansi-red-fg">File:</span>      ~/anaconda3/envs/py39/lib/python3.9/site-packages/numpy/core/fromnumeric.py
<span class="ansi-red-fg">Type:</span>      function
</pre>
</div>
</div>
</div>
</section>
<section id="e.-hstack-vstack" class="level2">
<h2 class="anchored" data-anchor-id="e.-hstack-vstack">E. hstack, vstack</h2>
<p><code>-</code> hstack, vstack 를 쓰는 사람도 있다.</p>
<div id="2089c2fe-61aa-4ae0-9e6f-b49ff236c0fa" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">6</span>) </span>
<span id="cb534-2"><a href="#cb534-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="807123dc-7cdb-431e-879f-b8173027f535" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb535"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb535-1"><a href="#cb535-1" aria-hidden="true" tabindex="-1"></a>np.vstack([a,b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 0, -1, -2, -3, -4, -5]])</code></pre>
</div>
</div>
<div id="bbb158b8-a27d-46dc-b169-b76fe096c146" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb537"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb537-1"><a href="#cb537-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 0, -1, -2, -3, -4, -5]])</code></pre>
</div>
</div>
<div id="320c191c-e0f6-40bb-a282-3758be1cb38a" class="cell" data-execution_count="112">
<div class="sourceCode cell-code" id="cb539"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>np.hstack([a,b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  0, -1, -2, -3, -4, -5])</code></pre>
</div>
</div>
<div id="15b88e20-0188-4497-869f-6d4e8906fb4b" class="cell" data-execution_count="113">
<div class="sourceCode cell-code" id="cb541"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  0, -1, -2, -3, -4, -5])</code></pre>
</div>
</div>
</section>
<section id="f.-append" class="level2">
<h2 class="anchored" data-anchor-id="f.-append">F. append</h2>
<p><code>-</code> 기능1: reshape(-1) + concat</p>
<div id="0cca1203-f72b-4da7-bbf8-e68ffc51725e" class="cell" data-execution_count="114">
<div class="sourceCode cell-code" id="cb543"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">30</span>).reshape(<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span> <span class="op">-</span>np.arange(<span class="dv">8</span>).reshape(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="9fd40753-9a17-470f-ad65-16bb97d2e886" class="cell" data-execution_count="115">
<div class="sourceCode cell-code" id="cb544"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="115">
<pre><code>((5, 6), (2, 2, 2))</code></pre>
</div>
</div>
<div id="299f2b31-0aab-4c31-8e2b-04f076387dbd" class="cell" data-execution_count="116">
<div class="sourceCode cell-code" id="cb546"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>np.append(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,  0, -1, -2, -3,
       -4, -5, -6, -7])</code></pre>
</div>
</div>
<div id="c6f07e83-20ea-4a42-be6d-c49d14e9b3f8" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb548"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a.reshape(<span class="op">-</span><span class="dv">1</span>),b.reshape(<span class="op">-</span><span class="dv">1</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,  0, -1, -2, -3,
       -4, -5, -6, -7])</code></pre>
</div>
</div>
<p><code>-</code> 기능2: concat</p>
<div id="83b6481a-9821-4b08-ba18-8e15c0eeb97f" class="cell" data-execution_count="118">
<div class="sourceCode cell-code" id="cb550"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb550-1"><a href="#cb550-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb550-2"><a href="#cb550-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="812740e0-bae8-497b-9fcc-81631b97cb9d" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a>a.shape,b.shape, np.append(a,b,axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>((2, 3, 4), (2, 3, 4), (4, 3, 4))</code></pre>
</div>
</div>
<div id="685df7a2-35e7-4cd9-9493-8b1fa2d84da0" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb553"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a>a.shape,b.shape, np.append(a,b,axis<span class="op">=</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 6, 4))</code></pre>
</div>
</div>
<div id="4828e8c2-a64f-4ea7-b2de-b95816f7789e" class="cell" data-execution_count="121">
<div class="sourceCode cell-code" id="cb555"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a>a.shape,b.shape, np.append(a,b,axis<span class="op">=</span><span class="dv">2</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 3, 8))</code></pre>
</div>
</div>
<p><code>-</code> concat과의 차이?</p>
<div id="dc5a6e8e-1278-421c-98d9-fddf3fb37d7e" class="cell" data-execution_count="122">
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>c<span class="op">=</span><span class="dv">2</span><span class="op">*</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="037b1ab2-3ed8-4fef-9ce8-fd8f091ae0d7" class="cell" data-execution_count="123">
<div class="sourceCode cell-code" id="cb558"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb558-1"><a href="#cb558-1" aria-hidden="true" tabindex="-1"></a>np.append(a,b,c,axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: _append_dispatcher() got multiple values for argument 'axis'</code></pre>
</div>
</div>
<div id="e6e24e3c-f501-429c-811b-c33cc45b341e" class="cell" data-execution_count="124">
<div class="sourceCode cell-code" id="cb560"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb560-1"><a href="#cb560-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b,c],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>array([[[  0,   1,   2,   3],
        [  4,   5,   6,   7],
        [  8,   9,  10,  11]],

       [[ 12,  13,  14,  15],
        [ 16,  17,  18,  19],
        [ 20,  21,  22,  23]],

       [[  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]],

       [[  0,   2,   4,   6],
        [  8,  10,  12,  14],
        [ 16,  18,  20,  22]],

       [[ 24,  26,  28,  30],
        [ 32,  34,  36,  38],
        [ 40,  42,  44,  46]]])</code></pre>
</div>
</div>
</section>
<section id="g.-ravel-flatten" class="level2">
<h2 class="anchored" data-anchor-id="g.-ravel-flatten">G. ravel, flatten</h2>
<div id="f06ae1a8-a2df-4210-9166-dc87ce4c3c40" class="cell" data-execution_count="125">
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb562-2"><a href="#cb562-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]],

       [[12, 13, 14, 15],
        [16, 17, 18, 19],
        [20, 21, 22, 23]]])</code></pre>
</div>
</div>
<div id="7046be51-d32a-4452-9a79-0626b08b909f" class="cell" data-execution_count="126">
<div class="sourceCode cell-code" id="cb564"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb564-1"><a href="#cb564-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
<div id="a6ad2976-dde8-45ab-9706-27bc3fd45fba" class="cell" data-execution_count="127">
<div class="sourceCode cell-code" id="cb566"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb566-1"><a href="#cb566-1" aria-hidden="true" tabindex="-1"></a>a.ravel()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
<div id="c2b01290-57d0-46df-870f-60159cfee9ab" class="cell" data-execution_count="128">
<div class="sourceCode cell-code" id="cb568"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a>a.flatten()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
</section>
<section id="h.-기타-통계함수들" class="level2">
<h2 class="anchored" data-anchor-id="h.-기타-통계함수들">H. 기타 통계함수들</h2>
<p><code>-</code> 평균, 중앙값, 표준편차, 분산</p>
<div id="47fc7252-7169-4b23-8d8c-d196928c482c" class="cell" data-execution_count="129">
<div class="sourceCode cell-code" id="cb570"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">0</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span>(<span class="dv">100</span>,))</span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>array([-1.12093037,  2.03228998,  0.97607763, -1.95129947, -1.49794935,
       -2.69582142,  6.26294142,  0.17772869,  0.88248101, -0.0987605 ,
       -2.20172938,  1.57977467, -3.70228648,  3.62666243,  0.35655652,
        2.24552797,  1.82730641, -0.27324478,  2.96368325,  2.36722536,
        1.00283717,  2.25966997,  0.74019075,  1.19192351,  2.70918979,
        1.56791667, -3.9192988 ,  0.51262046,  2.1701658 ,  1.45665188,
       -0.95216879, -0.78855745, -2.01741917, -0.93273601, -1.01042306,
       -0.03667253,  0.4746618 , -2.55669289,  1.10739444,  1.15177071,
       -2.96111607, -1.97698346, -1.62882279, -0.73025042, -4.41933873,
        2.67699686, -1.49483629,  0.00726669, -0.91481464, -3.34965693,
       -1.53808928,  0.45192716,  0.62408358,  4.00499954, -0.44609797,
       -2.58265527, -3.66717305,  2.10773738, -0.51106569,  2.29246892,
        2.79998629, -3.03791044,  1.89561133,  0.19501627,  0.72806721,
       -1.50778943,  0.42474352,  0.12223567, -1.04890662, -1.9739829 ,
       -1.4261672 , -0.20406325, -0.23939128,  1.41477338, -2.25923024,
        1.17742253, -2.00670917,  0.1468111 , -0.57698109,  3.52781535,
        1.71060134,  2.31381344, -1.06125884, -1.73359866,  0.21638374,
        0.92504343,  2.50727404,  1.3510571 ,  0.62009821, -1.77908053,
        1.85646061,  0.66264999, -1.64292395, -0.60274377, -1.1585586 ,
       -0.66907802,  2.38660429,  1.41138093, -2.3059048 , -0.53353575])</code></pre>
</div>
</div>
<div id="01ff0421-39bd-4b69-b5b6-85c49fcb15e9" class="cell" data-execution_count="130">
<div class="sourceCode cell-code" id="cb572"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a>np.mean(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>0.04457872598775192</code></pre>
</div>
</div>
<div id="21b14660-7e6a-4833-a45e-ec3107a88f8b" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a>np.median(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>0.13452338307274175</code></pre>
</div>
</div>
<div id="3efbeff6-c4b1-4964-acfc-c692cbdb60ed" class="cell" data-execution_count="132">
<div class="sourceCode cell-code" id="cb576"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a>np.std(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>1.957280879505603</code></pre>
</div>
</div>
<div id="eb6cbef2-dc9b-4408-8908-796d6be14d7e" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb578"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb578-1"><a href="#cb578-1" aria-hidden="true" tabindex="-1"></a>np.var(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>3.8309484412782266</code></pre>
</div>
</div>
<p><code>-</code> corr matrix, cov matrix</p>
<div id="0b546dc7-7589-4196-a6ae-28ff628490fd" class="cell" data-execution_count="134">
<div class="sourceCode cell-code" id="cb580"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb580-1"><a href="#cb580-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>) </span>
<span id="cb580-2"><a href="#cb580-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> np.random.randn(<span class="dv">10000</span>)</span>
<span id="cb580-3"><a href="#cb580-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> np.random.randn(<span class="dv">10000</span>)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb580-4"><a href="#cb580-4" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span> np.random.randn(<span class="dv">10000</span>)<span class="op">*</span><span class="fl">0.5</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="dd6f8d17-3ee0-41d4-9641-3ac038db2e64" class="cell" data-execution_count="135">
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>np.corrcoef([x,y,z]).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>array([[ 1.  , -0.01,  0.01],
       [-0.01,  1.  ,  0.  ],
       [ 0.01,  0.  ,  1.  ]])</code></pre>
</div>
</div>
<div id="859002d8-6699-44e7-9518-3e75438d7030" class="cell" data-execution_count="136">
<div class="sourceCode cell-code" id="cb583"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a>np.cov([x,y,z]).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="136">
<pre><code>array([[ 0.99, -0.02,  0.  ],
       [-0.02,  4.06,  0.  ],
       [ 0.  ,  0.  ,  0.25]])</code></pre>
</div>
</div>
</section>
<section id="i.-dtype" class="level2">
<h2 class="anchored" data-anchor-id="i.-dtype">I. dtype</h2>
<p><code>-</code> np.array는 항상 dtype이 있다.</p>
<div id="f5274533-29a9-4bb7-a6f2-02c50cd1f71a" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb585"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb585-1"><a href="#cb585-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb585-2"><a href="#cb585-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="b58cb3fb-2c8e-4ae9-9e67-3e7d7911da3e" class="cell" data-execution_count="138">
<div class="sourceCode cell-code" id="cb587"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb587-1"><a href="#cb587-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<div id="d47ee275-7695-4603-b6a2-35d1e014d0cb" class="cell" data-execution_count="139">
<div class="sourceCode cell-code" id="cb589"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="fl">3.0</span>])</span>
<span id="cb589-2"><a href="#cb589-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="139">
<pre><code>array([1., 2., 3.])</code></pre>
</div>
</div>
<div id="db2e3280-7bd0-41da-8ae3-0f73639bef89" class="cell" data-execution_count="140">
<div class="sourceCode cell-code" id="cb591"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb591-1"><a href="#cb591-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>dtype('float64')</code></pre>
</div>
</div>
<p><code>-</code> 같은 int라도 int16,int32,int64으로 나누어진다.</p>
<div id="edf57c07-bfff-4c88-8a91-c0bb27f60d65" class="cell" data-execution_count="141">
<div class="sourceCode cell-code" id="cb593"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb593-1"><a href="#cb593-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],dtype<span class="op">=</span>np.int32)</span>
<span id="cb593-2"><a href="#cb593-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>array([1, 2, 3], dtype=int32)</code></pre>
</div>
</div>
<div id="7093b87c-703e-49f7-ab16-f76e58e1c8af" class="cell" data-execution_count="142">
<div class="sourceCode cell-code" id="cb595"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb595-1"><a href="#cb595-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>dtype('int32')</code></pre>
</div>
</div>
<p><code>-</code> float도 float16, float32, float64가 있다.</p>
<div id="1456a6cb-912e-4ece-962f-0290a8b49041" class="cell" data-execution_count="143">
<div class="sourceCode cell-code" id="cb597"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb597-1"><a href="#cb597-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],dtype<span class="op">=</span>np.float32)</span>
<span id="cb597-2"><a href="#cb597-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<pre><code>array([1., 2., 3.], dtype=float32)</code></pre>
</div>
</div>
<p><code>-</code> 데이터타입은 아래와 같은 방법으로 변환시킬 수 있다.</p>
<div id="7172c81a-c60e-4c99-a9d4-b59c3d8f9c8f" class="cell" data-execution_count="144">
<div class="sourceCode cell-code" id="cb599"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb599-1"><a href="#cb599-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],dtype<span class="op">=</span>np.int32)</span>
<span id="cb599-2"><a href="#cb599-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>array([1, 2, 3], dtype=int32)</code></pre>
</div>
</div>
<div id="d7f79c75-eb02-4e83-8b02-cbceccac211c" class="cell" data-execution_count="145">
<div class="sourceCode cell-code" id="cb601"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb601-1"><a href="#cb601-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>a.astype(dtype<span class="op">=</span>np.int64)</span>
<span id="cb601-2"><a href="#cb601-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="145">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="77c2ebac-0369-42ac-ba67-5e1c1de561d1" class="cell" data-execution_count="146">
<div class="sourceCode cell-code" id="cb603"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb603-1"><a href="#cb603-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="146">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<p><code>-</code> 문자열의 경우</p>
<div id="5f60773b-5d4e-490b-8eb4-25050db52d5d" class="cell" data-execution_count="147">
<div class="sourceCode cell-code" id="cb605"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb605-1"><a href="#cb605-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb605-2"><a href="#cb605-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="147">
<pre><code>array(['a', 'b', 'c'], dtype='&lt;U1')</code></pre>
</div>
</div>
<div id="1a15cf7a-1406-4710-8917-513b473c4664" class="cell" data-execution_count="148">
<div class="sourceCode cell-code" id="cb607"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb607-1"><a href="#cb607-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'ab'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb607-2"><a href="#cb607-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>array(['ab', 'b', 'c'], dtype='&lt;U2')</code></pre>
</div>
</div>
<div id="bc2b3979-3f16-470d-a23c-58374065d4f3" class="cell" data-execution_count="149">
<div class="sourceCode cell-code" id="cb609"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb609-1"><a href="#cb609-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'abasdf'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb609-2"><a href="#cb609-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>array(['abasdf', 'b', 'c'], dtype='&lt;U6')</code></pre>
</div>
</div>
<p><code>-</code> 문자열+숫자혼합 =&gt; 문자열로 통일</p>
<div id="b9bd86ae-9a79-4421-b7a7-ec6278b9b2f6" class="cell" data-execution_count="150">
<div class="sourceCode cell-code" id="cb611"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb611-1"><a href="#cb611-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([<span class="st">'a'</span>,<span class="dv">1</span>])</span>
<span id="cb611-2"><a href="#cb611-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="150">
<pre><code>array(['a', '1'], dtype='&lt;U21')</code></pre>
</div>
</div>
<div id="95d83a7d-e537-4342-86ff-5148ec858697" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb613"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb613-1"><a href="#cb613-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([<span class="st">'a'</span>,<span class="fl">1.0</span>])</span>
<span id="cb613-2"><a href="#cb613-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<pre><code>array(['a', '1.0'], dtype='&lt;U32')</code></pre>
</div>
</div>
<p><code>-</code> 숫자를 문자열로 전환</p>
<div id="d58f4555-4bc0-4745-8802-f2098db6e47d" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb615"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb615-1"><a href="#cb615-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb615-2"><a href="#cb615-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="bd079093-0f2d-4a93-b0a5-af8259386ad8" class="cell" data-execution_count="153">
<div class="sourceCode cell-code" id="cb617"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb617-1"><a href="#cb617-1" aria-hidden="true" tabindex="-1"></a>a.astype(np.str_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>array(['1', '2', '3'], dtype='&lt;U21')</code></pre>
</div>
</div>
</section>
<section id="j.-브로드캐스팅과-시간측정" class="level2">
<h2 class="anchored" data-anchor-id="j.-브로드캐스팅과-시간측정">J. 브로드캐스팅과 시간측정</h2>
<p>(예비학습)</p>
<div id="78f52f3c-1a26-4342-8d67-89b1ad9aa211" class="cell" data-execution_count="154">
<div class="sourceCode cell-code" id="cb619"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb619-1"><a href="#cb619-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2ea51ad5-d6f5-4de7-aacb-1e8345dd2e83" class="cell" data-execution_count="155">
<div class="sourceCode cell-code" id="cb620"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb620-1"><a href="#cb620-1" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>time.time()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4c31830f-2fc8-4f84-bb3d-a4cb8c89183a" class="cell" data-execution_count="156">
<div class="sourceCode cell-code" id="cb621"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span>time.time()</span>
<span id="cb621-2"><a href="#cb621-2" aria-hidden="true" tabindex="-1"></a>t2<span class="op">-</span>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>0.21341419219970703</code></pre>
</div>
</div>
<p>예비학습끝</p>
<p><strong>(예제)</strong> x=[0,1,2,3,4] 인 벡터가 있다고 하자. (i,j)의 원소가 <code>(x[i]-x[j])**2</code> 을 의미하는 <span class="math inline">\(5\times 5\)</span> 매트릭스를 구하라.</p>
<p>(풀이1)</p>
<div id="1b5817f1-7827-4cfd-aa43-bc6fb34804f9" class="cell" data-execution_count="157">
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">5</span>))</span>
<span id="cb623-2"><a href="#cb623-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<pre><code>array([0, 1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="0d4b39e7-fefd-497c-9f8c-71d85a0e0e68" class="cell" data-execution_count="158">
<div class="sourceCode cell-code" id="cb625"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> np.zeros([<span class="dv">5</span>,<span class="dv">5</span>])</span>
<span id="cb625-2"><a href="#cb625-2" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])</code></pre>
</div>
</div>
<div id="91561009-635a-4c3d-9085-8f9ec90d47c7" class="cell" data-execution_count="159">
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb627-2"><a href="#cb627-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb627-3"><a href="#cb627-3" aria-hidden="true" tabindex="-1"></a>        dist[i,j]<span class="op">=</span>(x[i]<span class="op">-</span>x[j])<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="40727b2c-da28-4560-8d4d-7972a42445d8" class="cell" data-execution_count="160">
<div class="sourceCode cell-code" id="cb628"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb628-1"><a href="#cb628-1" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>array([[ 0.,  1.,  4.,  9., 16.],
       [ 1.,  0.,  1.,  4.,  9.],
       [ 4.,  1.,  0.,  1.,  4.],
       [ 9.,  4.,  1.,  0.,  1.],
       [16.,  9.,  4.,  1.,  0.]])</code></pre>
</div>
</div>
<p>(풀이2)</p>
<div id="9dd01eae-97b7-462f-aae0-c491401985ee" class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb630"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb630-1"><a href="#cb630-1" aria-hidden="true" tabindex="-1"></a>x1<span class="op">=</span>x.reshape(<span class="dv">5</span>,<span class="dv">1</span>).astype(dtype<span class="op">=</span>np.float64)</span>
<span id="cb630-2"><a href="#cb630-2" aria-hidden="true" tabindex="-1"></a>x2<span class="op">=</span>x.reshape(<span class="dv">1</span>,<span class="dv">5</span>).astype(dtype<span class="op">=</span>np.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="69306525-06fd-47d1-811d-2b14aeb28add" class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb631"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a>x1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="175">
<pre><code>array([[0.],
       [1.],
       [2.],
       [3.],
       [4.]])</code></pre>
</div>
</div>
<div id="54a80b6e-707d-45c1-8186-75f1d23d527d" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb633"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<pre><code>array([[0., 1., 2., 3., 4.]])</code></pre>
</div>
</div>
<div id="99324d23-62fb-40af-8601-d50166f109e4" class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb635"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a>x1<span class="op">-</span>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="177">
<pre><code>array([[ 0., -1., -2., -3., -4.],
       [ 1.,  0., -1., -2., -3.],
       [ 2.,  1.,  0., -1., -2.],
       [ 3.,  2.,  1.,  0., -1.],
       [ 4.,  3.,  2.,  1.,  0.]])</code></pre>
</div>
</div>
<ul>
<li>(i,j)th element = x[i]-x[j]</li>
</ul>
<div id="5cec706f-76bc-4dbf-958a-81649e0ef354" class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb637"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a>(x1<span class="op">-</span>x2)<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="178">
<pre><code>array([[ 0.,  1.,  4.,  9., 16.],
       [ 1.,  0.,  1.,  4.,  9.],
       [ 4.,  1.,  0.,  1.,  4.],
       [ 9.,  4.,  1.,  0.,  1.],
       [16.,  9.,  4.,  1.,  0.]])</code></pre>
</div>
</div>
<hr>
<div id="adf11118-a68b-448f-86de-88ce15504d1c" class="cell" data-execution_count="210">
<div class="sourceCode cell-code" id="cb639"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">10000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d14254c6-2d8e-446e-93f2-be3618b2eef7" class="cell" data-execution_count="211">
<div class="sourceCode cell-code" id="cb640"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb640-1"><a href="#cb640-1" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> np.zeros([<span class="dv">10000</span>,<span class="dv">10000</span>])</span>
<span id="cb640-2"><a href="#cb640-2" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="211">
<pre><code>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]])</code></pre>
</div>
</div>
<div id="e3851305-f7ab-467e-854e-05ea2f08c999" class="cell" data-execution_count="212">
<div class="sourceCode cell-code" id="cb642"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb642-1"><a href="#cb642-1" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>time.time()</span>
<span id="cb642-2"><a href="#cb642-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb642-3"><a href="#cb642-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb642-4"><a href="#cb642-4" aria-hidden="true" tabindex="-1"></a>        dist[i,j]<span class="op">=</span>(y[i]<span class="op">-</span>y[j])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb642-5"><a href="#cb642-5" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span>time.time()</span>
<span id="cb642-6"><a href="#cb642-6" aria-hidden="true" tabindex="-1"></a>t2<span class="op">-</span>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="212">
<pre><code>37.53360199928284</code></pre>
</div>
</div>
<div id="80aa5e9f-588e-44e3-b79e-dcc648b12c0b" class="cell" data-execution_count="213">
<div class="sourceCode cell-code" id="cb644"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb644-1"><a href="#cb644-1" aria-hidden="true" tabindex="-1"></a>y1<span class="op">=</span>y.reshape(<span class="dv">10000</span>,<span class="dv">1</span>).astype(np.float64)</span>
<span id="cb644-2"><a href="#cb644-2" aria-hidden="true" tabindex="-1"></a>y2<span class="op">=</span>y.reshape(<span class="dv">1</span>,<span class="dv">10000</span>).astype(np.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="65b4583c-d45f-4dbd-b5aa-ea5c567d2ee3" class="cell" data-execution_count="217">
<div class="sourceCode cell-code" id="cb645"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>time.time()</span>
<span id="cb645-2"><a href="#cb645-2" aria-hidden="true" tabindex="-1"></a>dist2<span class="op">=</span>(y1<span class="op">-</span>y2)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb645-3"><a href="#cb645-3" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span>time.time()</span>
<span id="cb645-4"><a href="#cb645-4" aria-hidden="true" tabindex="-1"></a>t2<span class="op">-</span>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="217">
<pre><code>0.1297893524169922</code></pre>
</div>
</div>
<div id="b9d31a15-85a3-456c-942a-9f3113124c6b" class="cell" data-execution_count="218">
<div class="sourceCode cell-code" id="cb647"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true" tabindex="-1"></a>(dist<span class="op">-</span>dist2).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="218">
<pre><code>0.0</code></pre>
</div>
</div>
</section>
</section>
<section id="numpy의-활용" class="level1">
<h1>7. <code>numpy</code>의 활용</h1>
<section id="a.-예비학습-이미지자료의-이해" class="level2">
<h2 class="anchored" data-anchor-id="a.-예비학습-이미지자료의-이해">A. 예비학습: 이미지자료의 이해</h2>
<p><code>-</code> <code>plt.imshow(...)</code> 에서 <code>...</code>이 shape이 (??,??)이면 흑백이미지를 출력</p>
<div id="27a59ec1-5a11-4bcc-b911-c28dbc328765" class="cell" data-outputid="bbd382b0-2e79-4d17-d8f4-dfc557660cba" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb649"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a>plt.imshow([[<span class="dv">0</span>,<span class="dv">255</span>],[<span class="dv">0</span>,<span class="dv">255</span>]],cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-344-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> <code>plt.imshow(...)</code> 에서 <code>...</code>의 shape이 (??,??,3)이면 칼라이미지를 출력</p>
<div id="79e88a7e-f1c6-42cc-b986-6b66b175d26f" class="cell" data-outputid="e0d82acc-b717-4dff-87cb-2f4af6e32e49" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb650"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">255</span>],[<span class="dv">0</span>,<span class="dv">255</span>]]</span>
<span id="cb650-2"><a href="#cb650-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> [[<span class="dv">255</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb650-3"><a href="#cb650-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">255</span>,<span class="dv">0</span>]]</span>
<span id="cb650-4"><a href="#cb650-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.stack([r,g,b],axis<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-345-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> <code>plt.imshow(...)</code> 에서 <code>...</code>의 자료형이 int인지 float인지에 따라서 인식이 다름</p>
<div id="9d39cc11-f355-4d44-98f9-e2cc8121f031" class="cell" data-outputid="bb4c79a8-552a-4eb1-c80e-50bc067e39d7" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb651"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>]]</span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> [[<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb651-3"><a href="#cb651-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">1</span>,<span class="dv">0</span>]]</span>
<span id="cb651-4"><a href="#cb651-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.stack([r,g,b],axis<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-346-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7eb63bf3-fe42-40cb-a9e7-fcb8ca0c426f" class="cell" data-outputid="c57c632f-2176-415d-9fb2-ddb46e157848" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb652"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [[<span class="dv">0</span>,<span class="fl">1.0</span>],[<span class="dv">0</span>,<span class="fl">1.0</span>]]</span>
<span id="cb652-2"><a href="#cb652-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> [[<span class="fl">1.0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb652-3"><a href="#cb652-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="fl">1.0</span>,<span class="dv">0</span>]]</span>
<span id="cb652-4"><a href="#cb652-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.stack([r,g,b],axis<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-347-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="b.-이미지-자료처리" class="level2">
<h2 class="anchored" data-anchor-id="b.-이미지-자료처리">B. 이미지 자료처리</h2>
<div id="1d497c0b-9c12-42a6-b65c-ea9a865e8e3e" class="cell" data-execution_count="194">
<div class="sourceCode cell-code" id="cb653"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> PIL </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3c776016-797d-4f2e-befc-982cffd06d0f" class="cell" data-execution_count="198">
<div class="sourceCode cell-code" id="cb654"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>guebin<span class="op">/</span>SC2022<span class="op">/</span>main<span class="op">/</span>hani.jpeg</span>
<span id="cb654-2"><a href="#cb654-2" aria-hidden="true" tabindex="-1"></a>hani <span class="op">=</span> np.einsum(<span class="st">'ijk-&gt;jik'</span>,np.array(PIL.Image.<span class="bu">open</span>(<span class="st">'hani.jpeg'</span>),dtype<span class="op">=</span>np.int64)<span class="op">/</span><span class="dv">255</span>)</span>
<span id="cb654-3"><a href="#cb654-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>rm hani.jpeg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li><p>note: 위 코드는 코랩 혹은 리눅스기반 환경에서 동작가능.</p></li>
<li><p>주피터노트북의 경우 아래의 절차를 따를 것</p>
<ol type="1">
<li><a href="https://raw.githubusercontent.com/guebin/SC2022/main/hani.jpeg" class="uri">https://raw.githubusercontent.com/guebin/SC2022/main/hani.jpeg</a> 에서 직접사진을 다운로드</li>
<li>현재작업중인 주피터노트북과 같은폴더에 그림파일을 옮김</li>
<li><code>hani = np.einsum('ijk-&gt;jik',np.array(PIL.Image.open('hani.jpeg'),dtype=np.int64)/255)</code> 실행 // 그전에 import PIL 을 해야함</li>
<li>그림파일 삭제</li>
</ol></li>
</ul>
<p>불러온 이미지는 아래와 같다.</p>
<div id="9210c0d7-2e9b-43d7-8ab3-1e007b8432e9" class="cell" data-execution_count="202">
<div class="sourceCode cell-code" id="cb655"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a>hani,hani.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="202">
<pre><code>(array([[[0.44705882, 0.48627451, 0.49411765],
         [0.43137255, 0.46666667, 0.48627451],
         [0.45882353, 0.50196078, 0.51764706],
         ...,
         [0.6627451 , 0.6627451 , 0.70196078],
         [0.63529412, 0.62745098, 0.67058824],
         [0.64313725, 0.63529412, 0.67843137]],
 
        [[0.45882353, 0.49803922, 0.50588235],
         [0.44313725, 0.47843137, 0.49803922],
         [0.4627451 , 0.50588235, 0.52156863],
         ...,
         [0.63921569, 0.63921569, 0.67843137],
         [0.64313725, 0.63529412, 0.67843137],
         [0.63137255, 0.62352941, 0.66666667]],
 
        [[0.45490196, 0.49411765, 0.50196078],
         [0.4627451 , 0.49803922, 0.51764706],
         [0.45882353, 0.50196078, 0.51764706],
         ...,
         [0.64313725, 0.64313725, 0.68235294],
         [0.65490196, 0.65490196, 0.69411765],
         [0.64705882, 0.63921569, 0.68235294]],
 
        ...,
 
        [[0.69411765, 0.69803922, 0.70588235],
         [0.68627451, 0.69019608, 0.69803922],
         [0.69411765, 0.69803922, 0.70588235],
         ...,
         [0.60784314, 0.6       , 0.60392157],
         [0.6       , 0.59215686, 0.59607843],
         [0.59607843, 0.58823529, 0.59215686]],
 
        [[0.70196078, 0.70588235, 0.71372549],
         [0.72156863, 0.7254902 , 0.73333333],
         [0.69019608, 0.69411765, 0.70196078],
         ...,
         [0.61176471, 0.60392157, 0.60784314],
         [0.60392157, 0.59607843, 0.6       ],
         [0.61568627, 0.60784314, 0.61176471]],
 
        [[0.7254902 , 0.72941176, 0.74509804],
         [0.73333333, 0.7372549 , 0.74509804],
         [0.70980392, 0.71372549, 0.72156863],
         ...,
         [0.61176471, 0.60392157, 0.60784314],
         [0.60392157, 0.59607843, 0.6       ],
         [0.61960784, 0.61176471, 0.61568627]]]),
 (4032, 3024, 3))</code></pre>
</div>
</div>
<ul>
<li>이미지는 4032 <span class="math inline">\(\times\)</span> 3024 개의 격자(픽셀)로 이루어져 있음</li>
</ul>
<p>이미지를 보는 방법은 아래와 같다.</p>
<div id="bde7f799-d7e1-47c9-a4c1-92acd5cb3c19" class="cell" data-execution_count="203">
<div class="sourceCode cell-code" id="cb657"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb657-1"><a href="#cb657-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(hani) <span class="co"># 모든이미지, 하니매트릭스</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-351-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="1496a4ec-020d-4dfe-94c8-7c7eb17fe1e4" class="cell" data-execution_count="204">
<div class="sourceCode cell-code" id="cb658"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(hani[<span class="dv">1000</span>:<span class="dv">1500</span>, <span class="dv">1000</span>:<span class="dv">2000</span>,:]) <span class="co"># 얼굴만 확대, 하니의 서브매트릭스 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-352-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>3</code>. 하니이미지를 나타내는 어레이를 변형하여 빨간색을 의미하는 칼라만 남겨서 “빨간하니”를 만들고 이미지를 출력하라.</p>
<p>(풀이)</p>
<div id="3d0b5683-0886-4fad-b7f1-8b495703a1a6" class="cell" data-execution_count="215">
<div class="sourceCode cell-code" id="cb659"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true" tabindex="-1"></a>red_hani <span class="op">=</span> hani<span class="op">*</span><span class="dv">0</span> </span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true" tabindex="-1"></a>red_hani[:,:,<span class="dv">0</span>] <span class="op">=</span> hani[:,:,<span class="dv">0</span>]</span>
<span id="cb659-3"><a href="#cb659-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(red_hani)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-353-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>4</code>. 하니의 모든 값에 루트를 취하여 “루트하니”를 만들고 “원본하니”와 “루트하니”를 좌우로 나란히 배치하여 출력하라.</p>
<p>(풀이)</p>
<div id="9102d773-4a0e-40ea-918e-d564ac3c500d" class="cell" data-execution_count="224">
<div class="sourceCode cell-code" id="cb660"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb660-1"><a href="#cb660-1" aria-hidden="true" tabindex="-1"></a>root_hani <span class="op">=</span> np.sqrt(hani)</span>
<span id="cb660-2"><a href="#cb660-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.concatenate([hani,root_hani],axis<span class="op">=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-354-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>“루트하니”의 이미지는 “원본하니”의 이미지와 비교하여 어떤가? 왜 그러한 결과가 나왔다고 생각하는가?</p>
<p><code>5</code>. 하니의 모든값에 아래와 같은 함수를 적용하라.</p>
<ul>
<li><span class="math inline">\(f(x)=\begin{cases} \sqrt{x} &amp; x&gt;0.7 \\ x &amp; x \leq 0.7 \end{cases}\)</span></li>
</ul>
<p>함수의 결과로 얻어진 매트릭스를 “후광하니”라고 부르자. “원본하니”와 “후광하니”를 좌우로 나란히 배치하여 출력하라.</p>
<div id="7d67b0a6-910c-4a58-9437-2b879f2992d1" class="cell" data-execution_count="235">
<div class="sourceCode cell-code" id="cb661"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb661-1"><a href="#cb661-1" aria-hidden="true" tabindex="-1"></a>shiny_hani <span class="op">=</span> np.sqrt(hani)<span class="op">*</span>(hani<span class="op">&gt;</span><span class="fl">0.7</span>)<span class="op">+</span>hani<span class="op">*</span>(hani<span class="op">&lt;=</span><span class="fl">0.7</span>)</span>
<span id="cb661-2"><a href="#cb661-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.concatenate([hani,shiny_hani],axis<span class="op">=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-355-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="c.-mnist-data" class="level2">
<h2 class="anchored" data-anchor-id="c.-mnist-data">C. MNIST data</h2>
<p>아래는 0~9가지의 숫자이미지가 저장된 이미지데이터를 불러오는 코드이다.</p>
<div id="b50188c7-e71b-48bf-b808-1f354094a304" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb662"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb662-1"><a href="#cb662-1" aria-hidden="true" tabindex="-1"></a><span class="co"># URL 설정</span></span>
<span id="cb662-2"><a href="#cb662-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://github.com/guebin/PP2023/raw/main/posts/02_PY4DS/mnist.npz'</span></span>
<span id="cb662-3"><a href="#cb662-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-4"><a href="#cb662-4" aria-hidden="true" tabindex="-1"></a><span class="co"># URL에서 파일 다운로드</span></span>
<span id="cb662-5"><a href="#cb662-5" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(url, <span class="st">'./mnist.npz'</span>)</span>
<span id="cb662-6"><a href="#cb662-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb662-7"><a href="#cb662-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 로드</span></span>
<span id="cb662-8"><a href="#cb662-8" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.load(<span class="st">'./mnist.npz'</span>)</span>
<span id="cb662-9"><a href="#cb662-9" aria-hidden="true" tabindex="-1"></a>xtrain, ytrain, xtest, ytest <span class="op">=</span> data[<span class="st">'x_train'</span>], data[<span class="st">'y_train'</span>], data[<span class="st">'x_test'</span>], data[<span class="st">'y_test'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>아래는 데이터에 대한 설명이다.</p>
<ul>
<li>전체의 이미지의 수는 70000개이며, 60000개의 이미지 <span class="math inline">\({\tt xtrain}\)</span>에 10000개의 이미지는 <span class="math inline">\({\tt xtest}\)</span>에 저장되어 있다.</li>
<li>이미지에 대한 라벨은 각각 <span class="math inline">\({\tt ytrain}\)</span>과 <span class="math inline">\(\tt ytest\)</span>에 저장되어 있다. 따라서 <span class="math inline">\(\tt ytrain\)</span>에는 60000개의 이미지에 해당하는 라벨이, <span class="math inline">\(\tt ytest\)</span>에는 10000개의 이미지에 해당하는 라벨이 기록되어 있다.</li>
<li>보통 분석에서는 60000개의 이미지를 가지고 라벨을 맞추는 “훈련”을 하고 (<span class="math inline">\({\tt xtrain}\)</span>을 이용하여 <span class="math inline">\({\tt ytrain}\)</span>을 맞추는 방법을 학습하고), 그러한 훈련이 잘 되었는지 10000개의 이미지를 이용하여 “테스트”한다.</li>
<li>위와 같은 의미로 <span class="math inline">\(({\tt xtrain}, {\tt ytrain})\)</span> 을 training data set, <span class="math inline">\(({\tt xtest},{\tt ytest})\)</span> 를 test data set 이라고 부른다. (ref: <a href="https://en.wikipedia.org/wiki/Training,_validation,_and_test_data_sets">위키참고</a>)</li>
</ul>
<p>아래는 이미지자료와 시각화에 대한 설명이다.</p>
<ul>
<li>각 이미지는 (28,28) 픽셀의 흑백이미지이다. 따라서 각 이미지는 (28,28,3) 이 아니라 (28,28) 의 shape을 가진 텐서로 구성되어있다.</li>
<li>흑백이미지를 시각화 하기 위해서는 <code>plt.imshow(img, cmap='gray')</code>를 이용한다. 여기에서 <span class="math inline">\({\tt img}\)</span>은 임의의 2차원 텐서이며 이 예제의 경우 (28,28)의 shape을 가진다.</li>
</ul>
<p>아래는 <span class="math inline">\({\tt xtrain}\)</span>의 두번째 이미지, 즉 <span class="math inline">\({\tt xtrain[1,:,:]}\)</span>를 확인하는 코드의 예시이다.</p>
<div id="c2c72007-fe9b-4963-b47e-6962f229985a" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb663"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb663-1"><a href="#cb663-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.imshow(xtrain[1,:,:],cmap='gray')</span></span>
<span id="cb663-2"><a href="#cb663-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>) <span class="co">## 같은코드임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-357-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>이 이미지에 대한 label은 <span class="math inline">\({\tt ytrain[1]}\)</span>의 값으로 확인가능하다.</p>
<div id="184bf392-b62e-4bce-8e85-9d60caa1e698" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb664"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a>ytrain[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>0</code></pre>
</div>
</div>
<p>이미지와 라벨을 한번에 표현하는 코드는 아래와 같이 작성가능하다.</p>
<div id="f0221448-d091-476b-84d3-c6c007bd243d" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb666"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb666-2"><a href="#cb666-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">1</span>]))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-359-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>아래는 10개의 이미지를 라벨과 함께 출력하는 코드의 예시이다.</p>
<div id="becc70c5-57bd-43b7-8b91-7e3c1df65d94" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb667"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb667-1"><a href="#cb667-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb667-2"><a href="#cb667-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-3"><a href="#cb667-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].imshow(xtrain[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">0</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">0</span>]))<span class="op">;</span></span>
<span id="cb667-4"><a href="#cb667-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].imshow(xtrain[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">1</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb667-5"><a href="#cb667-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">2</span>].imshow(xtrain[<span class="dv">2</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">2</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">2</span>]))<span class="op">;</span></span>
<span id="cb667-6"><a href="#cb667-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">3</span>].imshow(xtrain[<span class="dv">3</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">3</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">3</span>]))<span class="op">;</span></span>
<span id="cb667-7"><a href="#cb667-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">4</span>].imshow(xtrain[<span class="dv">4</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">4</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">4</span>]))<span class="op">;</span></span>
<span id="cb667-8"><a href="#cb667-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-9"><a href="#cb667-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].imshow(xtrain[<span class="dv">5</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">0</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">5</span>]))<span class="op">;</span></span>
<span id="cb667-10"><a href="#cb667-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].imshow(xtrain[<span class="dv">6</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">1</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">6</span>]))<span class="op">;</span></span>
<span id="cb667-11"><a href="#cb667-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">2</span>].imshow(xtrain[<span class="dv">7</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">2</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">7</span>]))<span class="op">;</span></span>
<span id="cb667-12"><a href="#cb667-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">3</span>].imshow(xtrain[<span class="dv">8</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">3</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">8</span>]))<span class="op">;</span></span>
<span id="cb667-13"><a href="#cb667-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">4</span>].imshow(xtrain[<span class="dv">9</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">4</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">9</span>]))<span class="op">;</span></span>
<span id="cb667-14"><a href="#cb667-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb667-15"><a href="#cb667-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-360-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(1)</code> 70000개의 이미지중 0~9에 해당하는 이미지는 각각 몇장씩 들어있는가?</p>
<p>(풀이)</p>
<div id="811a2318-a9b0-44a9-8c8e-7311593feff3" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb668"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a>_y <span class="op">=</span> ytrain.tolist()<span class="op">+</span>ytest.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="70f09b7e-1168-4cf7-8203-f9f57055c2ad" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb669"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true" tabindex="-1"></a>{s:_y.count(s) <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">set</span>(_y)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="111">
<pre><code>{0: 6903,
 1: 7877,
 2: 6990,
 3: 7141,
 4: 6824,
 5: 6313,
 6: 6876,
 7: 7293,
 8: 6825,
 9: 6958}</code></pre>
</div>
</div>
<p><code>(2)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 손글씨 0을 의미하는 이미지만을 모아서 새로운 텐서 <span class="math inline">\({\tt xtrain0}\)</span>를 만들어라. 이 텐서에서 처음과 마지막 이미지를 출력하라.</p>
<p><strong>hint:</strong> <span class="math inline">\({\tt xtrain0}\)</span> 의 shape은 (5923,28,28)이어야 한다.</p>
<p>(풀이)</p>
<div id="9d53d737-ff83-4665-a355-a30fc9c67014" class="cell" data-execution_count="117">
<div class="sourceCode cell-code" id="cb671"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a>xtrain0 <span class="op">=</span> xtrain[ytrain<span class="op">==</span><span class="dv">0</span>]</span>
<span id="cb671-2"><a href="#cb671-2" aria-hidden="true" tabindex="-1"></a>xtrain0.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="117">
<pre><code>(5923, 28, 28)</code></pre>
</div>
</div>
<div id="ef632924-ffbd-4922-b37e-e947e300d781" class="cell" data-execution_count="119">
<div class="sourceCode cell-code" id="cb673"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain0[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>) <span class="co"># 처음이미지</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-364-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6b9a93cf-f24a-4c4e-bf4c-d82af3324671" class="cell" data-execution_count="120">
<div class="sourceCode cell-code" id="cb674"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb674-1"><a href="#cb674-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain0[<span class="op">-</span><span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>) <span class="co"># 마지막이미지</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-365-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(3)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 손글씨 0을 의미하는 이미지의 평균을 계산하라. 즉 아래를 계산하라.</p>
<ul>
<li><span class="math inline">\({\tt xtrain0mean} = \frac{1}{5923}\sum_{i=1}^{5923} {\tt xtrain0[i, :, :]}\)</span></li>
</ul>
<p>계산결과를 출력하라.</p>
<p>(풀이)</p>
<div id="b666e44f-8741-49f5-9f2e-5d48bd8f928b" class="cell" data-execution_count="131">
<div class="sourceCode cell-code" id="cb675"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain0.mean(axis<span class="op">=</span><span class="dv">0</span>),cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-366-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(4)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 각 라벨에 대한 평균이미지를 계산하고 계산결과를 <span class="math inline">\({\tt imgmean}\)</span>에 길이가 10인 <code>list</code>로 저장하라. 즉 <span class="math inline">\({\tt imgmean}\)</span>은 아래와 같은 자료구조를 가지고 있어야 한다.</p>
<ul>
<li><span class="math inline">\({\tt imgmean}=\big[{\tt imgmean[0]},\dots, {\tt imgmean[9]}\big]\)</span></li>
<li><span class="math inline">\({\tt imgmean[0]}, \dots, {\tt imgmean[9]}\)</span> 는 각각 (28,28)의 shape을 가진 numpy array</li>
<li><span class="math inline">\({\tt imgmean[0]}, \dots, {\tt imgmean[9]}\)</span> 는 각각 숫자 0,1, …, 9의 평균이미지를 의미</li>
</ul>
<p><span class="math inline">\({\tt imgmean[0]},\dots, {\tt imgmean[9]}\)</span>를 시각화 하라.</p>
<p>(풀이)</p>
<div id="af25386e-2fe8-417d-b0dd-b011abf50a59" class="cell" data-execution_count="133">
<div class="sourceCode cell-code" id="cb676"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb676-1"><a href="#cb676-1" aria-hidden="true" tabindex="-1"></a>imgmean <span class="op">=</span> [xtrain[ytrain<span class="op">==</span>i].mean(axis<span class="op">=</span><span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="7f778527-df69-4845-9847-6cf1aa066e9e" class="cell" data-execution_count="137">
<div class="sourceCode cell-code" id="cb677"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-3"><a href="#cb677-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].imshow(imgmean[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-4"><a href="#cb677-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].imshow(imgmean[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-5"><a href="#cb677-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">2</span>].imshow(imgmean[<span class="dv">2</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-6"><a href="#cb677-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">3</span>].imshow(imgmean[<span class="dv">3</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-7"><a href="#cb677-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">4</span>].imshow(imgmean[<span class="dv">4</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-8"><a href="#cb677-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-9"><a href="#cb677-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].imshow(imgmean[<span class="dv">5</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-10"><a href="#cb677-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].imshow(imgmean[<span class="dv">6</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-11"><a href="#cb677-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">2</span>].imshow(imgmean[<span class="dv">7</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-12"><a href="#cb677-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">3</span>].imshow(imgmean[<span class="dv">8</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-13"><a href="#cb677-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">4</span>].imshow(imgmean[<span class="dv">9</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb677-14"><a href="#cb677-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb677-15"><a href="#cb677-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-368-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(5)</code> <span class="math inline">\({\tt xtrain}\)</span>의 두번째 이미지와 <span class="math inline">\({\tt imgmean[0]}\)</span>의 차이를 제곱한 값의 평균을 구하라. 즉 아래를 계산하라.</p>
<ul>
<li><span class="math inline">\(\frac{1}{28\times 28} \sum_{p=0}^{27}\sum_{q=0}^{27}\big({\tt xtrain[1,p,q]}-{\tt imgmean[0][p,q]}\big)^2\)</span></li>
</ul>
<p>(풀이)</p>
<div id="5d1ac198-9bc8-4c52-bad2-ebbc0013d74a" class="cell" data-execution_count="151">
<div class="sourceCode cell-code" id="cb678"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb678-1"><a href="#cb678-1" aria-hidden="true" tabindex="-1"></a>np.mean((xtrain[<span class="dv">1</span>,:,:]<span class="op">-</span> imgmean[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="151">
<pre><code>2299.9585279846365</code></pre>
</div>
</div>
<p><code>(6)</code> 모든 <span class="math inline">\(j=0,1,\dots,9\)</span> 에 대하여 아래를 계산하라.</p>
<ul>
<li><span class="math inline">\(\frac{1}{28\times 28} \sum_{p=0}^{27}\sum_{q=0}^{27}\big({\tt xtrain[1,p,q]}-{\tt imgmean[j][p,q]}\big)^2\)</span></li>
</ul>
<p>계산값이 가장 작게 나오는 <span class="math inline">\(j\)</span>는 얼마인가? 위의 계산결과를 토대로 <span class="math inline">\({\tt xtrain}\)</span>의 두번째 이미지는 어떠한 숫자를 의미한다고 “분류”하는 것이 타당한가?</p>
<div id="bd5ad8a2-44c7-4ee8-83e6-eb75a1cac8f1" class="cell" data-execution_count="152">
<div class="sourceCode cell-code" id="cb680"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb680-1"><a href="#cb680-1" aria-hidden="true" tabindex="-1"></a>[np.mean((xtrain[<span class="dv">1</span>,:,:]<span class="op">-</span> imgmean[i])<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="152">
<pre><code>[2299.9585279846365,
 7474.876421640121,
 6154.997099653264,
 5889.84882305034,
 6763.709480023399,
 4616.900123430389,
 5856.367892213506,
 6465.999476962735,
 5916.546346421647,
 6385.5252510342525]</code></pre>
</div>
</div>
<p><code>(7)</code> 아래와 같은 numpy array 를 생성하라.</p>
<p><span class="math display">\[{\tt loss}=
\begin{bmatrix}
{\tt loss[0,0]} &amp; \dots &amp; {\tt loss[0,9]} \\
{\tt loss[1,0]} &amp; \dots &amp; {\tt loss[1,9]} \\
\dots &amp; \dots &amp;  \dots \\
{\tt loss[59999,0]}&amp; \dots &amp;{\tt loss[59999,9]} \\
\end{bmatrix}\]</span></p>
<p>단, <span class="math inline">\({\tt loss[i,j]} = \frac{1}{28\times 28} \sum_{p=0}^{27}\sum_{q=0}^{27}\big({\tt xtrain[i,p,q]}-{\tt imgmean[j][p,q]}\big)^2\)</span></p>
<p>위에서 생성한 <span class="math inline">\({\tt loss}\)</span>를 이용해 (6)와 같은 방식으로 <span class="math inline">\({\tt xtrain}\)</span>의 모든 이미지에 대한 분류를 수행하라.</p>
<p><strong>hint</strong>: <span class="math inline">\({\tt loss}\)</span>에서 “최소값을 가지는 원소의 인덱스를 출력”하는 함수를 각 행별로 적용하면 된다.</p>
<p>(풀이)</p>
<div id="659f416b-7665-4312-b755-0d0b6a63730b" class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb682"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb682-1"><a href="#cb682-1" aria-hidden="true" tabindex="-1"></a>loss <span class="op">=</span> np.array([[np.mean((xtrain[j,:,:]<span class="op">-</span> imgmean[i])<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">60000</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6f9e8589-0a68-4d9f-8dc9-20560ca56d0f" class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb683"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb683-1"><a href="#cb683-1" aria-hidden="true" tabindex="-1"></a>loss.argmin(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="171">
<pre><code>array([5, 0, 4, ..., 5, 6, 8])</code></pre>
</div>
</div>
<p><code>(8)</code> <code>(7)</code>에서 수행한 분류결과와 실제 라벨 <span class="math inline">\({\tt ytrain}\)</span>을 비교하라. 얼마나 많은 결과가 일치하는지 비율을 계산하라.</p>
<p>(풀이)</p>
<div id="e67d719f-5c1f-4d21-9c94-d5090e052baf" class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb685"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb685-1"><a href="#cb685-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(ytrain <span class="op">==</span> loss.argmin(axis<span class="op">=</span><span class="dv">1</span>)) <span class="op">/</span> <span class="dv">60000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="176">
<pre><code>0.8079833333333334</code></pre>
</div>
</div>
<p><code>(9)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 학습한 평균이미지 <span class="math inline">\({\tt imgmean}\)</span>를 바탕으로 <span class="math inline">\({\tt xtest}\)</span>의 이미지를 분류하라. 분류결과를 <span class="math inline">\({\tt ytest}\)</span>와 비교하라. 얼마나 많은 결과가 일치하는지 비율을 계산하라.</p>
<p>(풀이)</p>
<div id="b1007c6d-95e8-4f36-8464-df148c6fdc20" class="cell" data-execution_count="183">
<div class="sourceCode cell-code" id="cb687"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb687-1"><a href="#cb687-1" aria-hidden="true" tabindex="-1"></a>est <span class="op">=</span> np.array([[np.mean((xtest[j,:,:]<span class="op">-</span> imgmean[i])<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>)]).argmin(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="93583d07-7a89-4d98-9c50-bf3ef30fec95" class="cell" data-execution_count="186">
<div class="sourceCode cell-code" id="cb688"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb688-1"><a href="#cb688-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(est <span class="op">==</span> ytest)<span class="op">/</span><span class="dv">10000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="186">
<pre><code>0.8203</code></pre>
</div>
</div>
<p><code>(10)</code> <code>(9)</code>의 과정에서 잘못분류된 이미지 10개를 선택하여 시각화 하라.</p>
<ul>
<li>실제 라벨과 잘못된 라벨을 구분하여 시각화 할 것</li>
</ul>
<div id="14bb79ad-cb64-4c05-aab9-6af7bdf2ed54" class="cell" data-execution_count="191">
<div class="sourceCode cell-code" id="cb690"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a>_ytest <span class="op">=</span> ytest[est <span class="op">!=</span> ytest]</span>
<span id="cb690-2"><a href="#cb690-2" aria-hidden="true" tabindex="-1"></a>_xtest <span class="op">=</span> xtest[est <span class="op">!=</span> ytest]</span>
<span id="cb690-3"><a href="#cb690-3" aria-hidden="true" tabindex="-1"></a>_est <span class="op">=</span> est[est <span class="op">!=</span> ytest]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="37310d65-5e9b-4bd7-84f7-43b894b8d6a7" class="cell" data-execution_count="196">
<div class="sourceCode cell-code" id="cb691"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb691-2"><a href="#cb691-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-3"><a href="#cb691-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].imshow(_xtest[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">0</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">0</span>],_est[<span class="dv">0</span>]))<span class="op">;</span></span>
<span id="cb691-4"><a href="#cb691-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].imshow(_xtest[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">1</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">1</span>],_est[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb691-5"><a href="#cb691-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">2</span>].imshow(_xtest[<span class="dv">2</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">2</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">2</span>],_est[<span class="dv">2</span>]))<span class="op">;</span></span>
<span id="cb691-6"><a href="#cb691-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">3</span>].imshow(_xtest[<span class="dv">3</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">3</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">3</span>],_est[<span class="dv">3</span>]))<span class="op">;</span></span>
<span id="cb691-7"><a href="#cb691-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">4</span>].imshow(_xtest[<span class="dv">4</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">4</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">4</span>],_est[<span class="dv">4</span>]))<span class="op">;</span></span>
<span id="cb691-8"><a href="#cb691-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-9"><a href="#cb691-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].imshow(_xtest[<span class="dv">5</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">0</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">5</span>],_est[<span class="dv">5</span>]))<span class="op">;</span></span>
<span id="cb691-10"><a href="#cb691-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].imshow(_xtest[<span class="dv">6</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">1</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">6</span>],_est[<span class="dv">6</span>]))<span class="op">;</span></span>
<span id="cb691-11"><a href="#cb691-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">2</span>].imshow(_xtest[<span class="dv">7</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">2</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">7</span>],_est[<span class="dv">7</span>]))<span class="op">;</span></span>
<span id="cb691-12"><a href="#cb691-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">3</span>].imshow(_xtest[<span class="dv">8</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">3</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">8</span>],_est[<span class="dv">8</span>]))<span class="op">;</span></span>
<span id="cb691-13"><a href="#cb691-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">4</span>].imshow(_xtest[<span class="dv">9</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">4</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">9</span>],_est[<span class="dv">9</span>]))<span class="op">;</span></span>
<span id="cb691-14"><a href="#cb691-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-15"><a href="#cb691-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-377-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="d.-회전변환" class="level2">
<h2 class="anchored" data-anchor-id="d.-회전변환">D. 회전변환</h2>
<p><code>1-3</code>. 아래는 우산모양의 scatter plot을 그릴 수 있는 <span class="math inline">\((x_i,y_i)\)</span> 좌표값을 불러와서 시각화하는 코드이다.</p>
<div id="daf07ba4-aedd-4ce1-8b86-1dcdcc02d92b" class="cell" data-tags="[]" data-execution_count="67">
<div class="sourceCode cell-code" id="cb692"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 자료저장 </span></span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true" tabindex="-1"></a>data_raw <span class="op">=</span> np.array(pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/2021IR/master/_notebooks/round2.csv'</span>)).T</span>
<span id="cb692-3"><a href="#cb692-3" aria-hidden="true" tabindex="-1"></a>data_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>array([[ 12,  12,  13, ..., 636, 636, 637],
       [313, 314, 279, ..., 416, 417, 409]])</code></pre>
</div>
</div>
<div id="376288fd-e18a-4d42-9be7-74b2191a9a97" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb694"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb694-1"><a href="#cb694-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 저장된 자료를 x,y로 분해 </span></span>
<span id="cb694-2"><a href="#cb694-2" aria-hidden="true" tabindex="-1"></a>x_raw,y_raw <span class="op">=</span> data_raw</span>
<span id="cb694-3"><a href="#cb694-3" aria-hidden="true" tabindex="-1"></a>x_raw,y_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>(array([ 12,  12,  13, ..., 636, 636, 637]),
 array([313, 314, 279, ..., 416, 417, 409]))</code></pre>
</div>
</div>
<div id="d46fb2de-0e73-4f21-b8ca-5989678aa65b" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb696"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb696-1"><a href="#cb696-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 시각화</span></span>
<span id="cb696-2"><a href="#cb696-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>)) <span class="co"># 그림크기고정</span></span>
<span id="cb696-3"><a href="#cb696-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x_raw,y_raw,<span class="st">'o'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-380-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>1</code>. <code>x_raw</code>와 <code>y_raw</code>를 각각 표준화하고 <code>x</code>, <code>y</code>에 저장하라. 결과를 시각화하라. 그리고 <code>x</code>, <code>y</code>를 바탕으로 <code>data</code> matrix를 다시 구성하라.</p>
<p><code>(풀이)</code></p>
<p><strong>표준화</strong></p>
<div id="12a6fef0-9d0f-4924-b597-0a8cd401094a" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb697"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> (x_raw<span class="op">-</span>np.mean(x_raw)) <span class="op">/</span> np.std(x_raw,ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb697-2"><a href="#cb697-2" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> (y_raw<span class="op">-</span>np.mean(y_raw)) <span class="op">/</span> np.std(y_raw,ddof<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>시각화</strong></p>
<div id="c1e219bf-133d-4f83-8f00-0e0d6bd1f65d" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb698"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb698-1"><a href="#cb698-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>)) <span class="co"># 그림크기고정</span></span>
<span id="cb698-2"><a href="#cb698-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-382-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>data matrix</strong> 재구성</p>
<div id="a8b97cad-493f-49fc-bbe1-f99252d067b8" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb699"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([x,y])</span>
<span id="cb699-2"><a href="#cb699-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<pre><code>array([[-1.79820085, -1.79820085, -1.79255336, ...,  1.72583347,
         1.72583347,  1.73148096],
       [-0.18390658, -0.17703046, -0.41769466, ...,  0.52433376,
         0.53120988,  0.47620092]])</code></pre>
</div>
</div>
<p><code>2</code>. 아래와 같은 규칙에 따라 <span class="math inline">\((x_i,y_i)\)</span>를 <span class="math inline">\((\tilde{x}_i,\tilde{y}_i\)</span>)로 변환하라. 단 여기에서 <span class="math inline">\(\theta= \frac{\pi}{4}\)</span>로 가정한다.</p>
<ul>
<li><span class="math inline">\({\tt xx}_i = \tilde{x}_i = (\cos\theta) x_i - (\sin\theta) y_i\)</span></li>
<li><span class="math inline">\({\tt yy}_i = \tilde{y}_i = (\sin\theta) x_i + (\cos\theta) y_i\)</span></li>
</ul>
<p><span class="math inline">\((x_i,y_i)\)</span>와 <span class="math inline">\((\tilde{x}_i, \tilde{y}_i)\)</span>를 겹쳐서 시각화 하라. 이 변환이 의미하는 바는 무엇이라고 생각하는가?</p>
<p><code>(풀이1)</code></p>
<div id="51743fc8-f666-488c-8534-078efd4b744a" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb701"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.pi<span class="op">/</span><span class="dv">4</span> </span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> np.cos(theta)<span class="op">*</span>x <span class="op">-</span> np.sin(theta)<span class="op">*</span>y</span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> np.sin(theta)<span class="op">*</span>x <span class="op">+</span> np.cos(theta)<span class="op">*</span>y</span>
<span id="cb701-4"><a href="#cb701-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb701-5"><a href="#cb701-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(x,y)$'</span>) </span>
<span id="cb701-6"><a href="#cb701-6" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(xx,yy)$'</span>)</span>
<span id="cb701-7"><a href="#cb701-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-384-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(풀이2)</code></p>
<p>아래의 규칙을 다시 고려하자.</p>
<ul>
<li><span class="math inline">\({\tt xx}_i = \tilde{x}_i = (\cos\theta) x_i - (\sin\theta) y_i\)</span></li>
<li><span class="math inline">\({\tt yy}_i = \tilde{y}_i = (\sin\theta) x_i + (\cos\theta) y_i\)</span></li>
</ul>
<p>이는 아래와 같이 재표현가능하다.</p>
<ul>
<li><p><span class="math inline">\(\begin{cases} {\tt xx}_1 = (\cos\theta)x_1 - (\sin\theta)y_1 \\ {\tt yy}_1 = (\sin\theta)x_1 + (\cos\theta)y_1 \end{cases}\)</span></p></li>
<li><p><span class="math inline">\(\begin{cases} {\tt xx}_2 = (\cos\theta)x_2 - (\sin\theta)y_2 \\ {\tt yy}_2 = (\sin\theta)x_2 + (\cos\theta)y_2 \end{cases}\)</span></p></li>
<li><p><span class="math inline">\(\dots\)</span></p></li>
<li><p><span class="math inline">\(\begin{cases} {\tt xx}_n = (\cos\theta)x_n - (\sin\theta)y_1 \\ {\tt yy}_n = (\sin\theta)x_n + (\cos\theta)y_n \end{cases}\)</span></p></li>
</ul>
<p>이는 다시 아래와 같이 재 표현가능하다.</p>
<ul>
<li><p><span class="math inline">\(\begin{bmatrix} {\tt xx}_1 \\ {\tt yy}_1 \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_1 \\ y_1 \end{bmatrix}\)</span></p></li>
<li><p><span class="math inline">\(\begin{bmatrix} {\tt xx}_2 \\ {\tt yy}_2 \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_2 \\ y_2 \end{bmatrix}\)</span></p></li>
<li><p><span class="math inline">\(\dots\)</span></p></li>
<li><p><span class="math inline">\(\begin{bmatrix} {\tt xx}_n \\ {\tt yy}_n \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_n \\ y_n \end{bmatrix}\)</span></p></li>
</ul>
<p>이는 다시 아래와 같이 재 표현가능하다. (이게 처음엔 생각하기 어려워요!! <span class="math inline">\(\star\star\star\)</span>)</p>
<ul>
<li><span class="math inline">\(\begin{bmatrix} {\tt xx}_1 &amp; {\tt xx}_2 &amp; \dots &amp; {\tt xx}_n \\ {\tt yy}_1 &amp; {\tt yy}_2 &amp; \dots &amp; {\tt yy}_n \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_1 &amp; x_2 &amp; \dots &amp; x_n \\ y_1 &amp; y_2 &amp; \dots &amp; y_n \end{bmatrix}\)</span></li>
</ul>
<p>위의 수식에 맞추어 변환을 진행하면</p>
<div id="64c2c065-7b15-4802-b531-2208d1ce2005" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb702"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb702-1"><a href="#cb702-1" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.pi<span class="op">/</span><span class="dv">4</span> </span>
<span id="cb702-2"><a href="#cb702-2" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> np.array([[np.cos(theta), <span class="op">-</span>np.sin(theta)],[np.sin(theta),np.cos(theta)]])</span>
<span id="cb702-3"><a href="#cb702-3" aria-hidden="true" tabindex="-1"></a>R </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]])</code></pre>
</div>
</div>
<div id="7687e20d-1aa6-49d9-8159-51ec8ae5cece" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb704"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb704-1"><a href="#cb704-1" aria-hidden="true" tabindex="-1"></a>R <span class="op">@</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>array([[-1.14147842, -1.14634057, -0.97217191, ...,  0.8495886 ,
         0.84472644,  0.88761703],
       [-1.40156161, -1.39669946, -1.56288136, ...,  1.59110851,
         1.59597066,  1.56106683]])</code></pre>
</div>
</div>
<div id="3ac4382f-60f3-4df2-b158-48250e1d166a" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb706"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb706-1"><a href="#cb706-1" aria-hidden="true" tabindex="-1"></a>xx,yy <span class="op">=</span> R <span class="op">@</span> data </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f6f28f09-d31c-4278-8c21-ce25324d5995" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb707"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb707-2"><a href="#cb707-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(x,y)$'</span>) </span>
<span id="cb707-3"><a href="#cb707-3" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(xx,yy)$'</span>)</span>
<span id="cb707-4"><a href="#cb707-4" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-388-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>3</code>. 2번과 같은 변환을 8번 연속진행한 결과를 시각화하라.</p>
<p><code>(풀이)</code></p>
<div id="2030a3c3-2570-48cf-9476-4672cbb55d5a" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb708"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb708-1"><a href="#cb708-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb708-2"><a href="#cb708-2" aria-hidden="true" tabindex="-1"></a>xx,yy<span class="op">=</span>np.linalg.matrix_power(R,<span class="dv">8</span>) <span class="op">@</span> data</span>
<span id="cb708-3"><a href="#cb708-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$data=(x,y)$'</span>) </span>
<span id="cb708-4"><a href="#cb708-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$R^8@data=(xx,yy)$'</span>)</span>
<span id="cb708-5"><a href="#cb708-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-389-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>4</code>. 2번의 변환을 역변환하는 코드를 구현하라. 원본, 변환, 역변환한 자료를 순서대로 시각화 하라. 결과를 아래와 같이 저장하라.</p>
<ul>
<li>원본: <span class="math inline">\({\tt x}, {\tt y}\)</span></li>
<li>2번변환: <span class="math inline">\({\tt xx}, {\tt yy}\)</span></li>
<li>2번의역변환 <span class="math inline">\({\tt xxx}, {\tt yyy}\)</span></li>
</ul>
<p><code>(풀이)</code></p>
<div id="802d145c-86b8-4d02-bc71-2b3e19d78321" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb709"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true" tabindex="-1"></a>xx,yy <span class="op">=</span> R<span class="op">@</span>data </span>
<span id="cb709-2"><a href="#cb709-2" aria-hidden="true" tabindex="-1"></a>xxx,yyy <span class="op">=</span> np.linalg.inv(R)<span class="op">@</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="8fef6f01-7ae4-4ca3-9603-1c713b3d6c9b" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb710"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb710-1"><a href="#cb710-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb710-2"><a href="#cb710-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'.'</span>, label<span class="op">=</span><span class="vs">r'$data = (x,y)$'</span>) </span>
<span id="cb710-3"><a href="#cb710-3" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'.'</span>, label<span class="op">=</span><span class="vs">r'$R@data = (xx,yy)$'</span>)</span>
<span id="cb710-4"><a href="#cb710-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xxx,yyy,<span class="st">'.'</span>, label<span class="op">=</span><span class="vs">r'$R^{-1}@data = (xxx,yyy)$'</span>)</span>
<span id="cb710-5"><a href="#cb710-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-391-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="e.-삼성전자의-주가" class="level2">
<h2 class="anchored" data-anchor-id="e.-삼성전자의-주가">E. 삼성전자의 주가</h2>
<div id="5ae47e56-1da7-419d-bf02-33ad91ede034" class="cell">
<div class="sourceCode cell-code" id="cb711"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a>ㅍ</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><code>5-8</code>. 시계열 자료와 이동평균</p>
<p><code>5</code>. 아래의 수식에 따르는 수열 <span class="math inline">\(x_t\)</span>를 생성하라. 단, <span class="math inline">\(T=1000\)</span> 으로 설정하고 랜덤시드는 <code>np.random.seed(2)</code>와 같이 설정한다.</p>
<ul>
<li><span class="math inline">\(x_1=\epsilon_1\)</span></li>
<li><span class="math inline">\(x_2=\epsilon_1+\epsilon_2\)</span></li>
<li><span class="math inline">\(x_3=\epsilon_1+\epsilon_2+\epsilon_3\)</span></li>
<li><span class="math inline">\(\dots\)</span></li>
<li><span class="math inline">\(x_T=\sum_{t=1}^{T} \epsilon_t\)</span></li>
</ul>
<p>생성결과를 시각화하라.</p>
<p><strong>hint</strong> 아래의 코드를 활용하면 쉽다.</p>
<div id="8b4f872f-5948-4878-8301-bb465d2123ef" class="cell">
<div class="sourceCode cell-code" id="cb712"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb712-1"><a href="#cb712-1" aria-hidden="true" tabindex="-1"></a>np.cumsum([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array([ 1,  3,  6, 10])</code></pre>
</div>
</div>
<p><code>(풀이)</code></p>
<div id="ca8fcfdb-d779-437c-b1b4-e0b5903b0546" class="cell">
<div class="sourceCode cell-code" id="cb714"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb714-1"><a href="#cb714-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb714-2"><a href="#cb714-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">2</span>)</span>
<span id="cb714-3"><a href="#cb714-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.random.randn(<span class="dv">1000</span>)</span>
<span id="cb714-4"><a href="#cb714-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> epsilon.cumsum()</span>
<span id="cb714-5"><a href="#cb714-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-394-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>6</code>. 아래와 같은 변환을 수행하고 결과를 시각화 하라.</p>
<ul>
<li><span class="math inline">\({\tt xx}_1= \frac{1}{3}(x_1+x_2)\)</span></li>
<li><span class="math inline">\({\tt xx}_2= \frac{1}{3}(x_1+x_2+x_3)\)</span></li>
<li><span class="math inline">\({\tt xx}_3= \frac{1}{3}(x_2+x_3+x_4)\)</span></li>
<li><span class="math inline">\(\dots\)</span></li>
<li><span class="math inline">\({\tt xx}_{T-1}= \frac{1}{3}(x_{T-1}+x_{T-1}+x_T)\)</span></li>
<li><span class="math inline">\({\tt xx}_{T}= \frac{1}{3}(x_{T-1}+x_T)\)</span></li>
</ul>
<p><strong>hint</strong> 아래의 수식을 이용하라.</p>
<ul>
<li><span class="math inline">\(\begin{bmatrix} {\tt xx}_1 \\ {\tt xx}_2 \\ {\tt xx}_3 \\ \dots \\ {\tt xx}_{T-1} \\ {\tt xx}_T \end{bmatrix}= \begin{bmatrix} 1/3 &amp; 1/3 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 1/3 &amp; 1/3 &amp; 1/3 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ 0 &amp; 1/3 &amp; 1/3 &amp; 1/3 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 0 &amp; 0 \\ \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots &amp; \dots \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 1/3 &amp; 1/3 &amp; 1/3 \\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; \dots &amp; 0 &amp; 0 &amp; 1/3 &amp; 1/3 \\ \end{bmatrix}\begin{bmatrix} x_1 \\ x_2 \\ x_3 \\ \dots \\ x_{T-1} \\ x_T \end{bmatrix}\)</span></li>
</ul>
<p><code>(풀이)</code></p>
<div id="ef5c226c-7434-41ee-a49f-204871aa7cb2" class="cell">
<div class="sourceCode cell-code" id="cb715"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a>M <span class="op">=</span> np.array([[<span class="bu">abs</span>(i<span class="op">-</span>j)<span class="op">&lt;</span><span class="dv">2</span> <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(T)] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(T)])<span class="op">*</span><span class="dv">1</span><span class="op">/</span><span class="dv">3</span></span>
<span id="cb715-2"><a href="#cb715-2" aria-hidden="true" tabindex="-1"></a>M</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([[0.33333333, 0.33333333, 0.        , ..., 0.        , 0.        ,
        0.        ],
       [0.33333333, 0.33333333, 0.33333333, ..., 0.        , 0.        ,
        0.        ],
       [0.        , 0.33333333, 0.33333333, ..., 0.        , 0.        ,
        0.        ],
       ...,
       [0.        , 0.        , 0.        , ..., 0.33333333, 0.33333333,
        0.        ],
       [0.        , 0.        , 0.        , ..., 0.33333333, 0.33333333,
        0.33333333],
       [0.        , 0.        , 0.        , ..., 0.        , 0.33333333,
        0.33333333]])</code></pre>
</div>
</div>
<div id="48263bcc-58f2-4f7d-9480-151c774100bb" class="cell">
<div class="sourceCode cell-code" id="cb717"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb717-2"><a href="#cb717-2" aria-hidden="true" tabindex="-1"></a>plt.plot(M<span class="op">@</span>x,<span class="st">'--'</span>,label<span class="op">=</span><span class="vs">r'$M@x$'</span>)</span>
<span id="cb717-3"><a href="#cb717-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-396-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>끝이 올라간 이유? 마지막에 <span class="math inline">\(\frac{1}{3}(x_{T-1}+x_T+x_{T+1})\)</span> 대신에 <span class="math inline">\(\frac{1}{3}(x_{T-1}+x_T+0)\)</span> 을 이용하였기 때문</li>
</ul>
<p><code>7</code>. 아래와 같은 변환을 수행하고 결과를 시각화하라.</p>
<ul>
<li><span class="math inline">\({\tt xx}_1= \frac{1}{3}(x_1+x_1+x_2)\)</span></li>
<li><span class="math inline">\({\tt xx}_2= \frac{1}{3}(x_1+x_2+x_3)\)</span></li>
<li><span class="math inline">\({\tt xx}_3= \frac{1}{3}(x_2+x_3+x_4)\)</span></li>
<li><span class="math inline">\(\dots\)</span></li>
<li><span class="math inline">\({\tt xx}_{T-1}= \frac{1}{3}(x_{T-1}+x_{T-1}+x_T)\)</span></li>
<li><span class="math inline">\({\tt xx}_{T}= \frac{1}{3}(x_{T-1}+x_T+x_T)\)</span></li>
</ul>
<p><code>(풀이)</code></p>
<div id="6805dcac-7b7e-44c6-8944-a8b1df923236" class="cell">
<div class="sourceCode cell-code" id="cb718"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb718-1"><a href="#cb718-1" aria-hidden="true" tabindex="-1"></a>M[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span> </span>
<span id="cb718-2"><a href="#cb718-2" aria-hidden="true" tabindex="-1"></a>M[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span> </span>
<span id="cb718-3"><a href="#cb718-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb718-4"><a href="#cb718-4" aria-hidden="true" tabindex="-1"></a>plt.plot(M<span class="op">@</span>x,label<span class="op">=</span><span class="vs">r'$M@x$'</span>)</span>
<span id="cb718-5"><a href="#cb718-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-397-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>8</code>. 7번의 변환을 100번 반복하고 시각화하라.</p>
<p><code>(풀이)</code></p>
<div id="dfacc12c-880d-44fb-a787-50e0ed045816" class="cell">
<div class="sourceCode cell-code" id="cb719"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb719-2"><a href="#cb719-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linalg.matrix_power(M,<span class="dv">100</span>)<span class="op">@</span>x,label<span class="op">=</span><span class="vs">r'$M^</span><span class="sc">{100}</span><span class="vs">@x$'</span>)</span>
<span id="cb719-3"><a href="#cb719-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-398-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>9</code>. 7번의 변환을 1000번 반복하고 시각화하라.</p>
<div id="9b8e56cf-8a79-42cb-b42e-de5b1ebc42f8" class="cell">
<div class="sourceCode cell-code" id="cb720"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb720-1"><a href="#cb720-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb720-2"><a href="#cb720-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linalg.matrix_power(M,<span class="dv">1000</span>)<span class="op">@</span>x,label<span class="op">=</span><span class="vs">r'$M^</span><span class="sc">{1000}</span><span class="vs">@x$'</span>)</span>
<span id="cb720-3"><a href="#cb720-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-399-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="f.-회귀분석-미리보기" class="level2">
<h2 class="anchored" data-anchor-id="f.-회귀분석-미리보기">F. 회귀분석 미리보기</h2>
<p><code>1--7</code>.</p>
<p><code>1</code>. <span class="math inline">\(x_i\)</span>가 아래와 같이 주어졌다고 가정하자.</p>
<div id="bc7d3f1d-7be0-4052-b279-3b4374ea584d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb721"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span>  np.array([<span class="fl">0.00983</span>, <span class="fl">0.01098</span>, <span class="fl">0.02951</span>, <span class="fl">0.0384</span> , <span class="fl">0.03973</span>, <span class="fl">0.04178</span>, <span class="fl">0.0533</span> ,</span>
<span id="cb721-2"><a href="#cb721-2" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.058</span>  , <span class="fl">0.09454</span>, <span class="fl">0.1103</span> , <span class="fl">0.1328</span> , <span class="fl">0.1412</span> , <span class="fl">0.1497</span> , <span class="fl">0.1664</span> ,</span>
<span id="cb721-3"><a href="#cb721-3" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.1906</span> , <span class="fl">0.1923</span> , <span class="fl">0.198</span>  , <span class="fl">0.2141</span> , <span class="fl">0.2393</span> , <span class="fl">0.2433</span> , <span class="fl">0.3157</span> ,</span>
<span id="cb721-4"><a href="#cb721-4" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.3228</span> , <span class="fl">0.3418</span> , <span class="fl">0.3552</span> , <span class="fl">0.3918</span> , <span class="fl">0.3962</span> , <span class="fl">0.4</span>    , <span class="fl">0.4482</span> ,</span>
<span id="cb721-5"><a href="#cb721-5" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.496</span>  , <span class="fl">0.507</span>  , <span class="fl">0.53</span>   , <span class="fl">0.5654</span> , <span class="fl">0.582</span>  , <span class="fl">0.5854</span> , <span class="fl">0.5854</span> ,</span>
<span id="cb721-6"><a href="#cb721-6" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.6606</span> , <span class="fl">0.7007</span> , <span class="fl">0.723</span>  , <span class="fl">0.7305</span> , <span class="fl">0.7383</span> , <span class="fl">0.7656</span> , <span class="fl">0.7725</span> ,</span>
<span id="cb721-7"><a href="#cb721-7" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.831</span>  , <span class="fl">0.8896</span> , <span class="fl">0.9053</span> , <span class="fl">0.914</span>  , <span class="fl">0.949</span>  , <span class="fl">0.952</span>  , <span class="fl">0.9727</span> ,</span>
<span id="cb721-8"><a href="#cb721-8" aria-hidden="true" tabindex="-1"></a>               <span class="fl">0.982</span>  ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>아래의 수식에 따라 <span class="math inline">\(y_i\)</span>를 생성하라.</p>
<ul>
<li><span class="math inline">\(y_i = 2+3x_i +\epsilon_i,\quad \epsilon_i \overset{iid}{\sim} N(0,1)\)</span></li>
</ul>
<p><span class="math inline">\((x_i,y_i)\)</span>를 산점도를 이용하여 시각화하라.</p>
<p>(풀이)</p>
<div id="b51c78ae-4a39-4feb-9ba5-db1766b57880" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb722"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb722-1"><a href="#cb722-1" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">2</span><span class="op">+</span><span class="dv">3</span><span class="op">*</span>x <span class="op">+</span> np.random.randn(<span class="dv">50</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="a49b836d-2854-46c1-9b3b-c9f34dd77720" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb723"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$(x_i,y_i)$'</span>)</span>
<span id="cb723-2"><a href="#cb723-2" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-402-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>2</code>. <code>1</code>과 같은 자료를 잘 표현할 수 있는 적절한 추세선 <span class="math inline">\((x_i, \hat{y}_i)\)</span>를 그리기 위하여 아래의 수식을 고려하자.</p>
<ul>
<li><span class="math inline">\(\hat{y}_i = ax_i+b\)</span></li>
</ul>
<p>a,b를 각각 아래의 표에 의하여 선택하였을 경우 추세선을 문제하단에 명시된 요구사항에 맞추어 시각화하라.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><span class="math inline">\(a\)</span></th>
<th style="text-align: center;"><span class="math inline">\(b\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">(a)</td>
<td style="text-align: center;"><span class="math inline">\(1\)</span></td>
<td style="text-align: center;"><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">(b)</td>
<td style="text-align: center;"><span class="math inline">\(2.5\)</span></td>
<td style="text-align: center;"><span class="math inline">\(2\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">(c)</td>
<td style="text-align: center;"><span class="math inline">\(3\)</span></td>
<td style="text-align: center;"><span class="math inline">\(2\)</span></td>
</tr>
</tbody>
</table>
<p><strong>요구사항</strong></p>
<ul>
<li><span class="math inline">\((x_i,y_i)\)</span>를 산점도로 그리고 각 (a),(b),(c)에 대한 <span class="math inline">\((x_i,\hat{y}_i)\)</span>를 lineplot으로 겹쳐그릴 것</li>
<li>범례를 포함할 것</li>
</ul>
<div id="6652a054-6ab9-4af2-adb8-2c30ca824fa2" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb724"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb724-1"><a href="#cb724-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$(x_i,y_i)$'</span>)</span>
<span id="cb724-2"><a href="#cb724-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,<span class="dv">1</span><span class="op">*</span>x<span class="op">+</span><span class="dv">0</span>,<span class="st">'--'</span>,label<span class="op">=</span><span class="vs">r'(a) $(x_i,\hat</span><span class="sc">{y}</span><span class="vs">_i)$'</span>)</span>
<span id="cb724-3"><a href="#cb724-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x,<span class="fl">2.5</span><span class="op">*</span>x<span class="op">+</span><span class="dv">2</span>,<span class="st">'--'</span>,label<span class="op">=</span><span class="vs">r'(b) $(x_i,\hat</span><span class="sc">{y}</span><span class="vs">_i)$'</span>)</span>
<span id="cb724-4"><a href="#cb724-4" aria-hidden="true" tabindex="-1"></a>plt.plot(x,<span class="dv">3</span><span class="op">*</span>x<span class="op">+</span><span class="dv">2</span>,<span class="st">'--'</span>,label<span class="op">=</span><span class="vs">r'(c) $(x_i,\hat</span><span class="sc">{y}</span><span class="vs">_i)$'</span>)</span>
<span id="cb724-5"><a href="#cb724-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-403-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>3</code>. 아래를 각각 계산하라.</p>
<p><code>(a)</code> <span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n}(y_i-x_i)^2\)</span></p>
<p><code>(b)</code> <span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n}(y_i-2-2.5x_i)^2\)</span></p>
<p><code>(c)</code> <span class="math inline">\(\frac{1}{n}\sum_{i=1}^{n}(y_i-2-3x_i)^2\)</span></p>
<p>가장 작은 값을 가지는 것은 무엇인가?</p>
<p>(풀이)</p>
<div id="0b0ca8d2-4b95-4be9-8e67-fb1b9ac6a8eb" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb725"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a>np.mean((y<span class="op">-</span>(<span class="dv">1</span><span class="op">*</span>x<span class="op">+</span><span class="dv">0</span>))<span class="op">**</span><span class="dv">2</span>), np.mean((y<span class="op">-</span>(<span class="fl">2.5</span><span class="op">*</span>x<span class="op">+</span><span class="dv">2</span>))<span class="op">**</span><span class="dv">2</span>), np.mean((y<span class="op">-</span>(<span class="dv">3</span><span class="op">*</span>x<span class="op">+</span><span class="dv">2</span>))<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>(9.310962556625569, 1.1267147296257563, 1.0907585903281032)</code></pre>
</div>
</div>
<p>가장 작은 값을 가지는 것은 (c)이다.</p>
<p><code>4</code>. 3의 결과를 근거로 (a)-(c)중 가장 적절한 추세선을 판단하고 적절한 순서대로 나열하라.</p>
<p><code>(풀이)</code></p>
<p>3-(a),(b),(c)는 각각</p>
<ul>
<li><span class="math inline">\(\hat{y}_i=x_i\)</span></li>
<li><span class="math inline">\(\hat{y}_i=2+2.5x_i\)</span></li>
<li><span class="math inline">\(\hat{y}_i=2+3x_i\)</span></li>
</ul>
<p>일 경우</p>
<p><span class="math display">\[{\tt mse}({\boldsymbol y}, \hat{\boldsymbol y}) = \frac{1}{n}\sum_{i=1}^{n}(y_i -\hat{y}_i)^2\]</span></p>
<p>를 계산한 것이라 해석할 수 있다. 그런데 <span class="math inline">\({\tt mse}({\boldsymbol y}, \hat{\boldsymbol y})\)</span>의 값은</p>
<ul>
<li><span class="math inline">\(y_1 \approx \hat{y}_1\)</span></li>
<li><span class="math inline">\(y_2 \approx \hat{y}_2\)</span></li>
<li><span class="math inline">\(\dots\)</span></li>
<li><span class="math inline">\(y_n \approx \hat{y}_n\)</span></li>
</ul>
<p>일수록 작은 값을 가진다. 그리고 위의 조건은 더 적절하게 추세선을 그렸을때 만족된다. 요약하면</p>
<ul>
<li>적절한 추세선을 그림 <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\(y_i \approx \hat{y}_i\)</span> <span class="math inline">\(\Rightarrow\)</span> <span class="math inline">\({\tt mse}({\boldsymbol y}, \hat{\boldsymbol y})\)</span> 값이 작아짐</li>
</ul>
<p>와 같은 관계가 있음을 파악할 수 있다. 따라서 <span class="math inline">\({\tt mse}({\boldsymbol y}, \hat{\boldsymbol y})\)</span>의 값이 작을수록 적절한 추세선이라 생각할 수 있다.</p>
<p><code>5</code>. 아래와 같은 수식을 이용하여 <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1\)</span> 을 계산하라.</p>
<p><span class="math display">\[\begin{bmatrix} \hat{\beta}_0 \\ \hat{\beta}_1 \end{bmatrix} = ({\bf X}^T {\bf X})^{-1}{\bf X}^T {\boldsymbol y}, \quad {\bf X}=\begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ \dots \\ 1 &amp; x_n \end{bmatrix}\]</span></p>
<p><code>(풀이)</code></p>
<div id="654bc3a1-bf9d-4630-930c-6767062cf722" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb727"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb727-1"><a href="#cb727-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.stack([[<span class="dv">1</span>]<span class="op">*</span><span class="dv">50</span> ,x],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb727-2"><a href="#cb727-2" aria-hidden="true" tabindex="-1"></a>np.linalg.inv(X.T <span class="op">@</span> X)<span class="op">@</span>X.T<span class="op">@</span>y </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>array([1.97914281, 2.90834079])</code></pre>
</div>
</div>
<p><span class="math inline">\(\hat{\beta}_0=1.97914281\)</span> 이고 <span class="math inline">\(\hat{\beta}_1= 2.90834079\)</span> 이다.</p>
<p><code>6</code>. <code>5</code>에서 계산된 <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1\)</span>을 각각 <span class="math inline">\(b=\hat{\beta}_0, a=\hat{\beta}_1\)</span>으로 생각하고 적절한 추세선 <span class="math inline">\((x_i, \hat{y}_i)\)</span>를 그려라. (단, <span class="math inline">\(\hat{y}_i=ax_i+b\)</span> 이다)</p>
<p><code>(풀이)</code></p>
<div id="7b4d4cb8-26da-4772-8b3e-e1433c4b10e2" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb729"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a>b, a <span class="op">=</span> np.linalg.inv(X.T <span class="op">@</span> X)<span class="op">@</span>X.T<span class="op">@</span>y </span>
<span id="cb729-2"><a href="#cb729-2" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> a<span class="op">*</span>x <span class="op">+</span>b </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="22c8222f-1bba-4b81-9803-82a970554cb9" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb730"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$(x_i,y_i)$'</span>)</span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,yhat,<span class="st">'--'</span>,label<span class="op">=</span><span class="vs">r'$(x_i,\hat</span><span class="sc">{y}</span><span class="vs">_i)$'</span>)</span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="06wk-2_files/figure-html/cell-407-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>7</code>. 4의 기준에 따르면, <span class="math inline">\((a,b)=(3,2)\)</span> 일때 만들어지는 추세선과 <span class="math inline">\((a,b)=(\hat{\beta}_1,\hat{\beta}_0)\)</span> 일때 만들어지는 추세선은 어떤 것이 더 적절한가?</p>
<p><code>(풀이)</code></p>
<div id="f1d584c9-ba9f-4c0a-8872-f85c085cc44b" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb731"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a>np.mean((y<span class="op">-</span>(<span class="dv">3</span><span class="op">*</span>x<span class="op">+</span><span class="dv">2</span>))<span class="op">**</span><span class="dv">2</span>), np.mean((y<span class="op">-</span>yhat)<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>(1.0907585903281032, 1.0862796480117118)</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="guebin/DL2024" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>