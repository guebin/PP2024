<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.520">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="최규빈">
<meta name="dcterms.date" content="2024-04-19">

<title>PP2024 - 07wk-2: numpy (2)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">PP2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/guebin/PP2024"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/channel/UCQk9RyBNgXc7ORIsYlOfQrg/playlists?view=50&amp;sort=dd&amp;shelf_id=2"> <i class="bi bi-youtube" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#강의영상" id="toc-강의영상" class="nav-link active" data-scroll-target="#강의영상">1. 강의영상</a></li>
  <li><a href="#imports" id="toc-imports" class="nav-link" data-scroll-target="#imports">2. Imports</a></li>
  <li><a href="#numpy의-랜덤모듈" id="toc-numpy의-랜덤모듈" class="nav-link" data-scroll-target="#numpy의-랜덤모듈">3. <code>numpy</code>의 랜덤모듈</a>
  <ul class="collapse">
  <li><a href="#a.-np.random.rand" id="toc-a.-np.random.rand" class="nav-link" data-scroll-target="#a.-np.random.rand">A. np.random.rand()</a></li>
  <li><a href="#b.-np.random.randn" id="toc-b.-np.random.randn" class="nav-link" data-scroll-target="#b.-np.random.randn">B. np.random.randn()</a></li>
  <li><a href="#c.-np.random.randint" id="toc-c.-np.random.randint" class="nav-link" data-scroll-target="#c.-np.random.randint">C. np.random.randint()</a></li>
  <li><a href="#d.-np.random.choice" id="toc-d.-np.random.choice" class="nav-link" data-scroll-target="#d.-np.random.choice">D. np.random.choice()</a></li>
  <li><a href="#e.-통계분포" id="toc-e.-통계분포" class="nav-link" data-scroll-target="#e.-통계분포">E. 통계분포</a></li>
  </ul></li>
  <li><a href="#numpy-기타-유용한-기본기능들" id="toc-numpy-기타-유용한-기본기능들" class="nav-link" data-scroll-target="#numpy-기타-유용한-기본기능들">4. <code>numpy</code> – 기타 유용한 기본기능들</a>
  <ul class="collapse">
  <li><a href="#a.-np.where-np.argwhere" id="toc-a.-np.where-np.argwhere" class="nav-link" data-scroll-target="#a.-np.where-np.argwhere">A. np.where, np.argwhere</a></li>
  <li><a href="#b.-인덱싱고급" id="toc-b.-인덱싱고급" class="nav-link" data-scroll-target="#b.-인덱싱고급">B. 인덱싱고급</a></li>
  <li><a href="#c.-np.ix_" id="toc-c.-np.ix_" class="nav-link" data-scroll-target="#c.-np.ix_">C. np.ix_</a></li>
  <li><a href="#d.-note-1-메소드-도움말-확인하기" id="toc-d.-note-1-메소드-도움말-확인하기" class="nav-link" data-scroll-target="#d.-note-1-메소드-도움말-확인하기">D. note 1: 메소드 도움말 확인하기</a></li>
  <li><a href="#e.-hstack-vstack" id="toc-e.-hstack-vstack" class="nav-link" data-scroll-target="#e.-hstack-vstack">E. hstack, vstack</a></li>
  <li><a href="#f.-append" id="toc-f.-append" class="nav-link" data-scroll-target="#f.-append">F. append</a></li>
  <li><a href="#g.-ravel-flatten" id="toc-g.-ravel-flatten" class="nav-link" data-scroll-target="#g.-ravel-flatten">G. ravel, flatten</a></li>
  <li><a href="#h.-통계관련함수들" id="toc-h.-통계관련함수들" class="nav-link" data-scroll-target="#h.-통계관련함수들">H. 통계관련함수들</a></li>
  <li><a href="#i.-dtype" id="toc-i.-dtype" class="nav-link" data-scroll-target="#i.-dtype">I. dtype</a></li>
  <li><a href="#j.-브로드캐스팅과-시간측정" id="toc-j.-브로드캐스팅과-시간측정" class="nav-link" data-scroll-target="#j.-브로드캐스팅과-시간측정">J. 브로드캐스팅과 시간측정</a></li>
  </ul></li>
  <li><a href="#numpy의-활용" id="toc-numpy의-활용" class="nav-link" data-scroll-target="#numpy의-활용">5. <code>numpy</code>의 활용</a>
  <ul class="collapse">
  <li><a href="#a.-이미지-자료처리" id="toc-a.-이미지-자료처리" class="nav-link" data-scroll-target="#a.-이미지-자료처리">A. 이미지 자료처리</a></li>
  <li><a href="#c.-mnist-data" id="toc-c.-mnist-data" class="nav-link" data-scroll-target="#c.-mnist-data">C. MNIST data</a></li>
  <li><a href="#d.-회전변환" id="toc-d.-회전변환" class="nav-link" data-scroll-target="#d.-회전변환">D. 회전변환</a></li>
  <li><a href="#e.-삼성전자의-주가" id="toc-e.-삼성전자의-주가" class="nav-link" data-scroll-target="#e.-삼성전자의-주가">E. 삼성전자의 주가</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="07wk-2.out.ipynb" download="07wk-2.out.ipynb"><i class="bi bi-journal-code"></i>Jupyter</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">07wk-2: <code>numpy</code> (2)</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>최규빈 </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 19, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><a href="https://colab.research.google.com/github/guebin/PP2024/blob/main/posts/06wk-2.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" style="text-align: left"></a></p>
<section id="강의영상" class="level1">
<h1>1. 강의영상</h1>
<div id="ee444e11-fe07-4f1a-972c-2407eccb02a4" class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#{{&lt;video https://youtu.be/playlist?list=PLQqh36zP38-wwdZJIQiqJdmbWB90HM-VK&amp;si=O2VyS-dYdtqnlD25 &gt;}}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="imports" class="level1">
<h1>2. Imports</h1>
<div id="12fd652d-0d83-42a5-a028-f6b38ee16f81" class="cell" data-tags="[]" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="numpy의-랜덤모듈" class="level1">
<h1>3. <code>numpy</code>의 랜덤모듈</h1>
<section id="a.-np.random.rand" class="level2">
<h2 class="anchored" data-anchor-id="a.-np.random.rand">A. np.random.rand()</h2>
<p><code>-</code> 0~1사이에서 10개의 난수 생성</p>
<div id="5c763bd0-f660-47c7-98e2-094da095e13d" class="cell" data-tags="[]" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>array([0.804117  , 0.40515946, 0.70006342, 0.59268619, 0.57477613,
       0.51636293, 0.50663576, 0.38671782, 0.52834403, 0.36842701])</code></pre>
</div>
</div>
<p><code>-</code> 0~2사이에서 10개의 난수 생성</p>
<div id="536783a4-05e0-46dc-b2e0-184da355ca9b" class="cell" data-tags="[]" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>array([0.44328761, 1.09441157, 1.22016676, 0.1784673 , 0.66460577,
       1.90128112, 1.24006865, 1.22984204, 0.6967951 , 0.6274235 ])</code></pre>
</div>
</div>
<p><code>-</code> 1~2사이에서 10개의 난수 생성</p>
<div id="149697f6-265d-4890-8f56-db8f1fd40991" class="cell" data-tags="[]" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)<span class="op">+</span><span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array([1.79831969, 1.86073507, 1.4498197 , 1.14651244, 1.96708303,
       1.32119822, 1.97414431, 1.43890931, 1.94026913, 1.58103247])</code></pre>
</div>
</div>
<p><code>-</code> 1~3사이에서 10개의 난수 생성</p>
<div id="cebcdfa3-56cf-4a22-aec8-ccdd69328026" class="cell" data-tags="[]" data-execution_count="5">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>np.random.rand(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">1</span> <span class="co"># 1~3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>array([2.92670936, 1.06575262, 2.79805911, 2.70092812, 2.62670967,
       2.68412991, 2.46048604, 1.61290482, 1.37700015, 1.34542018])</code></pre>
</div>
</div>
</section>
<section id="b.-np.random.randn" class="level2">
<h2 class="anchored" data-anchor-id="b.-np.random.randn">B. np.random.randn()</h2>
<p><code>-</code> N(0,1)에서 10개 추출</p>
<div id="e0959c2b-0703-44b5-a217-763bc44dbbfc" class="cell" data-tags="[]" data-execution_count="6">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>) <span class="co"># 표준정규분포에서 10개의 샘플 추출 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>array([ 1.9594899 , -2.57933351, -0.11968579,  0.4853538 , -1.25280219,
        1.14533729, -0.63337226, -0.10683217,  0.0383186 , -0.00314399])</code></pre>
</div>
</div>
<p><code>-</code> N(1,1)에서 10개 추출</p>
<div id="6940ecb8-1dc8-42df-861e-03a6818f5a39" class="cell" data-tags="[]" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>)<span class="op">+</span><span class="dv">1</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([ 3.09493878,  1.09184555, -0.18372488,  0.64241876,  1.56063757,
        0.5653692 ,  1.55602471, -0.780332  , -0.44202235,  0.50284112])</code></pre>
</div>
</div>
<p><code>-</code> N(0,4)에서 10개 추출 (평균이 0이고 분산이 4인 분포)</p>
<div id="2a568590-eebf-4004-bf1e-d043230b3dd9" class="cell" data-tags="[]" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([ 2.64740061,  0.76270087, -3.27291493, -1.15756103,  3.88467374,
        2.76232302, -1.13167535,  0.03009205,  1.73677395,  0.31872767])</code></pre>
</div>
</div>
<p><code>-</code> N(3,4)에서 10개 추출</p>
<div id="61d00969-28d1-4bee-9f6f-3cadbb0090c8" class="cell" data-tags="[]" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>np.random.randn(<span class="dv">10</span>)<span class="op">*</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([1.08578264, 1.29888698, 3.7542317 , 5.07567841, 3.42541637,
       4.75153724, 6.14590148, 3.62632026, 0.96250802, 4.726517  ])</code></pre>
</div>
</div>
</section>
<section id="c.-np.random.randint" class="level2">
<h2 class="anchored" data-anchor-id="c.-np.random.randint">C. np.random.randint()</h2>
<p><code>-</code> [0,7)의 범위에서 하나의 정수를 랜덤으로 생성</p>
<div id="cc683538-f4fd-428b-a81c-fe5578a4e7e6" class="cell" data-tags="[]" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">7</span>) <span class="co"># [0,7)의 범위에서 하나의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>1</code></pre>
</div>
</div>
<p><code>-</code> [0,7)의 범위에서 20개의 정수를 랜덤으로 생성</p>
<div id="358a6f90-17fb-4cc9-baed-33108c95105c" class="cell" data-tags="[]" data-execution_count="11">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">7</span>,size<span class="op">=</span>(<span class="dv">20</span>,)) <span class="co"># [0,7)의 범위에서 20개의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([5, 3, 6, 4, 1, 6, 4, 6, 4, 5, 3, 5, 3, 1, 5, 0, 4, 4, 2, 6])</code></pre>
</div>
</div>
<p><code>-</code> [0,7)의 범위에서 (2,2) shape 으로 정수를 랜덤으로 생성</p>
<div id="95f93e41-c35c-46f7-9d4c-199304eac9aa" class="cell" data-tags="[]" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(<span class="dv">7</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># [0,7)의 범위에서 (2,2) shape의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([[0, 1],
       [0, 6]])</code></pre>
</div>
</div>
<p><code>-</code> 위와 같은 코드를 아래와 같이 구현가능</p>
<div id="a2d2d694-914f-4464-8631-a717cc5295a5" class="cell" data-tags="[]" data-execution_count="13">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(low<span class="op">=</span><span class="dv">7</span>,size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># [0,7)의 범위에서 (5,5) shape의 정수 생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([[0, 2, 5, 1, 2],
       [5, 2, 2, 1, 0],
       [1, 6, 4, 1, 5],
       [6, 4, 1, 2, 5],
       [0, 2, 0, 1, 6]])</code></pre>
</div>
</div>
<p><code>-</code> [10,20) 의 범위에서 (5,5) shape 정수를 랜덤으로 생성</p>
<div id="0e9b4fdd-e024-4729-adbe-b9cb63d3737e" class="cell" data-tags="[]" data-execution_count="14">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>np.random.randint(low<span class="op">=</span><span class="dv">10</span>,high<span class="op">=</span><span class="dv">20</span>,size<span class="op">=</span>(<span class="dv">5</span>,<span class="dv">5</span>)) <span class="co"># [10,20)의 범위에서 (5,5)shape의 정수생성 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([[13, 12, 17, 19, 10],
       [12, 14, 14, 15, 19],
       [16, 17, 11, 11, 15],
       [14, 19, 15, 13, 14],
       [12, 14, 12, 12, 19]])</code></pre>
</div>
</div>
<p><code>-</code> 의문: <code>np.random.randint(low=7,size=(5,5))</code> 가 좀 이상하다. 사실 <code>np.random.randint(high=7,size=(5,5))</code>가 되어야 맞지 않는가?</p>
<p>-&gt; 저도 그렇게 생각하긴 하는데요, 구현이 이렇게 되어있습니다. 도움말 확인!</p>
<pre><code>Return random integers from the "discrete uniform" distribution of the specified dtype in the "half-open" interval [`low`, `high`). If `high` is None (the default), then results are from [0, `low`).</code></pre>
</section>
<section id="d.-np.random.choice" class="level2">
<h2 class="anchored" data-anchor-id="d.-np.random.choice">D. np.random.choice()</h2>
<p><code>-</code> ver1</p>
<div id="918875b5-d193-4b35-9deb-580ce5b792b6" class="cell" data-tags="[]" data-execution_count="15">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>np.random.choice(<span class="dv">5</span>,<span class="dv">20</span>) <span class="co"># [0,5)에서 20개를 뽑음, 중복허용 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([2, 2, 4, 1, 1, 1, 0, 0, 2, 2, 1, 0, 3, 3, 4, 2, 4, 2, 3, 0])</code></pre>
</div>
</div>
<ul>
<li>이것은 np.random.randint(5,size=(20,)) 와 같은 코드임</li>
</ul>
<p><code>-</code> ver2</p>
<div id="824081a7-fbfe-4a9e-bb38-b5946972bdbb" class="cell" data-tags="[]" data-execution_count="16">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>np.random.choice([<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],<span class="dv">20</span>) <span class="co"># [0,1,2,3]에서 20개를 뽑음, 중복허용</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([0, 0, 2, 0, 3, 3, 0, 1, 3, 1, 0, 2, 3, 2, 0, 0, 0, 3, 0, 1])</code></pre>
</div>
</div>
<div id="6ea70014-9cf6-46a2-acae-06a84342c457" class="cell" data-tags="[]" data-execution_count="17">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>np.random.choice([<span class="st">"apple"</span>,<span class="st">"orange"</span>,<span class="st">"banana"</span>],<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array(['orange', 'banana', 'orange', 'apple', 'apple', 'banana', 'banana',
       'orange', 'orange', 'orange', 'apple', 'banana', 'banana',
       'orange', 'orange', 'apple', 'orange', 'apple', 'banana', 'banana'],
      dtype='&lt;U6')</code></pre>
</div>
</div>
<div id="126f48bc-45f2-4a7e-a41c-10635951ee6a" class="cell" data-tags="[]" data-execution_count="18">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>np.random.choice([<span class="st">"apple"</span>,<span class="st">"orange"</span>,<span class="st">"banana"</span>],<span class="dv">2</span>,replace<span class="op">=</span><span class="va">False</span>) <span class="co"># 중복허용 X </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array(['apple', 'orange'], dtype='&lt;U6')</code></pre>
</div>
</div>
</section>
<section id="e.-통계분포" class="level2">
<h2 class="anchored" data-anchor-id="e.-통계분포">E. 통계분포</h2>
<div id="398de0bd-ca7d-4bdf-9064-45a0107005d7" class="cell" data-tags="[]" data-execution_count="128">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>np.random.binomial(n<span class="op">=</span><span class="dv">10</span>,p<span class="op">=</span><span class="fl">0.2</span>,size<span class="op">=</span><span class="dv">5</span>) <span class="co"># X1, ..., X5 ~ B(10,0.2) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="128">
<pre><code>array([3, 1, 1, 2, 1])</code></pre>
</div>
</div>
<div id="e540f2b2-2917-4945-9b85-ab8818af7372" class="cell" data-tags="[]" data-execution_count="129">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>np.random.normal(loc<span class="op">=</span><span class="dv">10</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span><span class="dv">5</span>) <span class="co"># X1, ..., X5 ~ N(10,4) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="129">
<pre><code>array([10.04176539,  5.41053441,  5.61676057, 13.55882306, 10.78582906])</code></pre>
</div>
</div>
<ul>
<li><code>np.radom.randn(5)*2 + 10</code>와 같은코드</li>
</ul>
<div id="4de3a4d7-e821-4738-b09c-1db98381b426" class="cell" data-tags="[]" data-execution_count="130">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>np.random.uniform(low<span class="op">=</span><span class="dv">2</span>,high<span class="op">=</span><span class="dv">4</span>,size<span class="op">=</span><span class="dv">5</span>) <span class="co"># X1, ..., X5 ~ U(2,4) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="130">
<pre><code>array([2.86669113, 3.71494791, 3.11352312, 2.88052454, 3.79898426])</code></pre>
</div>
</div>
<ul>
<li><code>np.random.rand(5)*2+2</code>와 같은 코드</li>
</ul>
<div id="7ea02568-5000-4dfb-b006-98d671e8d9a7" class="cell" data-tags="[]" data-execution_count="131">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>np.random.poisson(lam<span class="op">=</span><span class="dv">5</span>,size<span class="op">=</span><span class="dv">5</span>) <span class="co"># X1,...,X5 ~ Poi(5) </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="131">
<pre><code>array([ 0, 16,  8,  2,  1])</code></pre>
</div>
</div>
</section>
</section>
<section id="numpy-기타-유용한-기본기능들" class="level1">
<h1>4. <code>numpy</code> – 기타 유용한 기본기능들</h1>
<section id="a.-np.where-np.argwhere" class="level2">
<h2 class="anchored" data-anchor-id="a.-np.where-np.argwhere">A. np.where, np.argwhere</h2>
<p><code>-</code> 1차원</p>
<div id="38ea38d7-632e-423a-a682-9cde66122a43" class="cell" data-tags="[]" data-execution_count="23">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([0, 0, 0, 1, 0])</code></pre>
</div>
</div>
<div id="5ce0b2ee-7d09-4dfd-911c-fc96e56b9399" class="cell" data-tags="[]" data-execution_count="24">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">==</span><span class="dv">1</span>) <span class="co"># 조건 a==1을 만족하는 인덱스를 출력하라!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>(array([3]),)</code></pre>
</div>
</div>
<div id="fcb2632a-f001-475d-8afe-17283b2d9c6e" class="cell" data-tags="[]" data-execution_count="25">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>np.argwhere(a<span class="op">==</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<pre><code>array([[3]])</code></pre>
</div>
</div>
<p><code>-</code> 2차원</p>
<div id="7cf49888-0106-4745-aa3c-cec3ad43cd41" class="cell" data-tags="[]" data-execution_count="26">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.random.randn(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([[ 0.38342049,  1.0841745 ,  1.14277825,  0.30789368],
       [ 0.23778744,  0.35595116, -1.66307542, -1.38277318],
       [-1.92684484, -1.4862163 ,  0.00692519, -0.03488725]])</code></pre>
</div>
</div>
<div id="84b6dcad-8332-468b-8d4c-fc9dfd985666" class="cell" data-tags="[]" data-execution_count="27">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">&lt;</span><span class="dv">0</span>) <span class="co"># 조건을 만족하는 인덱스가 (1,2), (1,3), (2,0), (2,1), (2,3) 이라는 의미</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>(array([1, 1, 2, 2, 2]), array([2, 3, 0, 1, 3]))</code></pre>
</div>
</div>
<div id="31150ee7-76a0-4bf3-ae6b-9697162e5be5" class="cell" data-tags="[]" data-execution_count="28">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>) <span class="co"># 조건을 만족하는 인덱스가 (1,2), (1,3), (2,0), (2,1), (2,3) 이라는 의미</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>array([[1, 2],
       [1, 3],
       [2, 0],
       [2, 1],
       [2, 3]])</code></pre>
</div>
</div>
<div id="ce3407b0-8906-4b83-b163-9c7fe4c8f084" class="cell" data-tags="[]" data-execution_count="29">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>a[np.where(a<span class="op">&lt;</span><span class="dv">0</span>)] <span class="co"># 조건을 만족하는 인덱스가 모두 출력 =&gt; 1차원 array로 출력 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>array([-1.66307542, -1.38277318, -1.92684484, -1.4862163 , -0.03488725])</code></pre>
</div>
</div>
<div id="28a93d8f-115b-433c-88d0-f00df727ecb5" class="cell" data-tags="[]" data-execution_count="30">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>a[np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>)] <span class="co"># 출력불가능</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>IndexError: index 3 is out of bounds for axis 0 with size 3</code></pre>
</div>
</div>
<div id="de4f7791-a0f3-4dba-8806-de2a55d888c0" class="cell" data-tags="[]" data-execution_count="31">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>a[np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>)[<span class="dv">0</span>][<span class="dv">0</span>],np.argwhere(a<span class="op">&lt;</span><span class="dv">0</span>)[<span class="dv">0</span>][<span class="dv">1</span>]] <span class="co"># 어거지로 출력할수는 있음 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>-1.6630754187023522</code></pre>
</div>
</div>
<p><code>-</code> np.where의 특수기능</p>
<div id="e5437113-fdf6-4937-9b90-4b7fcd14963f" class="cell" data-tags="[]" data-execution_count="32">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>) </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.random.randn(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>) </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[ 0.38342049,  1.0841745 ,  1.14277825,  0.30789368],
       [ 0.23778744,  0.35595116, -1.66307542, -1.38277318],
       [-1.92684484, -1.4862163 ,  0.00692519, -0.03488725]])</code></pre>
</div>
</div>
<div id="7bc7d155-eae0-4372-9b23-c6af4ad52d89" class="cell" data-tags="[]" data-execution_count="33">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,a) <span class="co"># a&lt;0을 체크 =&gt; 조건에 맞으면 0 =&gt; 조건에 안맞으면 a </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([[0.38342049, 1.0841745 , 1.14277825, 0.30789368],
       [0.23778744, 0.35595116, 0.        , 0.        ],
       [0.        , 0.        , 0.00692519, 0.        ]])</code></pre>
</div>
</div>
<div id="d2dc2268-6406-469f-8792-7ea5c6ea1469" class="cell" data-tags="[]" data-execution_count="34">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>np.where(a<span class="op">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># a&lt;0을 체크 =&gt; 조건에 맞으면 0 =&gt; 조건에 안맞으면 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[1, 1, 1, 1],
       [1, 1, 0, 0],
       [0, 0, 1, 0]])</code></pre>
</div>
</div>
<p><code>-</code> 요약 - np.where: 인덱스의 좌표를 읽는 가독성은 떨어짐. 그런데 조건에 맞는 원소를 출력하거나 처리하는 (특수기능) 목적으로는 좋은 함수<br>
- np.argwhere: 인덱스의 좌표를 읽는 가독성은 좋은 편임. 그런데 조건에 맞는 원소를 출력하거나 처리하는 기능은 떨어짐 – 쓰레기</p>
</section>
<section id="b.-인덱싱고급" class="level2">
<h2 class="anchored" data-anchor-id="b.-인덱싱고급">B. 인덱싱고급</h2>
<p><code>-</code> 원래 a는 2d array</p>
<div id="0c6bdd8c-37c7-4bce-a949-40e43ad63737" class="cell" data-tags="[]" data-execution_count="35">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<p><code>-</code> 경우1: 인덱싱 결과가 1d array로 나올수 있음</p>
<div id="76bdde53-e62a-46b3-9128-2e3c38c22721" class="cell" data-tags="[]" data-execution_count="36">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>,:] <span class="co"># 인덱싱의 결과 축의 갯수가 바뀐다! 2d array -&gt; 1d array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([0, 1, 2, 3])</code></pre>
</div>
</div>
<p><code>-</code> 경우2: 물론 인덱싱 결과가 2d array로 나올 수도 있음</p>
<div id="aa738cda-da1f-4e43-a1aa-1b8bc93a95f9" class="cell" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">1</span>],:] <span class="co"># 이것은 축의 숫자가 유지된다. 2d array -&gt; 2d array </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>array([[0, 1, 2, 3],
       [4, 5, 6, 7]])</code></pre>
</div>
</div>
<p><code>-</code> 경우1의 상황에서도 축의 갯수를 유지하면서 인덱싱하려면?</p>
<div id="c7146ad0-e17e-4aae-8eaf-480198b59773" class="cell" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>],:] <span class="co"># 이번에는 인덱싱의 결과 축의 갯수가 유지된다! 2d array -&gt; 2d array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>array([[0, 1, 2, 3]])</code></pre>
</div>
</div>
<div id="63ed687e-f8b2-4296-8be7-2d817cf8d073" class="cell" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>a[:,[<span class="dv">0</span>]] <span class="co">#</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>array([[0],
       [4],
       [8]])</code></pre>
</div>
</div>
<p><code>-</code> 미묘한 차이를 이해할것</p>
<div id="3a6ac08a-5c42-456f-bf9d-3430d491d021" class="cell" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>,:], a[[<span class="dv">0</span>],:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>(array([0, 1, 2, 3]), array([[0, 1, 2, 3]]))</code></pre>
</div>
</div>
<div id="84fbedee-0b15-44c2-88a6-938132209829" class="cell" data-tags="[]" data-execution_count="41">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>a[:,<span class="dv">0</span>], a[:,[<span class="dv">0</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>(array([0, 4, 8]),
 array([[0],
        [4],
        [8]]))</code></pre>
</div>
</div>
</section>
<section id="c.-np.ix_" class="level2">
<h2 class="anchored" data-anchor-id="c.-np.ix_">C. np.ix_</h2>
<p><code>-</code> 아래의 인덱싱을 비교하자.</p>
<div id="5006cbf2-8b9b-49e5-8b2c-2cd77bc9ee8c" class="cell" data-tags="[]" data-execution_count="141">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">12</span>).reshape(<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="141">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<div id="f8f63cc4-d28d-4731-8d4c-b9e77590b638" class="cell" data-tags="[]" data-execution_count="142">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>:<span class="dv">2</span>,<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="142">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
<div id="d58f33f6-b1c4-4e72-95cd-6e3c1542961c" class="cell" data-tags="[]" data-execution_count="143">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">1</span>],<span class="dv">0</span>:<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="143">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
<div id="eee17b21-f4de-478d-bcc9-fc9bc67eb68c" class="cell" data-tags="[]" data-execution_count="144">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>a[<span class="dv">0</span>:<span class="dv">2</span>,[<span class="dv">0</span>,<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="144">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
<p><code>-</code> 언뜻 생각하면 위의 결과와 <code>a[[0,1],[0,1]]</code>는 결과가 동일할 것 같다.</p>
<div id="7b077794-3ac1-4614-98d5-a0d1bb9df60a" class="cell" data-tags="[]" data-execution_count="140">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="140">
<pre><code>array([0, 5])</code></pre>
</div>
</div>
<ul>
<li>실제로는 [a[0,0],a[1,1]]이 array로 나옴</li>
</ul>
<p><code>-</code> 사실 np.where에서 이미 관찰하였음</p>
<div id="1d1f1159-dc78-4571-b16f-bc82c81a12b3" class="cell" data-tags="[]" data-execution_count="47">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])</code></pre>
</div>
</div>
<div id="ff32ff6d-2649-493c-b94b-e89ba435c4e3" class="cell" data-tags="[]" data-execution_count="48">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>np.where(a <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>(array([0, 1, 2]), array([0, 1, 2]))</code></pre>
</div>
</div>
<div id="dc322946-a842-47f3-b50b-a3d1599796e9" class="cell" data-tags="[]" data-execution_count="49">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>a[np.where(a <span class="op">%</span> <span class="dv">5</span> <span class="op">==</span><span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>array([ 0,  5, 10])</code></pre>
</div>
</div>
<div id="0575c16c-697d-45e0-89af-5e4328618078" class="cell" data-tags="[]" data-execution_count="50">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>a[[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>],[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>array([ 0,  5, 10])</code></pre>
</div>
</div>
<p><code>-</code> a[[0,1],[0,1]]이 a[0:2,0:2]를 의미하게 하려면 아래와 같이 하면 된다.</p>
<div id="0d05c55a-394a-4b4c-b0c1-2d0d7c640df4" class="cell" data-tags="[]" data-execution_count="51">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>a[np.ix_([<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>])]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>array([[0, 1],
       [4, 5]])</code></pre>
</div>
</div>
</section>
<section id="d.-note-1-메소드-도움말-확인하기" class="level2">
<h2 class="anchored" data-anchor-id="d.-note-1-메소드-도움말-확인하기">D. note 1: 메소드 도움말 확인하기</h2>
<p><code>-</code> numpy서 <code>sum</code>을 수행하는 2가지 방식</p>
<ul>
<li>np.sum(a)</li>
<li>a.sum()</li>
</ul>
<div id="7184d255-100a-4f40-b578-6ba99877ad96" class="cell" data-tags="[]" data-execution_count="52">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>])</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>array([1, 2, 3, 4, 5])</code></pre>
</div>
</div>
<div id="2cd506c8-37c4-41b4-9da8-41c6b5ecbb26" class="cell" data-tags="[]" data-execution_count="53">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>15</code></pre>
</div>
</div>
<div id="5f99213f-7839-44d2-93bb-20d307e5f068" class="cell" data-tags="[]" data-execution_count="54">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="bu">sum</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>15</code></pre>
</div>
</div>
<p><code>-</code> 넘파이에서 <code>a.sum()</code>에 대한 도움말은 보통 <code>np.sum()</code>에 자세히 나와있음. <span class="math inline">\(\to\)</span> <code>np.sum()</code>의 도움말을 확인하고 <code>np.sum(a)</code>와 <code>a.sum()</code>이 동일함을 이용하여 <code>a.sum()</code>의 사용법을 미루어 유추해야함.</p>
<div id="d7acd5a7-e5ba-420b-aecc-a4802e7a887b" class="cell" data-tags="[]" data-execution_count="55">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>a.<span class="bu">sum</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Docstring:</span>
a.sum(axis=None, dtype=None, out=None, keepdims=False, initial=0, where=True)
Return the sum of the array elements over the given axis.
Refer to `numpy.sum` for full documentation.
See Also
--------
numpy.sum : equivalent function
<span class="ansi-red-fg">Type:</span>      builtin_function_or_method</pre>
</div>
</div>
</div>
<div id="28752688-86cf-450f-83d7-85a8cf9b045e" class="cell" data-tags="[]" data-execution_count="56">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>?</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Signature:</span>      
np<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span>
    a<span class="ansi-blue-fg">,</span>
    axis<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    dtype<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    out<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span>
    keepdims<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>no value<span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    initial<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>no value<span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
    where<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&lt;</span>no value<span class="ansi-blue-fg">&gt;</span><span class="ansi-blue-fg">,</span>
<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Call signature:</span>  np<span class="ansi-blue-fg">.</span>sum<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Type:</span>            _ArrayFunctionDispatcher
<span class="ansi-red-fg">String form:</span>     &lt;function sum at 0x7fc648265bd0&gt;
<span class="ansi-red-fg">File:</span>            ~/anaconda3/envs/r/lib/python3.10/site-packages/numpy/core/fromnumeric.py
<span class="ansi-red-fg">Docstring:</span>      
Sum of array elements over a given axis.
Parameters
----------
a : array_like
    Elements to sum.
axis : None or int or tuple of ints, optional
    Axis or axes along which a sum is performed.  The default,
    axis=None, will sum all of the elements of the input array.  If
    axis is negative it counts from the last to the first axis.
    .. versionadded:: 1.7.0
    If axis is a tuple of ints, a sum is performed on all of the axes
    specified in the tuple instead of a single axis or all the axes as
    before.
dtype : dtype, optional
    The type of the returned array and of the accumulator in which the
    elements are summed.  The dtype of `a` is used by default unless `a`
    has an integer dtype of less precision than the default platform
    integer.  In that case, if `a` is signed then the platform integer
    is used while if `a` is unsigned then an unsigned integer of the
    same precision as the platform integer is used.
out : ndarray, optional
    Alternative output array in which to place the result. It must have
    the same shape as the expected output, but the type of the output
    values will be cast if necessary.
keepdims : bool, optional
    If this is set to True, the axes which are reduced are left
    in the result as dimensions with size one. With this option,
    the result will broadcast correctly against the input array.
    If the default value is passed, then `keepdims` will not be
    passed through to the `sum` method of sub-classes of
    `ndarray`, however any non-default value will be.  If the
    sub-class' method does not implement `keepdims` any
    exceptions will be raised.
initial : scalar, optional
    Starting value for the sum. See `~numpy.ufunc.reduce` for details.
    .. versionadded:: 1.15.0
where : array_like of bool, optional
    Elements to include in the sum. See `~numpy.ufunc.reduce` for details.
    .. versionadded:: 1.17.0
Returns
-------
sum_along_axis : ndarray
    An array with the same shape as `a`, with the specified
    axis removed.   If `a` is a 0-d array, or if `axis` is None, a scalar
    is returned.  If an output array is specified, a reference to
    `out` is returned.
See Also
--------
ndarray.sum : Equivalent method.
add.reduce : Equivalent functionality of `add`.
cumsum : Cumulative sum of array elements.
trapz : Integration of array values using the composite trapezoidal rule.
mean, average
Notes
-----
Arithmetic is modular when using integer types, and no error is
raised on overflow.
The sum of an empty array is the neutral element 0:
&gt;&gt;&gt; np.sum([])
0.0
For floating point numbers the numerical precision of sum (and
``np.add.reduce``) is in general limited by directly adding each number
individually to the result causing rounding errors in every step.
However, often numpy will use a  numerically better approach (partial
pairwise summation) leading to improved precision in many use-cases.
This improved precision is always provided when no ``axis`` is given.
When ``axis`` is given, it will depend on which axis is summed.
Technically, to provide the best speed possible, the improved precision
is only used when the summation is along the fast axis in memory.
Note that the exact precision may vary depending on other parameters.
In contrast to NumPy, Python's ``math.fsum`` function uses a slower but
more precise approach to summation.
Especially when summing a large number of lower precision floating point
numbers, such as ``float32``, numerical errors can become significant.
In such cases it can be advisable to use `dtype="float64"` to use a higher
precision for the output.
Examples
--------
&gt;&gt;&gt; np.sum([0.5, 1.5])
2.0
&gt;&gt;&gt; np.sum([0.5, 0.7, 0.2, 1.5], dtype=np.int32)
1
&gt;&gt;&gt; np.sum([[0, 1], [0, 5]])
6
&gt;&gt;&gt; np.sum([[0, 1], [0, 5]], axis=0)
array([0, 6])
&gt;&gt;&gt; np.sum([[0, 1], [0, 5]], axis=1)
array([1, 5])
&gt;&gt;&gt; np.sum([[0, 1], [np.nan, 5]], where=[False, True], axis=1)
array([1., 5.])
If the accumulator is too small, overflow occurs:
&gt;&gt;&gt; np.ones(128, dtype=np.int8).sum(dtype=np.int8)
-128
You can also start the sum with a value other than zero:
&gt;&gt;&gt; np.sum([10], initial=5)
15
<span class="ansi-red-fg">Class docstring:</span>
Class to wrap functions with checks for __array_function__ overrides.
All arguments are required, and can only be passed by position.
Parameters
----------
dispatcher : function or None
    The dispatcher function that returns a single sequence-like object
    of all arguments relevant.  It must have the same signature (except
    the default values) as the actual implementation.
    If ``None``, this is a ``like=`` dispatcher and the
    ``_ArrayFunctionDispatcher`` must be called with ``like`` as the
    first (additional and positional) argument.
implementation : function
    Function that implements the operation on NumPy arrays without
    overrides.  Arguments passed calling the ``_ArrayFunctionDispatcher``
    will be forwarded to this (and the ``dispatcher``) as if using
    ``*args, **kwargs``.
Attributes
----------
_implementation : function
    The original implementation passed in.</pre>
</div>
</div>
</div>
</section>
<section id="e.-hstack-vstack" class="level2">
<h2 class="anchored" data-anchor-id="e.-hstack-vstack">E. hstack, vstack</h2>
<p><code>-</code> hstack, vstack 를 쓰는 사람도 있다.</p>
<div id="120e8a98-3eee-49e5-8789-8b5d8a6f4db7" class="cell" data-tags="[]" data-execution_count="57">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">6</span>) </span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="92b724e4-13a5-480d-b778-e0a658d1eaf6" class="cell" data-tags="[]" data-execution_count="58">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>np.vstack([a,b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 0, -1, -2, -3, -4, -5]])</code></pre>
</div>
</div>
<div id="2c14b8db-d374-4987-9d5f-a34aa4240692" class="cell" data-tags="[]" data-execution_count="59">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>np.stack([a,b],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>array([[ 0,  1,  2,  3,  4,  5],
       [ 0, -1, -2, -3, -4, -5]])</code></pre>
</div>
</div>
<div id="6ea3751b-e3b9-4547-878e-6ed159ce7503" class="cell" data-tags="[]" data-execution_count="60">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>np.hstack([a,b])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  0, -1, -2, -3, -4, -5])</code></pre>
</div>
</div>
<div id="fc136654-19b2-40ab-bc6c-498f984b31b4" class="cell" data-tags="[]" data-execution_count="61">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  0, -1, -2, -3, -4, -5])</code></pre>
</div>
</div>
</section>
<section id="f.-append" class="level2">
<h2 class="anchored" data-anchor-id="f.-append">F. append</h2>
<p><code>-</code> 기능1: reshape(-1) + concat</p>
<div id="54b999d7-c869-4ebc-8acf-eca08e810164" class="cell" data-tags="[]" data-execution_count="62">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">30</span>).reshape(<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=</span> <span class="op">-</span>np.arange(<span class="dv">8</span>).reshape(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="4afd49df-7b2f-49a0-994e-2da9c5e1af28" class="cell" data-tags="[]" data-execution_count="63">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>a.shape, b.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>((5, 6), (2, 2, 2))</code></pre>
</div>
</div>
<div id="38c92cda-6ed7-446d-aa3f-53c77730ba07" class="cell" data-tags="[]" data-execution_count="64">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>np.append(a,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,  0, -1, -2, -3,
       -4, -5, -6, -7])</code></pre>
</div>
</div>
<div id="64330644-a667-4401-a134-1b67d16033a2" class="cell" data-tags="[]" data-execution_count="65">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a.reshape(<span class="op">-</span><span class="dv">1</span>),b.reshape(<span class="op">-</span><span class="dv">1</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29,  0, -1, -2, -3,
       -4, -5, -6, -7])</code></pre>
</div>
</div>
<p><code>-</code> 기능2: concat</p>
<div id="f9122c7d-fa1e-44a5-abf5-a48ea0de34ba" class="cell" data-tags="[]" data-execution_count="66">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="aeff3a19-c481-454d-944b-bd5357733e87" class="cell" data-tags="[]" data-execution_count="67">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>a.shape,b.shape, np.append(a,b,axis<span class="op">=</span><span class="dv">0</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>((2, 3, 4), (2, 3, 4), (4, 3, 4))</code></pre>
</div>
</div>
<div id="5247a5f9-ba77-4ed0-9371-7fd1e71d38c9" class="cell" data-tags="[]" data-execution_count="68">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>a.shape,b.shape, np.append(a,b,axis<span class="op">=</span><span class="dv">1</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 6, 4))</code></pre>
</div>
</div>
<div id="14599095-9e80-4783-9ef1-a571ee9a1751" class="cell" data-tags="[]" data-execution_count="69">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>a.shape,b.shape, np.append(a,b,axis<span class="op">=</span><span class="dv">2</span>).shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>((2, 3, 4), (2, 3, 4), (2, 3, 8))</code></pre>
</div>
</div>
<p><code>-</code> concat과의 차이? – append는 2개만 가능</p>
<div id="252ed7e7-e226-4239-ba88-97c482dcfa9a" class="cell" data-tags="[]" data-execution_count="145">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>b<span class="op">=-</span>a</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>c<span class="op">=</span><span class="dv">2</span><span class="op">*</span>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="fb3aa4d1-0c58-45eb-bef9-1274b1693767" class="cell" data-tags="[]" data-execution_count="147">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>np.append(a,b,c,axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>TypeError: append() got multiple values for argument 'axis'</code></pre>
</div>
</div>
<div id="c5eeecda-c4b7-4293-80c0-e68f31ed2da1" class="cell" data-tags="[]" data-execution_count="148">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>np.concatenate([a,b,c],axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="148">
<pre><code>array([[[  0,   1,   2,   3],
        [  4,   5,   6,   7],
        [  8,   9,  10,  11]],

       [[ 12,  13,  14,  15],
        [ 16,  17,  18,  19],
        [ 20,  21,  22,  23]],

       [[  0,  -1,  -2,  -3],
        [ -4,  -5,  -6,  -7],
        [ -8,  -9, -10, -11]],

       [[-12, -13, -14, -15],
        [-16, -17, -18, -19],
        [-20, -21, -22, -23]],

       [[  0,   2,   4,   6],
        [  8,  10,  12,  14],
        [ 16,  18,  20,  22]],

       [[ 24,  26,  28,  30],
        [ 32,  34,  36,  38],
        [ 40,  42,  44,  46]]])</code></pre>
</div>
</div>
</section>
<section id="g.-ravel-flatten" class="level2">
<h2 class="anchored" data-anchor-id="g.-ravel-flatten">G. ravel, flatten</h2>
<div id="f07c67f3-7323-43d1-be6f-77d3d0e08c30" class="cell" data-tags="[]" data-execution_count="73">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>np.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">3</span><span class="op">*</span><span class="dv">4</span>).reshape(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]],

       [[12, 13, 14, 15],
        [16, 17, 18, 19],
        [20, 21, 22, 23]]])</code></pre>
</div>
</div>
<div id="7a56379f-ce7c-4669-83ab-c20f7f0b8052" class="cell" data-tags="[]" data-execution_count="74">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a>a.reshape(<span class="op">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
<div id="4ee2ce2c-a60e-453d-b7b5-3f151066893a" class="cell" data-tags="[]" data-execution_count="75">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>a.ravel()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
<div id="8319739b-461d-4f53-8085-ebf8381e7e39" class="cell" data-tags="[]" data-execution_count="76">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>a.flatten()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16,
       17, 18, 19, 20, 21, 22, 23])</code></pre>
</div>
</div>
</section>
<section id="h.-통계관련함수들" class="level2">
<h2 class="anchored" data-anchor-id="h.-통계관련함수들">H. 통계관련함수들</h2>
<p><code>-</code> 평균, 중앙값, 표준편차, 분산</p>
<div id="0b4285ee-a1a4-47eb-bf2a-1da0e4cf58af" class="cell" data-tags="[]" data-execution_count="85">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.random.normal(loc<span class="op">=</span><span class="dv">0</span>,scale<span class="op">=</span><span class="dv">2</span>,size<span class="op">=</span>(<span class="dv">100</span>,))</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>array([-1.12093037,  2.03228998,  0.97607763, -1.95129947, -1.49794935,
       -2.69582142,  6.26294142,  0.17772869,  0.88248101, -0.0987605 ,
       -2.20172938,  1.57977467, -3.70228648,  3.62666243,  0.35655652,
        2.24552797,  1.82730641, -0.27324478,  2.96368325,  2.36722536,
        1.00283717,  2.25966997,  0.74019075,  1.19192351,  2.70918979,
        1.56791667, -3.9192988 ,  0.51262046,  2.1701658 ,  1.45665188,
       -0.95216879, -0.78855745, -2.01741917, -0.93273601, -1.01042306,
       -0.03667253,  0.4746618 , -2.55669289,  1.10739444,  1.15177071,
       -2.96111607, -1.97698346, -1.62882279, -0.73025042, -4.41933873,
        2.67699686, -1.49483629,  0.00726669, -0.91481464, -3.34965693,
       -1.53808928,  0.45192716,  0.62408358,  4.00499954, -0.44609797,
       -2.58265527, -3.66717305,  2.10773738, -0.51106569,  2.29246892,
        2.79998629, -3.03791044,  1.89561133,  0.19501627,  0.72806721,
       -1.50778943,  0.42474352,  0.12223567, -1.04890662, -1.9739829 ,
       -1.4261672 , -0.20406325, -0.23939128,  1.41477338, -2.25923024,
        1.17742253, -2.00670917,  0.1468111 , -0.57698109,  3.52781535,
        1.71060134,  2.31381344, -1.06125884, -1.73359866,  0.21638374,
        0.92504343,  2.50727404,  1.3510571 ,  0.62009821, -1.77908053,
        1.85646061,  0.66264999, -1.64292395, -0.60274377, -1.1585586 ,
       -0.66907802,  2.38660429,  1.41138093, -2.3059048 , -0.53353575])</code></pre>
</div>
</div>
<div id="a290f5aa-b92d-4a69-b0dd-9f078037546e" class="cell" data-tags="[]" data-execution_count="86">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>np.mean(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>0.04457872598775192</code></pre>
</div>
</div>
<div id="02a06057-fa7a-4ede-b787-b43d42d7366f" class="cell" data-tags="[]" data-execution_count="87">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>np.median(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>0.13452338307274175</code></pre>
</div>
</div>
<div id="18720925-c851-4cda-9c2b-198ecda8c784" class="cell" data-tags="[]" data-execution_count="88">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>np.std(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>1.957280879505603</code></pre>
</div>
</div>
<div id="a095803e-956f-41ab-b5cb-cf2c2d26a21c" class="cell" data-tags="[]" data-execution_count="89">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>np.var(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>3.8309484412782266</code></pre>
</div>
</div>
<p><code>-</code> corr matrix, cov matrix</p>
<div id="e60cfda7-78a7-45af-b3ff-e35d1e092a2a" class="cell" data-tags="[]" data-execution_count="90">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">43052</span>) </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> np.random.randn(<span class="dv">10000</span>)</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> np.random.randn(<span class="dv">10000</span>)<span class="op">*</span><span class="dv">2</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>z<span class="op">=</span> np.random.randn(<span class="dv">10000</span>)<span class="op">*</span><span class="fl">0.5</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="377bc987-3d31-4d94-b221-09aedefa69e1" class="cell" data-tags="[]" data-execution_count="91">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>np.corrcoef([x,y,z]).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>array([[ 1.  , -0.01,  0.01],
       [-0.01,  1.  ,  0.  ],
       [ 0.01,  0.  ,  1.  ]])</code></pre>
</div>
</div>
<div id="15b602c5-8a56-4fcc-9dc8-a2dc64ae4224" class="cell" data-tags="[]" data-execution_count="92">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>np.cov([x,y,z]).<span class="bu">round</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>array([[ 0.99, -0.02,  0.  ],
       [-0.02,  4.06,  0.  ],
       [ 0.  ,  0.  ,  0.25]])</code></pre>
</div>
</div>
</section>
<section id="i.-dtype" class="level2">
<h2 class="anchored" data-anchor-id="i.-dtype">I. dtype</h2>
<p><code>-</code> np.array는 항상 dtype이 있다.</p>
<div id="dfef39c8-0034-4e42-8f4f-85c4d2673c78" class="cell" data-tags="[]" data-execution_count="93">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="50f4d425-d5c8-4760-a2d8-edc3bb49e728" class="cell" data-tags="[]" data-execution_count="94">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<div id="1840a6df-94a6-4a0b-90bd-480323a4b764" class="cell" data-tags="[]" data-execution_count="95">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="fl">1.0</span>,<span class="fl">2.0</span>,<span class="fl">3.0</span>])</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>array([1., 2., 3.])</code></pre>
</div>
</div>
<div id="efe8f189-72a7-4325-813c-c217697eb460" class="cell" data-tags="[]" data-execution_count="96">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>dtype('float64')</code></pre>
</div>
</div>
<p><code>-</code> 같은 int라도 int16,int32,int64으로 나누어진다.</p>
<div id="f710c752-9829-444a-911a-c5e6cf7cf0a9" class="cell" data-tags="[]" data-execution_count="97">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],dtype<span class="op">=</span>np.int32)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>array([1, 2, 3], dtype=int32)</code></pre>
</div>
</div>
<div id="68790a87-761f-4389-80c7-adf7a69371b0" class="cell" data-tags="[]" data-execution_count="98">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>dtype('int32')</code></pre>
</div>
</div>
<p><code>-</code> float도 float16, float32, float64가 있다.</p>
<div id="021f9860-2a19-476a-9498-afcb35dd89ac" class="cell" data-tags="[]" data-execution_count="99">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],dtype<span class="op">=</span>np.float32)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>array([1., 2., 3.], dtype=float32)</code></pre>
</div>
</div>
<p><code>-</code> 데이터타입은 아래와 같은 방법으로 변환시킬 수 있다.</p>
<div id="9f87d580-5c30-4b45-9eb0-877accdef795" class="cell" data-tags="[]" data-execution_count="100">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],dtype<span class="op">=</span>np.int32)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>array([1, 2, 3], dtype=int32)</code></pre>
</div>
</div>
<div id="bdc3dd66-8572-433e-8689-45998ecd4166" class="cell" data-tags="[]" data-execution_count="101">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span>a.astype(dtype<span class="op">=</span>np.int64)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>array([1, 2, 3])</code></pre>
</div>
</div>
<div id="ca28d5fb-e0af-4dda-a3f4-4d28d4e80ff2" class="cell" data-tags="[]" data-execution_count="102">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>a.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="102">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<p><code>-</code> 문자열의 경우</p>
<div id="a7a9733d-0855-4b88-ac9d-299e44ed3b5a" class="cell" data-tags="[]" data-execution_count="103">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>array(['a', 'b', 'c'], dtype='&lt;U1')</code></pre>
</div>
</div>
<div id="70a8f9aa-9113-46e8-93f7-fb781a0a4d4b" class="cell" data-tags="[]" data-execution_count="104">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'ab'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>array(['ab', 'b', 'c'], dtype='&lt;U2')</code></pre>
</div>
</div>
<div id="29048948-dc01-421d-8fd5-27f407bb34f8" class="cell" data-tags="[]" data-execution_count="105">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="st">'abasdf'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>array(['abasdf', 'b', 'c'], dtype='&lt;U6')</code></pre>
</div>
</div>
<p><code>-</code> 문자열+숫자혼합 =&gt; 문자열로 통일</p>
<div id="d54763fd-db09-4012-80ba-e6e328acea7b" class="cell" data-tags="[]" data-execution_count="106">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([<span class="st">'a'</span>,<span class="dv">1</span>])</span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>array(['a', '1'], dtype='&lt;U21')</code></pre>
</div>
</div>
<div id="909069b9-27c4-4c70-98b6-457d98809eae" class="cell" data-tags="[]" data-execution_count="149">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([<span class="st">'a'</span>,<span class="fl">1.0</span>])</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="149">
<pre><code>array(['a', '1.0'], dtype='&lt;U32')</code></pre>
</div>
</div>
<p><code>-</code> 문자열을 숫자로 전환</p>
<div id="79794596-f78d-4c78-ae39-210bcb9ad193" class="cell" data-tags="[]" data-execution_count="153">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>a<span class="op">=</span> np.array([[<span class="st">'a'</span>,<span class="fl">1.0</span>],[<span class="st">'b'</span>,<span class="fl">2.0</span>]])</span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="153">
<pre><code>array([['a', '1.0'],
       ['b', '2.0']], dtype='&lt;U32')</code></pre>
</div>
</div>
<div id="aca3f935-ee39-45f8-9e56-95b5579b5281" class="cell" data-tags="[]" data-execution_count="157">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a>a[:,<span class="dv">1</span>].astype(np.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="157">
<pre><code>array([1., 2.])</code></pre>
</div>
</div>
</section>
<section id="j.-브로드캐스팅과-시간측정" class="level2">
<h2 class="anchored" data-anchor-id="j.-브로드캐스팅과-시간측정">J. 브로드캐스팅과 시간측정</h2>
<p>(예비학습)</p>
<div id="6716f977-b098-4640-bafd-8f397753c631" class="cell" data-tags="[]" data-execution_count="110">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="00b83b6c-69d9-4524-bb2e-1b4c3fabf56a" class="cell" data-tags="[]" data-execution_count="111">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>time.time()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="84caef3f-2739-4f0b-a7ee-ab7374c98c99" class="cell" data-tags="[]" data-execution_count="112">
<div class="sourceCode cell-code" id="cb199"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb199-1"><a href="#cb199-1" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span>time.time()</span>
<span id="cb199-2"><a href="#cb199-2" aria-hidden="true" tabindex="-1"></a>t2<span class="op">-</span>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>1.415555715560913</code></pre>
</div>
</div>
<p>예비학습끝</p>
<p><strong>(예제)</strong> x=[0,1,2,3,4] 인 벡터가 있다고 하자. (i,j)의 원소가 <code>(x[i]-x[j])**2</code> 을 의미하는 <span class="math inline">\(5\times 5\)</span> 매트릭스를 구하라.</p>
<p>(풀이1)</p>
<div id="6118f74a-ceae-4d58-a832-cf01641ae94f" class="cell" data-tags="[]" data-execution_count="113">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">5</span>))</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>array([0, 1, 2, 3, 4])</code></pre>
</div>
</div>
<div id="a54b5957-ce00-48c8-bd94-3cb25c8bcdeb" class="cell" data-tags="[]" data-execution_count="114">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> np.zeros([<span class="dv">5</span>,<span class="dv">5</span>])</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>array([[0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.],
       [0., 0., 0., 0., 0.]])</code></pre>
</div>
</div>
<div id="e8471c65-a5f2-4f70-b68b-fdc2b9a5e621" class="cell" data-tags="[]" data-execution_count="115">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb205-3"><a href="#cb205-3" aria-hidden="true" tabindex="-1"></a>        dist[i,j]<span class="op">=</span>(x[i]<span class="op">-</span>x[j])<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="eb78cb03-d096-4ca1-bbea-e01ef90d9e6c" class="cell" data-tags="[]" data-execution_count="116">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>array([[ 0.,  1.,  4.,  9., 16.],
       [ 1.,  0.,  1.,  4.,  9.],
       [ 4.,  1.,  0.,  1.,  4.],
       [ 9.,  4.,  1.,  0.,  1.],
       [16.,  9.,  4.,  1.,  0.]])</code></pre>
</div>
</div>
<p>(풀이2)</p>
<div id="f0d32dc1-f31f-4300-bb0c-8eb8c3cbbd1b" class="cell" data-tags="[]" data-execution_count="117">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>x1<span class="op">=</span>x.reshape(<span class="dv">5</span>,<span class="dv">1</span>).astype(dtype<span class="op">=</span>np.float64)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>x2<span class="op">=</span>x.reshape(<span class="dv">1</span>,<span class="dv">5</span>).astype(dtype<span class="op">=</span>np.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="3865ef3c-45bb-4417-901c-d174b1ebee82" class="cell" data-tags="[]" data-execution_count="118">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>x1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>array([[0.],
       [1.],
       [2.],
       [3.],
       [4.]])</code></pre>
</div>
</div>
<div id="52be190b-bde9-4674-b17c-91df5323c77a" class="cell" data-tags="[]" data-execution_count="119">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>array([[0., 1., 2., 3., 4.]])</code></pre>
</div>
</div>
<div id="2d4870fc-ccbf-4aa3-bc16-33b629dda68e" class="cell" data-tags="[]" data-execution_count="120">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a>x1<span class="op">-</span>x2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="120">
<pre><code>array([[ 0., -1., -2., -3., -4.],
       [ 1.,  0., -1., -2., -3.],
       [ 2.,  1.,  0., -1., -2.],
       [ 3.,  2.,  1.,  0., -1.],
       [ 4.,  3.,  2.,  1.,  0.]])</code></pre>
</div>
</div>
<ul>
<li>(i,j)th element = x[i]-x[j]</li>
</ul>
<div id="1d554121-9eb5-4389-9622-91cc70c5efc8" class="cell" data-tags="[]" data-execution_count="121">
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>(x1<span class="op">-</span>x2)<span class="op">**</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="121">
<pre><code>array([[ 0.,  1.,  4.,  9., 16.],
       [ 1.,  0.,  1.,  4.,  9.],
       [ 4.,  1.,  0.,  1.,  4.],
       [ 9.,  4.,  1.,  0.,  1.],
       [16.,  9.,  4.,  1.,  0.]])</code></pre>
</div>
</div>
<hr>
<div id="3f185a1a-3f92-4555-895e-a0063b3f6e03" class="cell" data-tags="[]" data-execution_count="122">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>np.array(<span class="bu">range</span>(<span class="dv">10000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="43b5f285-a0fd-442e-b855-be15852ce9a8" class="cell" data-tags="[]" data-execution_count="123">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>dist <span class="op">=</span> np.zeros([<span class="dv">10000</span>,<span class="dv">10000</span>])</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>dist</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>array([[0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       ...,
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.],
       [0., 0., 0., ..., 0., 0., 0.]])</code></pre>
</div>
</div>
<div id="58b03a1a-1702-4996-9b1a-3e3ea18f0f97" class="cell" data-tags="[]" data-execution_count="124">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>time.time()</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>):</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>        dist[i,j]<span class="op">=</span>(y[i]<span class="op">-</span>y[j])<span class="op">**</span><span class="dv">2</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span>time.time()</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>t2<span class="op">-</span>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>38.211220264434814</code></pre>
</div>
</div>
<div id="d0c29b5a-0383-4aa0-a341-81e8eb29825e" class="cell" data-tags="[]" data-execution_count="125">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>y1<span class="op">=</span>y.reshape(<span class="dv">10000</span>,<span class="dv">1</span>).astype(np.float64)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>y2<span class="op">=</span>y.reshape(<span class="dv">1</span>,<span class="dv">10000</span>).astype(np.float64)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c4f8c60b-e921-4629-95a2-94de26b09cb2" class="cell" data-tags="[]" data-execution_count="126">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>time.time()</span>
<span id="cb223-2"><a href="#cb223-2" aria-hidden="true" tabindex="-1"></a>dist2<span class="op">=</span>(y1<span class="op">-</span>y2)<span class="op">**</span><span class="dv">2</span></span>
<span id="cb223-3"><a href="#cb223-3" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span>time.time()</span>
<span id="cb223-4"><a href="#cb223-4" aria-hidden="true" tabindex="-1"></a>t2<span class="op">-</span>t1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="126">
<pre><code>0.12482023239135742</code></pre>
</div>
</div>
<div id="da81e845-7607-4720-9924-5a661f34571e" class="cell" data-tags="[]" data-execution_count="127">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>(dist<span class="op">-</span>dist2).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="127">
<pre><code>0.0</code></pre>
</div>
</div>
</section>
</section>
<section id="numpy의-활용" class="level1">
<h1>5. <code>numpy</code>의 활용</h1>
<section id="a.-이미지-자료처리" class="level2">
<h2 class="anchored" data-anchor-id="a.-이미지-자료처리">A. 이미지 자료처리</h2>
<p><strong><em><code>###</code> – 예비학습 이미지 자료의 이해</em></strong></p>
<p><code>-</code> <code>plt.imshow(...)</code> 에서 <code>...</code>이 shape이 (??,??)이면 흑백이미지를 출력</p>
<div id="11a4cdd1-0498-4417-bf6c-ce83f6b833f3" class="cell" data-outputid="bbd382b0-2e79-4d17-d8f4-dfc557660cba" data-tags="[]" data-execution_count="37">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>plt.imshow([[<span class="dv">0</span>,<span class="dv">255</span>],[<span class="dv">0</span>,<span class="dv">255</span>]],cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-122-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> <code>plt.imshow(...)</code> 에서 <code>...</code>의 shape이 (??,??,3)이면 칼라이미지를 출력</p>
<div id="03dd9ec4-9a51-4c63-8463-5e40ba58e63f" class="cell" data-outputid="e0d82acc-b717-4dff-87cb-2f4af6e32e49" data-tags="[]" data-execution_count="38">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">255</span>],[<span class="dv">0</span>,<span class="dv">255</span>]]</span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> [[<span class="dv">255</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">255</span>,<span class="dv">0</span>]]</span>
<span id="cb228-4"><a href="#cb228-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.stack([r,g,b],axis<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-123-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>-</code> <code>plt.imshow(...)</code> 에서 <code>...</code>의 자료형이 int인지 float인지에 따라서 인식이 다름</p>
<div id="f0ad1752-40de-434c-84ea-81a379192583" class="cell" data-outputid="bb4c79a8-552a-4eb1-c80e-50bc067e39d7" data-tags="[]" data-execution_count="39">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">1</span>],[<span class="dv">0</span>,<span class="dv">1</span>]]</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> [[<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="dv">1</span>,<span class="dv">0</span>]]</span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.stack([r,g,b],axis<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-124-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="c9b705bd-5a1b-42ee-bb2d-66d572b2241f" class="cell" data-outputid="c57c632f-2176-415d-9fb2-ddb46e157848" data-tags="[]" data-execution_count="40">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> [[<span class="dv">0</span>,<span class="fl">1.0</span>],[<span class="dv">0</span>,<span class="fl">1.0</span>]]</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> [[<span class="fl">1.0</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>]]</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> [[<span class="dv">0</span>,<span class="dv">0</span>],[<span class="fl">1.0</span>,<span class="dv">0</span>]]</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.stack([r,g,b],axis<span class="op">=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-125-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>###</code> – 예비학습 끝</p>
<div id="8f58b09b-e553-4b64-8764-7517abd8045a" class="cell" data-tags="[]" data-execution_count="371">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>wget https:<span class="op">//</span>raw.githubusercontent.com<span class="op">/</span>guebin<span class="op">/</span>SC2022<span class="op">/</span>main<span class="op">/</span>hani.jpeg</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>hani <span class="op">=</span> np.einsum(<span class="st">'ijk-&gt;jik'</span>,np.array(PIL.Image.<span class="bu">open</span>(<span class="st">'hani.jpeg'</span>),dtype<span class="op">=</span>np.int64)<span class="op">/</span><span class="dv">255</span>)</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>rm hani.jpeg</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>--2024-04-12 10:25:35--  https://raw.githubusercontent.com/guebin/SC2022/main/hani.jpeg
Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 185.199.110.133, 185.199.108.133, 185.199.109.133, ...
Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|185.199.110.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2445959 (2.3M) [image/jpeg]
Saving to: ‘hani.jpeg’

hani.jpeg           100%[===================&gt;]   2.33M  --.-KB/s    in 0.04s   

2024-04-12 10:25:36 (62.3 MB/s) - ‘hani.jpeg’ saved [2445959/2445959]
</code></pre>
</div>
</div>
<ul>
<li>note: 위 코드는 코랩 혹은 리눅스기반 환경에서 동작가능.</li>
</ul>
<p>불러온 이미지는 아래와 같다.</p>
<div id="40289da5-5c60-4f6e-89cc-1bdc2288fee6" class="cell" data-tags="[]" data-execution_count="372">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>hani,hani.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="372">
<pre><code>(array([[[0.44705882, 0.48627451, 0.49411765],
         [0.43137255, 0.46666667, 0.48627451],
         [0.45882353, 0.50196078, 0.5254902 ],
         ...,
         [0.6627451 , 0.6627451 , 0.70196078],
         [0.63529412, 0.62745098, 0.67058824],
         [0.64313725, 0.63529412, 0.67843137]],
 
        [[0.45882353, 0.49803922, 0.50588235],
         [0.44313725, 0.48235294, 0.49019608],
         [0.4627451 , 0.50588235, 0.52156863],
         ...,
         [0.63921569, 0.63921569, 0.67843137],
         [0.64313725, 0.63529412, 0.67843137],
         [0.63137255, 0.62352941, 0.66666667]],
 
        [[0.45490196, 0.49411765, 0.50196078],
         [0.4627451 , 0.49803922, 0.51764706],
         [0.45882353, 0.50196078, 0.5254902 ],
         ...,
         [0.64313725, 0.64313725, 0.68235294],
         [0.65490196, 0.65490196, 0.69411765],
         [0.64313725, 0.64313725, 0.68235294]],
 
        ...,
 
        [[0.69411765, 0.69803922, 0.70588235],
         [0.68627451, 0.69019608, 0.69803922],
         [0.69411765, 0.69803922, 0.70588235],
         ...,
         [0.60784314, 0.6       , 0.60392157],
         [0.6       , 0.59215686, 0.59607843],
         [0.59607843, 0.58823529, 0.59215686]],
 
        [[0.70196078, 0.70588235, 0.71372549],
         [0.72156863, 0.7254902 , 0.73333333],
         [0.69019608, 0.69411765, 0.70196078],
         ...,
         [0.61176471, 0.60392157, 0.60784314],
         [0.60392157, 0.59607843, 0.6       ],
         [0.61568627, 0.60784314, 0.61176471]],
 
        [[0.7254902 , 0.72941176, 0.7372549 ],
         [0.73333333, 0.7372549 , 0.74509804],
         [0.70980392, 0.71372549, 0.72156863],
         ...,
         [0.61176471, 0.60392157, 0.60784314],
         [0.60392157, 0.59607843, 0.6       ],
         [0.61960784, 0.61176471, 0.61568627]]]),
 (4032, 3024, 3))</code></pre>
</div>
</div>
<ul>
<li>이미지는 4032 <span class="math inline">\(\times\)</span> 3024 개의 격자(픽셀)로 이루어져 있음</li>
</ul>
<p>이미지를 보는 방법은 아래와 같다.</p>
<div id="c0dfd34f-bed1-4e8d-a930-f642ddbd770a" class="cell" data-tags="[]" data-execution_count="373">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(hani) <span class="co"># 모든이미지, 하니매트릭스</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-128-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="876bcf1d-3669-4fe6-9e03-14781b3d907c" class="cell" data-tags="[]" data-execution_count="374">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(hani[<span class="dv">1000</span>:<span class="dv">1500</span>, <span class="dv">1000</span>:<span class="dv">2000</span>,:]) <span class="co"># 얼굴만 확대, 하니의 서브매트릭스 </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-129-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>3</code>. 하니이미지를 나타내는 어레이를 변형하여 빨간색을 의미하는 칼라만 남겨서 “빨간하니”를 만들고 이미지를 출력하라.</p>
<p>(풀이)</p>
<div id="f8e744e8-afc1-4f4d-bd73-a9f801299a0b" class="cell" data-tags="[]" data-execution_count="375">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>red_hani <span class="op">=</span> hani<span class="op">*</span><span class="dv">0</span> </span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>red_hani[:,:,<span class="dv">0</span>] <span class="op">=</span> hani[:,:,<span class="dv">0</span>]</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(red_hani)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-130-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>4</code>. 하니의 모든 값에 루트를 취하여 “루트하니”를 만들고 “원본하니”와 “루트하니”를 좌우로 나란히 배치하여 출력하라.</p>
<p>(풀이)</p>
<div id="27b75139-87c9-41cf-a363-717b573fa9f7" class="cell" data-tags="[]" data-execution_count="376">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>root_hani <span class="op">=</span> np.sqrt(hani)</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.concatenate([hani,root_hani],axis<span class="op">=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-131-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>“루트하니”의 이미지는 “원본하니”의 이미지와 비교하여 어떤가? 왜 그러한 결과가 나왔다고 생각하는가?</p>
<p><code>5</code>. 하니의 모든값에 아래와 같은 함수를 적용하라.</p>
<ul>
<li><span class="math inline">\(f(x)=\begin{cases} \sqrt{x} &amp; x&gt;0.7 \\ x &amp; x \leq 0.7 \end{cases}\)</span></li>
</ul>
<p>함수의 결과로 얻어진 매트릭스를 “후광하니”라고 부르자. “원본하니”와 “후광하니”를 좌우로 나란히 배치하여 출력하라.</p>
<div id="1806bf39-1185-444a-a4e6-d65bead2b06f" class="cell" data-tags="[]" data-execution_count="377">
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>shiny_hani <span class="op">=</span> np.sqrt(hani)<span class="op">*</span>(hani<span class="op">&gt;</span><span class="fl">0.7</span>)<span class="op">+</span>hani<span class="op">*</span>(hani<span class="op">&lt;=</span><span class="fl">0.7</span>)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.concatenate([hani,shiny_hani],axis<span class="op">=</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-132-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="c.-mnist-data" class="level2">
<h2 class="anchored" data-anchor-id="c.-mnist-data">C. MNIST data</h2>
<p>아래는 0~9가지의 숫자이미지가 저장된 이미지데이터를 불러오는 코드이다.</p>
<div id="fd2618dd-ff84-4b87-8dc3-3c12a1dcb974" class="cell" data-tags="[]" data-execution_count="311">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># URL 설정</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">'https://github.com/guebin/PP2023/raw/main/posts/02_DataScience/mnist.npz'</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="co"># URL에서 파일 다운로드</span></span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>urllib.request.urlretrieve(url, <span class="st">'./mnist.npz'</span>)</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-6"><a href="#cb240-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 데이터 로드</span></span>
<span id="cb240-7"><a href="#cb240-7" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.load(<span class="st">'./mnist.npz'</span>)</span>
<span id="cb240-8"><a href="#cb240-8" aria-hidden="true" tabindex="-1"></a>xtrain, ytrain, xtest, ytest <span class="op">=</span> data[<span class="st">'x_train'</span>], data[<span class="st">'y_train'</span>], data[<span class="st">'x_test'</span>], data[<span class="st">'y_test'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>아래는 데이터에 대한 설명이다.</p>
<ul>
<li>전체의 이미지의 수는 70000개이며, 60000개의 이미지 <span class="math inline">\({\tt xtrain}\)</span>에 10000개의 이미지는 <span class="math inline">\({\tt xtest}\)</span>에 저장되어 있다.</li>
<li>이미지에 대한 라벨은 각각 <span class="math inline">\({\tt ytrain}\)</span>과 <span class="math inline">\(\tt ytest\)</span>에 저장되어 있다. 따라서 <span class="math inline">\(\tt ytrain\)</span>에는 60000개의 이미지에 해당하는 라벨이, <span class="math inline">\(\tt ytest\)</span>에는 10000개의 이미지에 해당하는 라벨이 기록되어 있다.</li>
<li>보통 분석에서는 60000개의 이미지를 가지고 라벨을 맞추는 “훈련”을 하고 (<span class="math inline">\({\tt xtrain}\)</span>을 이용하여 <span class="math inline">\({\tt ytrain}\)</span>을 맞추는 방법을 학습하고), 그러한 훈련이 잘 되었는지 10000개의 이미지를 이용하여 “테스트”한다.</li>
<li>위와 같은 의미로 <span class="math inline">\(({\tt xtrain}, {\tt ytrain})\)</span> 을 training data set, <span class="math inline">\(({\tt xtest},{\tt ytest})\)</span> 를 test data set 이라고 부른다. (ref: <a href="https://en.wikipedia.org/wiki/Training,_validation,_and_test_data_sets">위키참고</a>)</li>
</ul>
<p>아래는 이미지자료와 시각화에 대한 설명이다.</p>
<ul>
<li>각 이미지는 (28,28) 픽셀의 흑백이미지이다. 따라서 각 이미지는 (28,28,3) 이 아니라 (28,28) 의 shape을 가진 텐서로 구성되어있다.</li>
<li>흑백이미지를 시각화 하기 위해서는 <code>plt.imshow(img, cmap='gray')</code>를 이용한다. 여기에서 <span class="math inline">\({\tt img}\)</span>은 임의의 2차원 텐서이며 이 예제의 경우 (28,28)의 shape을 가진다.</li>
</ul>
<p>아래는 <span class="math inline">\({\tt xtrain}\)</span>의 두번째 이미지, 즉 <span class="math inline">\({\tt xtrain[1,:,:]}\)</span>를 확인하는 코드의 예시이다.</p>
<div id="9dcb2938-9dea-4bcf-84e8-8c5425db5b27" class="cell" data-tags="[]" data-execution_count="312">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.imshow(xtrain[1,:,:],cmap='gray')</span></span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>) <span class="co">## 같은코드임</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-134-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>이 이미지에 대한 label은 <span class="math inline">\({\tt ytrain[1]}\)</span>의 값으로 확인가능하다.</p>
<div id="56eb15b0-8d44-4092-be40-69ab364142ac" class="cell" data-tags="[]" data-execution_count="313">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>ytrain[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="313">
<pre><code>0</code></pre>
</div>
</div>
<p>이미지와 라벨을 한번에 표현하는 코드는 아래와 같이 작성가능하다.</p>
<div id="ff5cf580-cbcb-4003-8713-912035905909" class="cell" data-tags="[]" data-execution_count="314">
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">1</span>]))<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-136-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>아래는 10개의 이미지를 라벨과 함께 출력하는 코드의 예시이다.</p>
<div id="0252ab95-a1ff-4c32-b0c9-e83fa67d9507" class="cell" data-tags="[]" data-execution_count="315">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].imshow(xtrain[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">0</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">0</span>]))<span class="op">;</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].imshow(xtrain[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">1</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">2</span>].imshow(xtrain[<span class="dv">2</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">2</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">2</span>]))<span class="op">;</span></span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">3</span>].imshow(xtrain[<span class="dv">3</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">3</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">3</span>]))<span class="op">;</span></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">4</span>].imshow(xtrain[<span class="dv">4</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">4</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">4</span>]))<span class="op">;</span></span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].imshow(xtrain[<span class="dv">5</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">0</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">5</span>]))<span class="op">;</span></span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].imshow(xtrain[<span class="dv">6</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">1</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">6</span>]))<span class="op">;</span></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">2</span>].imshow(xtrain[<span class="dv">7</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">2</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">7</span>]))<span class="op">;</span></span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">3</span>].imshow(xtrain[<span class="dv">8</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">3</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">8</span>]))<span class="op">;</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">4</span>].imshow(xtrain[<span class="dv">9</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">4</span>].set_title(<span class="st">'label=</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(ytrain[<span class="dv">9</span>]))<span class="op">;</span></span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-137-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(1)</code> 70000개의 이미지중 0~9에 해당하는 이미지는 각각 몇장씩 들어있는가?</p>
<p>(풀이)</p>
<div id="301875a8-a387-4fb2-a3b7-b7302682eca4" class="cell" data-tags="[]" data-execution_count="316">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>_y <span class="op">=</span> ytrain.tolist()<span class="op">+</span>ytest.tolist()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="ca9dc5f5-5ff2-41f0-a22f-a1d69a376e2c" class="cell" data-tags="[]" data-execution_count="317">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>{s:_y.count(s) <span class="cf">for</span> s <span class="kw">in</span> <span class="bu">set</span>(_y)}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="317">
<pre><code>{0: 6903,
 1: 7877,
 2: 6990,
 3: 7141,
 4: 6824,
 5: 6313,
 6: 6876,
 7: 7293,
 8: 6825,
 9: 6958}</code></pre>
</div>
</div>
<p><code>(2)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 손글씨 0을 의미하는 이미지만을 모아서 새로운 텐서 <span class="math inline">\({\tt xtrain0}\)</span>를 만들어라. 이 텐서에서 처음과 마지막 이미지를 출력하라.</p>
<p><strong>hint:</strong> <span class="math inline">\({\tt xtrain0}\)</span> 의 shape은 (5923,28,28)이어야 한다.</p>
<p>(풀이)</p>
<div id="feef4ee0-259d-40a8-a31c-4a714e75f157" class="cell" data-tags="[]" data-execution_count="318">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a>xtrain0 <span class="op">=</span> xtrain[ytrain<span class="op">==</span><span class="dv">0</span>]</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a>xtrain0.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="318">
<pre><code>(5923, 28, 28)</code></pre>
</div>
</div>
<div id="157a596a-f960-44ff-8d53-7ee001749216" class="cell" data-tags="[]" data-execution_count="319">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain0[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>) <span class="co"># 처음이미지</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-141-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="16fb3024-8643-4938-91b8-f4995c202edd" class="cell" data-tags="[]" data-execution_count="320">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain0[<span class="op">-</span><span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>) <span class="co"># 마지막이미지</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-142-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(3)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 손글씨 0을 의미하는 이미지의 평균을 계산하라. 즉 아래를 계산하라.</p>
<ul>
<li><span class="math inline">\({\tt xtrain0mean} = \frac{1}{5923}\sum_{i=1}^{5923} {\tt xtrain0[i, :, :]}\)</span></li>
</ul>
<p>계산결과를 출력하라.</p>
<p>(풀이)</p>
<div id="1bc12919-bd0b-413e-89d4-7e297ee1fc88" class="cell" data-tags="[]" data-execution_count="321">
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(xtrain0.mean(axis<span class="op">=</span><span class="dv">0</span>),cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-143-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(4)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 각 라벨에 대한 평균이미지를 계산하고 계산결과를 <span class="math inline">\({\tt imgmean}\)</span>에 길이가 10인 <code>list</code>로 저장하라. 즉 <span class="math inline">\({\tt imgmean}\)</span>은 아래와 같은 자료구조를 가지고 있어야 한다.</p>
<ul>
<li><span class="math inline">\({\tt imgmean}=\big[{\tt imgmean[0]},\dots, {\tt imgmean[9]}\big]\)</span></li>
<li><span class="math inline">\({\tt imgmean[0]}, \dots, {\tt imgmean[9]}\)</span> 는 각각 (28,28)의 shape을 가진 numpy array</li>
<li><span class="math inline">\({\tt imgmean[0]}, \dots, {\tt imgmean[9]}\)</span> 는 각각 숫자 0,1, …, 9의 평균이미지를 의미</li>
</ul>
<p><span class="math inline">\({\tt imgmean[0]},\dots, {\tt imgmean[9]}\)</span>를 시각화 하라.</p>
<p>(풀이)</p>
<div id="c1232726-b280-46c3-a939-b3af53940c60" class="cell" data-tags="[]" data-execution_count="322">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a>imgmean <span class="op">=</span> [xtrain[ytrain<span class="op">==</span>i].mean(axis<span class="op">=</span><span class="dv">0</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d1f1c320-18a3-4667-90b9-85252e61e9e0" class="cell" data-tags="[]" data-execution_count="323">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].imshow(imgmean[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].imshow(imgmean[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-5"><a href="#cb255-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">2</span>].imshow(imgmean[<span class="dv">2</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-6"><a href="#cb255-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">3</span>].imshow(imgmean[<span class="dv">3</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-7"><a href="#cb255-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">4</span>].imshow(imgmean[<span class="dv">4</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-8"><a href="#cb255-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-9"><a href="#cb255-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].imshow(imgmean[<span class="dv">5</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-10"><a href="#cb255-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].imshow(imgmean[<span class="dv">6</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-11"><a href="#cb255-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">2</span>].imshow(imgmean[<span class="dv">7</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-12"><a href="#cb255-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">3</span>].imshow(imgmean[<span class="dv">8</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-13"><a href="#cb255-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">4</span>].imshow(imgmean[<span class="dv">9</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb255-14"><a href="#cb255-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-15"><a href="#cb255-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-145-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(5)</code> <span class="math inline">\({\tt xtrain}\)</span>의 두번째 이미지와 <span class="math inline">\({\tt imgmean[0]}\)</span>의 차이를 제곱한 값의 평균을 구하라. 즉 아래를 계산하라.</p>
<ul>
<li><span class="math inline">\(\frac{1}{28\times 28} \sum_{p=0}^{27}\sum_{q=0}^{27}\big({\tt xtrain[1,p,q]}-{\tt imgmean[0][p,q]}\big)^2\)</span></li>
</ul>
<p>(풀이)</p>
<div id="23b047dd-45af-4dd5-ae9c-08f3a0c10031" class="cell" data-tags="[]" data-execution_count="324">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>np.mean((xtrain[<span class="dv">1</span>,:,:]<span class="op">-</span> imgmean[<span class="dv">0</span>])<span class="op">**</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="324">
<pre><code>2299.9585279846365</code></pre>
</div>
</div>
<p><code>(6)</code> 모든 <span class="math inline">\(j=0,1,\dots,9\)</span> 에 대하여 아래를 계산하라.</p>
<ul>
<li><span class="math inline">\(\frac{1}{28\times 28} \sum_{p=0}^{27}\sum_{q=0}^{27}\big({\tt xtrain[1,p,q]}-{\tt imgmean[j][p,q]}\big)^2\)</span></li>
</ul>
<p>계산값이 가장 작게 나오는 <span class="math inline">\(j\)</span>는 얼마인가? 위의 계산결과를 토대로 <span class="math inline">\({\tt xtrain}\)</span>의 두번째 이미지는 어떠한 숫자를 의미한다고 “분류”하는 것이 타당한가?</p>
<div id="0b0c1c6c-e1d6-4948-805c-485fbf2020ea" class="cell" data-tags="[]" data-execution_count="325">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>[np.mean((xtrain[<span class="dv">1</span>,:,:]<span class="op">-</span> imgmean[i])<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="325">
<pre><code>[2299.9585279846365,
 7474.876421640121,
 6154.997099653264,
 5889.84882305034,
 6763.709480023399,
 4616.900123430389,
 5856.367892213506,
 6465.999476962735,
 5916.546346421647,
 6385.5252510342525]</code></pre>
</div>
</div>
<p><code>(7)</code> 아래와 같은 numpy array 를 생성하라.</p>
<p><span class="math display">\[{\tt loss}=
\begin{bmatrix}
{\tt loss[0,0]} &amp; \dots &amp; {\tt loss[0,9]} \\
{\tt loss[1,0]} &amp; \dots &amp; {\tt loss[1,9]} \\
\dots &amp; \dots &amp;  \dots \\
{\tt loss[59999,0]}&amp; \dots &amp;{\tt loss[59999,9]} \\
\end{bmatrix}\]</span></p>
<p>단, <span class="math inline">\({\tt loss[i,j]} = \frac{1}{28\times 28} \sum_{p=0}^{27}\sum_{q=0}^{27}\big({\tt xtrain[i,p,q]}-{\tt imgmean[j][p,q]}\big)^2\)</span></p>
<p>위에서 생성한 <span class="math inline">\({\tt loss}\)</span>를 이용해 (6)와 같은 방식으로 <span class="math inline">\({\tt xtrain}\)</span>의 모든 이미지에 대한 분류를 수행하라.</p>
<p><strong>hint</strong>: <span class="math inline">\({\tt loss}\)</span>에서 “최소값을 가지는 원소의 인덱스를 출력”하는 함수를 각 행별로 적용하면 된다.</p>
<p>(풀이)</p>
<div id="a7df9edf-8472-4cbb-b231-0e8f1f96919a" class="cell" data-tags="[]" data-execution_count="326">
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a>loss <span class="op">=</span> np.array([[np.mean((xtrain[j,:,:]<span class="op">-</span> imgmean[i])<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">60000</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="aaa63269-e629-4817-9883-03d396f12fee" class="cell" data-tags="[]" data-execution_count="327">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>loss.argmin(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="327">
<pre><code>array([5, 0, 4, ..., 5, 6, 8])</code></pre>
</div>
</div>
<p><code>(8)</code> <code>(7)</code>에서 수행한 분류결과와 실제 라벨 <span class="math inline">\({\tt ytrain}\)</span>을 비교하라. 얼마나 많은 결과가 일치하는지 비율을 계산하라.</p>
<p>(풀이)</p>
<div id="4b2ae21e-bdc7-43cb-88f8-3c9606d9de5f" class="cell" data-tags="[]" data-execution_count="328">
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(ytrain <span class="op">==</span> loss.argmin(axis<span class="op">=</span><span class="dv">1</span>)) <span class="op">/</span> <span class="dv">60000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="328">
<pre><code>0.8079833333333334</code></pre>
</div>
</div>
<p><code>(9)</code> <span class="math inline">\({\tt xtrain}\)</span>에서 학습한 평균이미지 <span class="math inline">\({\tt imgmean}\)</span>를 바탕으로 <span class="math inline">\({\tt xtest}\)</span>의 이미지를 분류하라. 분류결과를 <span class="math inline">\({\tt ytest}\)</span>와 비교하라. 얼마나 많은 결과가 일치하는지 비율을 계산하라.</p>
<p>(풀이)</p>
<div id="42798674-5382-4b87-bf1b-246ccbfc59de" class="cell" data-tags="[]" data-execution_count="329">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a>est <span class="op">=</span> np.array([[np.mean((xtest[j,:,:]<span class="op">-</span> imgmean[i])<span class="op">**</span><span class="dv">2</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>)] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10000</span>)]).argmin(axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="07a43ca3-672c-41e7-ada7-bd126828c724" class="cell" data-tags="[]" data-execution_count="330">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(est <span class="op">==</span> ytest)<span class="op">/</span><span class="dv">10000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="330">
<pre><code>0.8203</code></pre>
</div>
</div>
<p><code>(10)</code> <code>(9)</code>의 과정에서 잘못분류된 이미지 10개를 선택하여 시각화 하라.</p>
<ul>
<li>실제 라벨과 잘못된 라벨을 구분하여 시각화 할 것</li>
</ul>
<div id="83b4658f-d8f3-4583-8850-55874742a5cc" class="cell" data-tags="[]" data-execution_count="331">
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>_ytest <span class="op">=</span> ytest[est <span class="op">!=</span> ytest]</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a>_xtest <span class="op">=</span> xtest[est <span class="op">!=</span> ytest]</span>
<span id="cb268-3"><a href="#cb268-3" aria-hidden="true" tabindex="-1"></a>_est <span class="op">=</span> est[est <span class="op">!=</span> ytest]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="f00ce5e7-b743-4d60-9518-25bbdf3e105b" class="cell" data-tags="[]" data-execution_count="332">
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>,<span class="dv">5</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">0</span>].imshow(_xtest[<span class="dv">0</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">0</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">0</span>],_est[<span class="dv">0</span>]))<span class="op">;</span></span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">1</span>].imshow(_xtest[<span class="dv">1</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">1</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">1</span>],_est[<span class="dv">1</span>]))<span class="op">;</span></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">2</span>].imshow(_xtest[<span class="dv">2</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">2</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">2</span>],_est[<span class="dv">2</span>]))<span class="op">;</span></span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">3</span>].imshow(_xtest[<span class="dv">3</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">3</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">3</span>],_est[<span class="dv">3</span>]))<span class="op">;</span></span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>][<span class="dv">4</span>].imshow(_xtest[<span class="dv">4</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">0</span>][<span class="dv">4</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">4</span>],_est[<span class="dv">4</span>]))<span class="op">;</span></span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">0</span>].imshow(_xtest[<span class="dv">5</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">0</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">5</span>],_est[<span class="dv">5</span>]))<span class="op">;</span></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">1</span>].imshow(_xtest[<span class="dv">6</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">1</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">6</span>],_est[<span class="dv">6</span>]))<span class="op">;</span></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">2</span>].imshow(_xtest[<span class="dv">7</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">2</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">7</span>],_est[<span class="dv">7</span>]))<span class="op">;</span></span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">3</span>].imshow(_xtest[<span class="dv">8</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">3</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">8</span>],_est[<span class="dv">8</span>]))<span class="op">;</span></span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>][<span class="dv">4</span>].imshow(_xtest[<span class="dv">9</span>],cmap<span class="op">=</span><span class="st">'gray'</span>)<span class="op">;</span> ax[<span class="dv">1</span>][<span class="dv">4</span>].set_title(<span class="st">'</span><span class="sc">{}</span><span class="st">/</span><span class="sc">{}</span><span class="st">'</span>.<span class="bu">format</span>(_ytest[<span class="dv">9</span>],_est[<span class="dv">9</span>]))<span class="op">;</span></span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-154-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="d.-회전변환" class="level2">
<h2 class="anchored" data-anchor-id="d.-회전변환">D. 회전변환</h2>
<p><code>1-3</code>. 아래는 우산모양의 scatter plot을 그릴 수 있는 <span class="math inline">\((x_i,y_i)\)</span> 좌표값을 불러와서 시각화하는 코드이다.</p>
<div id="ee8ce323-362c-4b08-89c9-be3c3c8fa398" class="cell" data-tags="[]" data-execution_count="338">
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 자료저장 </span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a>data_raw <span class="op">=</span> np.array(pd.read_csv(<span class="st">'https://raw.githubusercontent.com/guebin/2021IR/master/_notebooks/round2.csv'</span>)).T</span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a>data_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="338">
<pre><code>array([[ 12,  12,  13, ..., 636, 636, 637],
       [313, 314, 279, ..., 416, 417, 409]])</code></pre>
</div>
</div>
<div id="616771a6-adc5-4c95-b1dd-032c758f537b" class="cell" data-tags="[]" data-execution_count="339">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 저장된 자료를 x,y로 분해 </span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a>x_raw,y_raw <span class="op">=</span> data_raw</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>x_raw,y_raw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="339">
<pre><code>(array([ 12,  12,  13, ..., 636, 636, 637]),
 array([313, 314, 279, ..., 416, 417, 409]))</code></pre>
</div>
</div>
<div id="7386b27b-8797-4da0-a7e3-554e43df4a47" class="cell" data-tags="[]" data-execution_count="340">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 시각화</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>)) <span class="co"># 그림크기고정</span></span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x_raw,y_raw,<span class="st">'o'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-157-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>1</code>. <code>x_raw</code>와 <code>y_raw</code>를 각각 표준화하고 <code>x</code>, <code>y</code>에 저장하라. 결과를 시각화하라. 그리고 <code>x</code>, <code>y</code>를 바탕으로 <code>data</code> matrix를 다시 구성하라.</p>
<p><code>(풀이)</code></p>
<p><strong>표준화</strong></p>
<div id="71c988d7-4de9-4c55-a1a4-22feead2efa0" class="cell" data-tags="[]" data-execution_count="341">
<div class="sourceCode cell-code" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span> (x_raw<span class="op">-</span>np.mean(x_raw)) <span class="op">/</span> np.std(x_raw,ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span> (y_raw<span class="op">-</span>np.mean(y_raw)) <span class="op">/</span> np.std(y_raw,ddof<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>시각화</strong></p>
<div id="0dd8dc26-21b9-4b28-91f4-743d02696f6c" class="cell" data-tags="[]" data-execution_count="342">
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>)) <span class="co"># 그림크기고정</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-159-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><strong>data matrix</strong> 재구성</p>
<div id="bd2694c7-d1c8-4c13-a296-80d55830bec2" class="cell" data-tags="[]" data-execution_count="343">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([x,y])</span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="343">
<pre><code>array([[-1.79820085, -1.79820085, -1.79255336, ...,  1.72583347,
         1.72583347,  1.73148096],
       [-0.18390658, -0.17703046, -0.41769466, ...,  0.52433376,
         0.53120988,  0.47620092]])</code></pre>
</div>
</div>
<p><code>2</code>. 아래와 같은 규칙에 따라 <span class="math inline">\((x_i,y_i)\)</span>를 <span class="math inline">\((\tilde{x}_i,\tilde{y}_i\)</span>)로 변환하라. 단 여기에서 <span class="math inline">\(\theta= \frac{\pi}{4}\)</span>로 가정한다.</p>
<ul>
<li><span class="math inline">\({\tt xx}_i = \tilde{x}_i = (\cos\theta) x_i - (\sin\theta) y_i\)</span></li>
<li><span class="math inline">\({\tt yy}_i = \tilde{y}_i = (\sin\theta) x_i + (\cos\theta) y_i\)</span></li>
</ul>
<p><span class="math inline">\((x_i,y_i)\)</span>와 <span class="math inline">\((\tilde{x}_i, \tilde{y}_i)\)</span>를 겹쳐서 시각화 하라. 이 변환이 의미하는 바는 무엇이라고 생각하는가?</p>
<p><code>(풀이1)</code></p>
<div id="8e477d47-8d79-4c26-b508-02600c385e75" class="cell" data-tags="[]" data-execution_count="344">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.pi<span class="op">/</span><span class="dv">4</span> </span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>xx <span class="op">=</span> np.cos(theta)<span class="op">*</span>x <span class="op">-</span> np.sin(theta)<span class="op">*</span>y</span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> np.sin(theta)<span class="op">*</span>x <span class="op">+</span> np.cos(theta)<span class="op">*</span>y</span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(x,y)$'</span>) </span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(xx,yy)$'</span>)</span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-161-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>(풀이2)</code></p>
<p>아래의 규칙을 다시 고려하자.</p>
<ul>
<li><span class="math inline">\({\tt xx}_i = \tilde{x}_i = (\cos\theta) x_i - (\sin\theta) y_i\)</span></li>
<li><span class="math inline">\({\tt yy}_i = \tilde{y}_i = (\sin\theta) x_i + (\cos\theta) y_i\)</span></li>
</ul>
<p>이는 아래와 같이 재표현가능하다.</p>
<ul>
<li><p><span class="math inline">\(\begin{cases} {\tt xx}_1 = (\cos\theta)x_1 - (\sin\theta)y_1 \\ {\tt yy}_1 = (\sin\theta)x_1 + (\cos\theta)y_1 \end{cases}\)</span></p></li>
<li><p><span class="math inline">\(\begin{cases} {\tt xx}_2 = (\cos\theta)x_2 - (\sin\theta)y_2 \\ {\tt yy}_2 = (\sin\theta)x_2 + (\cos\theta)y_2 \end{cases}\)</span></p></li>
<li><p><span class="math inline">\(\dots\)</span></p></li>
<li><p><span class="math inline">\(\begin{cases} {\tt xx}_n = (\cos\theta)x_n - (\sin\theta)y_1 \\ {\tt yy}_n = (\sin\theta)x_n + (\cos\theta)y_n \end{cases}\)</span></p></li>
</ul>
<p>이는 다시 아래와 같이 재 표현가능하다.</p>
<ul>
<li><p><span class="math inline">\(\begin{bmatrix} {\tt xx}_1 \\ {\tt yy}_1 \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_1 \\ y_1 \end{bmatrix}\)</span></p></li>
<li><p><span class="math inline">\(\begin{bmatrix} {\tt xx}_2 \\ {\tt yy}_2 \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_2 \\ y_2 \end{bmatrix}\)</span></p></li>
<li><p><span class="math inline">\(\dots\)</span></p></li>
<li><p><span class="math inline">\(\begin{bmatrix} {\tt xx}_n \\ {\tt yy}_n \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_n \\ y_n \end{bmatrix}\)</span></p></li>
</ul>
<p>이는 다시 아래와 같이 재 표현가능하다. (이게 처음엔 생각하기 어려워요!! <span class="math inline">\(\star\star\star\)</span>)</p>
<ul>
<li><span class="math inline">\(\begin{bmatrix} {\tt xx}_1 &amp; {\tt xx}_2 &amp; \dots &amp; {\tt xx}_n \\ {\tt yy}_1 &amp; {\tt yy}_2 &amp; \dots &amp; {\tt yy}_n \end{bmatrix} = \begin{bmatrix} \cos\theta &amp; - \sin\theta \\ \sin\theta &amp; \cos\theta \end{bmatrix} \begin{bmatrix} x_1 &amp; x_2 &amp; \dots &amp; x_n \\ y_1 &amp; y_2 &amp; \dots &amp; y_n \end{bmatrix}\)</span></li>
</ul>
<p>위의 수식에 맞추어 변환을 진행하면</p>
<div id="318bb63b-1aea-4b2b-aff3-7b5a6736dd23" class="cell" data-tags="[]" data-execution_count="345">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> np.pi<span class="op">/</span><span class="dv">4</span> </span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a>R <span class="op">=</span> np.array([[np.cos(theta), <span class="op">-</span>np.sin(theta)],[np.sin(theta),np.cos(theta)]])</span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a>R </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="345">
<pre><code>array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]])</code></pre>
</div>
</div>
<div id="1c782c71-5754-42b6-9576-7dd1ea65b424" class="cell" data-tags="[]" data-execution_count="346">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>R <span class="op">@</span> data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="346">
<pre><code>array([[-1.14147842, -1.14634057, -0.97217191, ...,  0.8495886 ,
         0.84472644,  0.88761703],
       [-1.40156161, -1.39669946, -1.56288136, ...,  1.59110851,
         1.59597066,  1.56106683]])</code></pre>
</div>
</div>
<div id="5fd43a2d-2dfe-4f97-a5b7-5fc6f541f64f" class="cell" data-tags="[]" data-execution_count="347">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a>xx,yy <span class="op">=</span> R <span class="op">@</span> data </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="2045c944-505e-437a-bc9b-5661ec2e1804" class="cell" data-tags="[]" data-execution_count="348">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(x,y)$'</span>) </span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'o'</span>, label<span class="op">=</span><span class="vs">r'$(xx,yy)$'</span>)</span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-165-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>3</code>. 2번과 같은 변환을 8번 연속진행한 결과를 시각화하라.</p>
<p><code>(풀이)</code></p>
<div id="292f74cf-1b34-48bd-9a11-39aa6f698266" class="cell" data-tags="[]" data-execution_count="349">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a>xx,yy<span class="op">=</span>np.linalg.matrix_power(R,<span class="dv">8</span>) <span class="op">@</span> data</span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$data=(x,y)$'</span>) </span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'o'</span>,label<span class="op">=</span><span class="vs">r'$R^8@data=(xx,yy)$'</span>)</span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-166-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>4</code>. 2번의 변환을 역변환하는 코드를 구현하라. 원본, 변환, 역변환한 자료를 순서대로 시각화 하라. 결과를 아래와 같이 저장하라.</p>
<ul>
<li>원본: <span class="math inline">\({\tt x}, {\tt y}\)</span></li>
<li>2번변환: <span class="math inline">\({\tt xx}, {\tt yy}\)</span></li>
<li>2번의역변환 <span class="math inline">\({\tt xxx}, {\tt yyy}\)</span></li>
</ul>
<p><code>(풀이)</code></p>
<div id="6545fbb2-9440-45ba-ae76-3027a31eaf29" class="cell" data-tags="[]" data-execution_count="350">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>xx,yy <span class="op">=</span> R<span class="op">@</span>data </span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>xxx,yyy <span class="op">=</span> np.linalg.inv(R)<span class="op">@</span>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e386edc1-6d96-4430-b6a4-34a81932f871" class="cell" data-tags="[]" data-execution_count="351">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">6</span>,<span class="dv">6</span>))</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y,<span class="st">'.'</span>, label<span class="op">=</span><span class="vs">r'$data = (x,y)$'</span>) </span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>plt.plot(xx,yy,<span class="st">'.'</span>, label<span class="op">=</span><span class="vs">r'$R@data = (xx,yy)$'</span>)</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a>plt.plot(xxx,yyy,<span class="st">'.'</span>, label<span class="op">=</span><span class="vs">r'$R^{-1}@data = (xxx,yyy)$'</span>)</span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-168-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="e.-삼성전자의-주가" class="level2">
<h2 class="anchored" data-anchor-id="e.-삼성전자의-주가">E. 삼성전자의 주가</h2>
<p><code>1-3</code>. 시계열 자료와 이동평균</p>
<p><code>1</code>. 아래의 수식에 따르는 수열 <span class="math inline">\(x_t\)</span>를 생성하라. 단, <span class="math inline">\(T=1000\)</span> 으로 설정하고 랜덤시드는 <code>np.random.seed(2)</code>와 같이 설정한다.</p>
<ul>
<li><span class="math inline">\(x_1=\epsilon_1\)</span></li>
<li><span class="math inline">\(x_2=\epsilon_1+\epsilon_2\)</span></li>
<li><span class="math inline">\(x_3=\epsilon_1+\epsilon_2+\epsilon_3\)</span></li>
<li><span class="math inline">\(\dots\)</span></li>
<li><span class="math inline">\(x_T=\sum_{t=1}^{T} \epsilon_t\)</span></li>
</ul>
<p>생성결과를 시각화하라.</p>
<p><code>(풀이)</code></p>
<div id="13d3293c-3601-4ae1-9a9b-9183b4a9aa54" class="cell" data-tags="[]" data-execution_count="353">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">2</span>)</span>
<span id="cb289-3"><a href="#cb289-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="op">=</span> np.random.randn(<span class="dv">1000</span>)</span>
<span id="cb289-4"><a href="#cb289-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> epsilon.cumsum()</span>
<span id="cb289-5"><a href="#cb289-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-169-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>2</code>. 아래와 같은 변환을 수행하고 결과를 시각화하라.</p>
<ul>
<li><span class="math inline">\({\tt xx}_1= \frac{1}{3}(x_1+x_1+x_2)\)</span></li>
<li><span class="math inline">\({\tt xx}_2= \frac{1}{3}(x_1+x_2+x_3)\)</span></li>
<li><span class="math inline">\({\tt xx}_3= \frac{1}{3}(x_2+x_3+x_4)\)</span></li>
<li><span class="math inline">\(\dots\)</span></li>
<li><span class="math inline">\({\tt xx}_{T-1}= \frac{1}{3}(x_{T-1}+x_{T-1}+x_T)\)</span></li>
<li><span class="math inline">\({\tt xx}_{T}= \frac{1}{3}(x_{T-1}+x_T+x_T)\)</span></li>
</ul>
<p><code>(풀이)</code></p>
<div id="0e7190bf-086b-4489-a86d-c7993bb2b67f" class="cell" data-tags="[]" data-execution_count="356">
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>M[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span> </span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>M[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="dv">2</span><span class="op">/</span><span class="dv">3</span> </span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a>plt.plot(M<span class="op">@</span>x,label<span class="op">=</span><span class="vs">r'$M@x$'</span>)</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-170-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p><code>3</code>. 2번의 변환을 100번 반복하고 시각화하라.</p>
<p><code>(풀이)</code></p>
<div id="64c3f00d-fcb6-41dc-ae86-531b2d740e49" class="cell" data-tags="[]" data-execution_count="357">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linalg.matrix_power(M,<span class="dv">100</span>)<span class="op">@</span>x,label<span class="op">=</span><span class="vs">r'$M^</span><span class="sc">{100}</span><span class="vs">@x$'</span>)</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-171-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="3cbda9e1-24a5-458d-a792-93b594f19918" class="cell" data-tags="[]" data-execution_count="358">
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,label<span class="op">=</span><span class="vs">r'$x$'</span>)</span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.linalg.matrix_power(M,<span class="dv">1000</span>)<span class="op">@</span>x,label<span class="op">=</span><span class="vs">r'$M^</span><span class="sc">{1000}</span><span class="vs">@x$'</span>)</span>
<span id="cb292-3"><a href="#cb292-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="07wk-2_files/figure-html/cell-172-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    const typesetMath = (el) => {
      if (window.MathJax) {
        // MathJax Typeset
        window.MathJax.typeset([el]);
      } else if (window.katex) {
        // KaTeX Render
        var mathElements = el.getElementsByClassName("math");
        var macros = [];
        for (var i = 0; i < mathElements.length; i++) {
          var texText = mathElements[i].firstChild;
          if (mathElements[i].tagName == "SPAN") {
            window.katex.render(texText.data, mathElements[i], {
              displayMode: mathElements[i].classList.contains('display'),
              throwOnError: false,
              macros: macros,
              fleqn: false
            });
          }
        }
      }
    }
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        typesetMath(container);
        return container.innerHTML
      } else {
        typesetMath(note);
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      typesetMath(note);
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="guebin/DL2024" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->




</body></html>